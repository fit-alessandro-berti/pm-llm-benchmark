# **Optimizing E-Commerce Fulfillment with Process Mining: Addressing Instance-Spanning Constraints**

## **1. Identifying Instance-Spanning Constraints and Their Impact**

### **1.1. Using Process Mining to Identify Constraints**
To formally identify and quantify the impact of instance-spanning constraints, we leverage **process mining techniques** on the event log, including:

- **Process Discovery (e.g., Inductive Miner, Heuristics Miner):**
  - Construct a **process model** (e.g., Petri net or BPMN) to visualize bottlenecks where orders interact (e.g., shared cold-packing stations, batching delays).
  - Use **variant analysis** to identify common paths where constraints cause delays (e.g., express orders preempting standard orders).

- **Performance Analysis (e.g., Dotted Charts, Bottleneck Analysis):**
  - **Dotted charts** help visualize **waiting times** between activities, highlighting where orders stall due to resource contention (e.g., cold-packing stations) or batching.
  - **Bottleneck analysis** identifies activities with the highest **cycle time variability**, often caused by shared resources or regulatory limits.

- **Resource Utilization Analysis:**
  - **Resource profiles** (e.g., using **Disco/ProM**) show how often cold-packing stations or QC staff are fully utilized, indicating contention.
  - **Queue length analysis** measures how many orders are waiting for a constrained resource (e.g., hazardous material processing limit).

- **Dependency Analysis (e.g., Social Network Analysis for Orders):**
  - **Hand-over-of-work analysis** identifies where orders frequently compete for the same resource (e.g., express orders interrupting standard orders at packing stations).
  - **Batch formation analysis** tracks how long orders wait for batch completion before shipping label generation.

---

### **1.2. Key Metrics for Quantifying Constraint Impact**
| **Constraint**               | **Impact Metric**                                                                 | **Analysis Method**                                                                 |
|------------------------------|-----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------|
| **Shared Cold-Packing Stations** | - **Cold-packing queue length** (avg. & max orders waiting) <br> - **Cold-packing station utilization rate** (%) <br> - **Additional waiting time** for orders requiring cold-packing vs. standard packing | - **Resource utilization heatmaps** <br> - **Comparison of cycle times** (cold vs. standard packing) |
| **Shipping Batches**         | - **Batch formation delay** (time from last order in batch completing QC to label generation) <br> - **Batch size distribution** (are batches too large, causing delays?) <br> - **% of orders waiting >X minutes for batch completion** | - **Dotted chart analysis** (waiting times before label generation) <br> - **Batch size vs. delay correlation** |
| **Priority Handling (Express Orders)** | - **Preemption frequency** (# of times standard orders are paused for express) <br> - **Delay induced in standard orders** due to express priority <br> - **Express order acceleration** (reduction in end-to-end time vs. standard) | - **Event log filtering** (express vs. standard) <br> - **Comparison of interrupted vs. uninterrupted order flows** |
| **Hazardous Material Limits** | - **% of time hazardous material processing is at capacity (10/10)** <br> - **Queue length for hazardous orders** <br> - **Spillover delays** (non-hazardous orders waiting because hazardous orders occupy QC/packing) | - **Resource utilization trends** (hazardous vs. non-hazardous) <br> - **Correlation between hazardous order volume and overall throughput** |

---

### **1.3. Differentiating Within-Instance vs. Between-Instance Delays**
| **Delay Type**               | **Characteristics**                                                                 | **Detection Method**                                                                 |
|------------------------------|-------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------|
| **Within-Instance (Activity Duration)** | - Longer-than-expected time for a single activity (e.g., slow picker, complex order). <br> - No dependency on other orders. | - **Activity duration histograms** (identify outliers). <br> - **Case-level cycle time decomposition**. |
| **Between-Instance (Resource Contention, Batching, Priority)** | - Order waits because another order occupies a shared resource. <br> - Order waits for batch formation. <br> - Order is preempted by a higher-priority order. | - **Waiting time between activities** (e.g., time between "ready for packing" and "packing start"). <br> - **Resource contention logs** (e.g., cold-packing station occupancy). <br> - **Batch formation timestamps** (time between last order in batch completing QC and label generation). |

**Example:**
- If **ORD-5001** waits 5 minutes between "Packing Complete" and "Quality Check Start" because **ORD-5002 (express)** is using the QC staff, this is a **between-instance delay**.
- If **ORD-5003** takes 20 minutes in "Item Picking" because the picker had to search for a misplaced item, this is a **within-instance delay**.

---

## **2. Analyzing Constraint Interactions**

### **2.1. Key Interactions Between Constraints**
| **Interaction** | **Scenario** | **Impact** |
|----------------|-------------|------------|
| **Express Orders + Cold-Packing** | An express order requiring cold-packing arrives while a standard order is using the last available cold-packing station. | - The standard order is preempted, increasing its delay. <br> - If multiple express orders arrive in quick succession, cold-packing becomes a severe bottleneck. |
| **Batching + Hazardous Limits** | Multiple hazardous orders are destined for the same region, but the 10-order limit is already reached. | - Some hazardous orders must wait, delaying batch formation. <br> - Non-hazardous orders in the same batch may also be delayed. |
| **Cold-Packing + Hazardous Limits** | A cold-packing station is occupied by a hazardous order, and another hazardous order arrives but cannot proceed due to the 10-order limit. | - The second hazardous order waits longer, potentially violating regulatory time limits. <br> - Cold-packing station underutilization if hazardous orders are stuck in queue. |
| **Express Orders + Batching** | An express order is ready for shipping but must wait for a batch to form with other (slower) orders in its region. | - The express order loses its time advantage. <br> - May require **dynamic batching exceptions** for express orders. |

### **2.2. Why Understanding Interactions Matters**
- **Avoiding Suboptimal Fixes:** For example, adding more cold-packing stations may not help if the real bottleneck is the **hazardous material limit** preventing orders from reaching packing.
- **Balancing Trade-offs:** Express orders improve customer satisfaction but may harm standard order throughput. **Dynamic priority rules** (e.g., only preempt if express order is at risk of missing SLA) can mitigate this.
- **Predictive Scheduling:** If batching delays are worse for hazardous orders, we may need **separate batching logic** for them.

---

## **3. Developing Constraint-Aware Optimization Strategies**

### **Strategy 1: Dynamic Cold-Packing Station Allocation with Priority-Aware Scheduling**
**Constraint Addressed:** Shared Cold-Packing Stations + Express Order Priority
**Problem:** Cold-packing stations are a bottleneck, especially when express orders arrive.

**Proposed Solution:**
- **Real-time demand forecasting:**
  - Use **historical event logs** to predict cold-packing demand by time of day/week.
  - Implement a **dynamic allocation system** that reserves a cold-packing station for express orders if forecasted demand exceeds capacity.
- **Priority-aware preemption rules:**
  - If an express order arrives and all cold-packing stations are busy, the system **preempts the lowest-priority standard order** (unless it’s near completion).
  - **Compensation mechanism:** The preempted order gets **priority in the next available slot**.
- **Load balancing:**
  - If a cold-packing station is idle while another has a queue, **automatically reassign** orders (if feasible).

**Data Leveraged:**
- **Event log analysis** of cold-packing station usage patterns.
- **Order priority flags** (express vs. standard).
- **Real-time queue monitoring** (via warehouse management system).

**Expected Outcomes:**
- **Reduced express order delays** (faster cold-packing access).
- **Fairer standard order handling** (preemption compensated with priority later).
- **Higher cold-packing station utilization** (dynamic reallocation reduces idle time).

---

### **Strategy 2: Adaptive Batching with Hazardous Material Awareness**
**Constraint Addressed:** Shipping Batches + Hazardous Material Limits
**Problem:** Batching delays are worsened when hazardous orders hit the 10-order limit, causing spillover delays.

**Proposed Solution:**
- **Dynamic batch triggers:**
  - Instead of fixed batch sizes/times, use **real-time triggers** based on:
    - **Hazardous order count** (if 8 hazardous orders are in QC, start batch formation early).
    - **Express order presence** (if an express order is waiting, form a smaller batch).
  - **Region-specific thresholds** (e.g., high-volume regions get larger batches; low-volume regions get faster, smaller batches).
- **Separate hazardous/non-hazardous batches:**
  - If possible, **group hazardous orders into dedicated batches** to avoid blocking non-hazardous orders.
- **Predictive batch formation:**
  - Use **machine learning** (trained on historical data) to predict when a batch will be "optimal" (balancing delay vs. shipping efficiency).

**Data Leveraged:**
- **Historical batch formation times** (to train ML models).
- **Hazardous order volume trends** (by time/region).
- **Shipping cost vs. delay trade-off analysis**.

**Expected Outcomes:**
- **Faster batch formation** for hazardous orders (avoiding 10-order limit gridlock).
- **Reduced spillover delays** for non-hazardous orders.
- **Better alignment with shipping SLAs** (express orders batched faster).

---

### **Strategy 3: Regulatory-Compliant Hazardous Material Scheduling**
**Constraint Addressed:** Hazardous Material Limits (10-order cap)
**Problem:** The 10-order limit creates artificial bottlenecks, especially during peak times.

**Proposed Solution:**
- **Staggered processing:**
  - Instead of a hard cap, implement a **rolling window** (e.g., no more than 10 hazardous orders in **Packing + QC combined at any time**).
  - Use a **token-based system** (like a semaphore in computing) where each hazardous order "checks out" a token before entering Packing/QC.
- **Predictive throttling:**
  - If the system predicts >10 hazardous orders will arrive soon (based on picking completion times), **delay non-hazardous orders slightly** to free up capacity.
- **Dedicated hazardous material resources:**
  - If feasible, **assign 1-2 QC staff exclusively to hazardous orders** during peak times to prevent them from blocking the entire 10-order limit.

**Data Leveraged:**
- **Real-time order tracking** (how many hazardous orders are in Packing/QC).
- **Historical hazardous order arrival patterns**.
- **QC staff utilization data**.

**Expected Outcomes:**
- **Smoother flow of hazardous orders** (fewer artificial stops).
- **Reduced non-hazardous order delays** (better capacity management).
- **Compliance maintained** (no violations of the 10-order rule).

---

## **4. Simulation and Validation**

### **4.1. Simulation Approach**
Before implementing changes, we **simulate** the proposed strategies using:
- **Discrete-event simulation (DES)** (e.g., **SimPy, AnyLogic**) to model:
  - **Resource contention** (cold-packing stations, QC staff).
  - **Batching logic** (dynamic vs. fixed).
  - **Priority preemptions** (express orders interrupting standard orders).
  - **Hazardous material limits** (10-order cap enforcement).
- **Agent-based modeling** (if order interactions are highly complex).

### **4.2. Key Simulation Focus Areas**
| **Aspect** | **How to Model It** | **Validation Metric** |
|------------|---------------------|-----------------------|
| **Cold-Packing Contention** | - Model stations as limited resources. <br> - Simulate express order preemptions. | - **Avg. wait time for cold-packing**. <br> - **% of express orders meeting SLA**. |
| **Batching Delays** | - Model dynamic batch formation rules. <br> - Vary batch sizes based on order mix. | - **Avg. batch formation time**. <br> - **Shipping cost per order** (trade-off). |
| **Hazardous Material Limits** | - Enforce 10-order cap in Packing/QC. <br> - Simulate staggered processing. | - **Queue length for hazardous orders**. <br> - **Throughput of non-hazardous orders**. |
| **Priority Handling** | - Model express order arrivals with higher urgency. <br> - Track preemption impact on standard orders. | - **Delay induced in standard orders**. <br> - **Express order acceleration**. |

### **4.3. Simulation Outputs to Validate**
- **Before vs. After KPIs:**
  - End-to-end order fulfillment time.
  - % of orders meeting delivery SLAs.
  - Resource utilization rates (cold-packing, QC).
- **Constraint-Specific Metrics:**
  - Cold-packing queue reduction.
  - Batch formation time improvement.
  - Hazardous order compliance rate.

---
## **5. Monitoring Post-Implementation**

### **5.1. Key Metrics to Track**
| **Category** | **Metric** | **How to Measure** | **Target Improvement** |
|-------------|------------|---------------------|------------------------|
| **Cold-Packing Efficiency** | - Cold-packing station utilization (%) <br> - Avg. wait time for cold-packing (min) <br> - % of express orders preempting standard orders | - **Process mining dashboard** (real-time resource monitoring). <br> - **Event log analysis** (wait times between activities). | - Utilization: 85-90% (avoid overloading). <br> - Wait time: <5 min for express, <10 min for standard. |
| **Batching Performance** | - Avg. batch formation time (min) <br> - % of orders waiting >15 min for batch <br> - Shipping cost per order ($) | - **Dotted charts** (batch formation delays). <br> - **Cost analysis** (shipping efficiency). | - Batch formation: <20 min. <br> - Shipping cost: <$0.50 increase per order. |
| **Priority Handling** | - % of express orders meeting SLA <br> - Avg. delay induced in standard orders due to preemption (min) | - **SLA compliance reports**. <br> - **Preemption event logs**. | - Express SLA compliance: >95%. <br> - Standard order delay: <3 min. |
| **Hazardous Material Compliance** | - % of time hazardous processing is at 10/10 capacity <br> - Avg. queue length for hazardous orders <br> - Spillover delay to non-hazardous orders (min) | - **Real-time resource dashboards**. <br> - **Correlation analysis** (hazardous vs. non-hazardous delays). | - 10/10 capacity: <20% of time. <br> - Spillover delay: <2 min. |

### **5.2. Process Mining Dashboards for Continuous Monitoring**
1. **Real-Time Bottleneck Dashboard:**
   - **Heatmap of resource utilization** (cold-packing, QC, batching).
   - **Alerts when constraints are violated** (e.g., hazardous order limit breached).

2. **Order Flow Analysis Dashboard:**
   - **Dotted chart of order progress** (color-coded by priority, hazardous status).
   - **Waiting time breakdown** (within-instance vs. between-instance).

3. **SLA Compliance Dashboard:**
   - **% of orders meeting delivery deadlines** (by order type, region).
   - **Trends in express vs. standard order performance**.

4. **Batching Efficiency Dashboard:**
   - **Batch formation time vs. batch size**.
   - **Shipping cost impact of dynamic batching**.

### **5.3. Continuous Improvement Loop**
- **Monthly deep-dive analysis** using updated event logs to:
  - Recalibrate **dynamic batching rules** (adjust thresholds based on seasonality).
  - Refine **priority preemption logic** (balance express acceleration vs. standard order impact).
  - Optimize **hazardous material scheduling** (e.g., adjust staggered processing windows).

- **A/B Testing:**
  - Run **pilot tests** of new strategies (e.g., dedicated hazardous QC staff) in one warehouse section before full rollout.

---
## **Conclusion**
By **systematically identifying instance-spanning constraints**, **analyzing their interactions**, and **implementing data-driven optimization strategies**, the fulfillment center can:
 **Reduce end-to-end order fulfillment time** (especially for express orders).
 **Improve resource utilization** (cold-packing, QC, batching).
 **Maintain regulatory compliance** while minimizing hazardous material delays.
 **Balance priority handling** without excessively penalizing standard orders.

**Next Steps:**
1. **Extract and preprocess event logs** for process mining.
2. **Build simulation models** to test strategies.
3. **Pilot the most promising optimizations** (e.g., dynamic cold-packing allocation).
4. **Deploy dashboards** for real-time monitoring.
5. **Iterate based on performance data**.

This approach ensures **sustainable improvements** by addressing the root causes of delays—**not just symptoms**—while respecting the complex interdependencies in the fulfillment process.