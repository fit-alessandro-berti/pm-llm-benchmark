### Identified Anomalies and Undesirable Behaviors

1. **Out-of-Sequence Activities**:
   - Case 1002: "Confirm Shipment" and "Ship Goods" occur *before* "Perform Credit Check" and "Validate Stock".
   - Case 1003: "Ship Goods" occurs *before* "Validate Stock" and "Confirm Shipment" (which itself happens *after* shipping).
   - Case 1004: "Receive Payment" occurs immediately after "Register Order" but *before* "Issue Invoice", "Perform Credit Check", or any logistics steps.

2. **Missing Critical Activities**:
   - Case 1002: "Validate Stock" happens *after* shipping, but logically should precede it.
   - Case 1003: No "Validate Stock" at all.
   - Case 1004: No "Perform Credit Check" or "Validate Stock".

3. **Impossible or Illogical Timestamps**:
   - Payments or invoices before prerequisite steps (e.g., Case 1004: Payment 5 minutes after registration, before any checks or shipment).
   - Shipping without confirmation (Case 1003).
   - Early shipment/logistics steps bypassing finance/credit gates (Case 1002, priority order).

4. **Potential Resource/Department Mismatches** (minor):
   - Most resources align with expected departments (e.g., Finance for credit/invoicing, Logistics for shipment), but sequences suggest unauthorized skipping (e.g., Logistics acting without Finance approval).

5. **Order-Type Correlations**:
   - Case 1002 (priority order) shows aggressive bypassing of credit/stock checks, possibly for speed.

These indicate process deviations, risking financial loss (e.g., shipping uncredited orders), stock issues, or fraud.

### Hypothesized Causes
- **Policy Violations/Rush for Priority Orders**: Case 1002 (priority) skips credit/stock upfront—sales/logistics pushing high-value orders ($2000) without checks.
- **System/Workflow Errors**: Parallel processing or UI bugs allowing out-of-order logging (e.g., shipment buttons enabled prematurely).
- **Fraud or Internal Misconduct**: Case 1004's instant payment post-registration suggests fake payments or collusion (high-value $3000 order); skipping credit checks hides poor credit (cf. Case 1002's 650 score).
- **Training/Compliance Gaps**: Staff (e.g., LogisticsMgr_2 in multiple deviations) not enforcing gates, or poor handover between departments.
- **Data Logging Errors**: Timestamps manipulated or events backdated (e.g., late "Confirm Shipment" in Case 1003).

### Proposed SQL Queries for Investigation
These queries target `order_event_log` primarily, joining `orders`/`resources` where relevant. Run on PostgreSQL.

1. **Cases missing "Perform Credit Check" (potential fraud/bypass)**:
   ```sql
   SELECT DISTINCT o.case_id, o.order_type, o.order_value
   FROM orders o
   LEFT JOIN order_event_log log ON o.case_id = log.case_id AND log.activity = 'Perform Credit Check'
   WHERE log.event_id IS NULL;
   ```

2. **Cases with out-of-order shipments (Ship Goods before Confirm Shipment)**:
   ```sql
   SELECT log.case_id,
          ship.timestamp AS ship_time,
          confirm.timestamp AS confirm_time
   FROM order_event_log log
   JOIN order_event_log ship ON log.case_id = ship.case_id AND ship.activity = 'Ship Goods'
   JOIN order_event_log confirm ON log.case_id = confirm.case_id AND confirm.activity = 'Confirm Shipment'
   WHERE ship.timestamp < confirm.timestamp;
   ```

3. **Cases with payment before invoice or registration (impossible sequences)**:
   ```sql
   SELECT log.case_id,
          pay.timestamp AS payment_time,
          inv.timestamp AS invoice_time,
          reg.timestamp AS register_time
   FROM order_event_log log
   JOIN order_event_log pay ON log.case_id = pay.case_id AND pay.activity = 'Receive Payment'
   LEFT JOIN order_event_log inv ON log.case_id = inv.case_id AND inv.activity = 'Issue Invoice'
   LEFT JOIN order_event_log reg ON log.case_id = reg.case_id AND reg.activity = 'Register Order'
   WHERE pay.timestamp < COALESCE(inv.timestamp, 'infinity'::timestamp)
      OR pay.timestamp < reg.timestamp;
   ```

4. **Priority orders with anomalies (e.g., early logistics skipping credit/stock)**:
   ```sql
   SELECT o.case_id, o.order_type, COUNT(DISTINCT log.activity) AS activity_count
   FROM orders o
   JOIN order_event_log log ON o.case_id = log.case_id
   WHERE o.order_type = 'priority'
   GROUP BY o.case_id, o.order_type
   HAVING COUNT(DISTINCT CASE WHEN log.activity IN ('Perform Credit Check', 'Validate Stock') THEN 1 END) < 2
   ORDER BY activity_count;
   ```

5. **Resources involved in deviations (e.g., frequent skips by department/role)**:
   ```sql
   SELECT r.department, r.role, COUNT(DISTINCT log.case_id) AS deviant_cases
   FROM order_event_log log
   JOIN resources r ON log.resource = r.resource_id
   WHERE log.case_id IN (
       SELECT case_id FROM order_event_log
       WHERE activity = 'Ship Goods'
       AND timestamp < (SELECT MIN(timestamp) FROM order_event_log sub
                        WHERE sub.case_id = order_event_log.case_id AND sub.activity = 'Confirm Shipment')
   )
   GROUP BY r.department, r.role
   ORDER BY deviant_cases DESC;
   ```

6. **Credit scores for cases with shipment before check (risk assessment)**:
   ```sql
   SELECT log.case_id,
          credit.additional_info AS credit_score,
          ship.timestamp AS ship_time,
          credit.timestamp AS credit_time
   FROM order_event_log log
   JOIN order_event_log ship ON log.case_id = ship.case_id AND ship.activity = 'Ship Goods'
   JOIN order_event_log credit ON log.case_id = credit.case_id AND credit.activity = 'Perform Credit Check'
   WHERE ship.timestamp < credit.timestamp
   ORDER BY log.case_id;
   ```

7. **All cases with non-sequential activity order (detect any deviation)**:
   ```sql
   WITH expected_order AS (
       SELECT case_id, activity,
              ROW_NUMBER() OVER (PARTITION BY case_id ORDER BY timestamp) AS actual_seq,
              DENSE_RANK() OVER (PARTITION BY case_id ORDER BY timestamp) AS time_rank
       FROM order_event_log
   )
   SELECT case_id, activity, actual_seq
   FROM expected_order
   WHERE actual_seq != (
       CASE activity
           WHEN 'Register Order' THEN 1
           WHEN 'Perform Credit Check' THEN 2
           WHEN 'Validate Stock' THEN 3
           WHEN 'Confirm Shipment' THEN 4
           WHEN 'Ship Goods' THEN 5
           WHEN 'Issue Invoice' THEN 6
           WHEN 'Receive Payment' THEN 7
       END
   )
   ORDER BY case_id, actual_seq;
   ```

These queries are self-contained, efficient, and directly testable. Start with #1-3 for quick wins, then drill into resources/orders.