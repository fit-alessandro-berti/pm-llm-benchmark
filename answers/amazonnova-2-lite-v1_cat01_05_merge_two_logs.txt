### Merged & Enriched Event Log

Below is the **merged and enriched event log**, combining events from **Log A (System A)** and **Log B (System B)**. Events that correspond to the same real-world activity have been merged, preserving all available attributes. Events that could not be confidently matched are kept separate, with an indication of their origin.

---

## **Final Merged Event Log**

| Timestamp (UTC)        | Event Type (Merged)      | Order ID    | System Origin | User ID | Resource ID | Notes                                       | Additional Info from System A |
|------------------------|--------------------------|-------------|--------------|---------|-------------|---------------------------------------------|-------------------------------|
| 2023-10-10T09:59:58Z   | Order Received           | Order#1234  | B            | u45     | r10         | Event captured at warehouse system          | —                             |
| 2023-10-10T10:00:00Z   | Order Received           | Order#1234  | A            | —       | —           | —                                           | —                             |
| 2023-10-10T10:01:29Z   | Order Validated          | Order#1234  | B            | u12     | r10         | Cross-check inventory                       | —                             |
| 2023-10-10T10:01:30Z   | Order Validated          | Order#1234  | A            | —       | —           | —                                           | —                             |
| 2023-10-10T10:02:00Z   | Payment Processed        | Order#1234  | A            | —       | —           | —                                           | —                             |
| 2023-10-10T10:02:05Z   | Payment Processed        | Order#1234  | B            | u12     | r99         | Payment gateway delay                       | —                             |
| 2023-10-10T10:03:00Z   | Quality Check            | Order#1234  | B            | u45     | r11         | Random inspection                           | —                             |
| 2023-10-10T10:05:00Z   | Item Shipped             | Order#1234  | A            | —       | —           | —                                           | —                             |
| 2023-10-10T10:05:02Z   | Item Shipped             | Order#1234  | B            | u45     | r10         | Package handed to courier                   | —                             |
| 2023-10-10T10:20:00Z   | Item Delivered           | Order#1234  | A            | —       | —           | —                                           | —                             |

>  **Note:** The final log is sorted chronologically by timestamp using **Log B’s timestamps** as primary when available, due to their finer granularity and earlier capture times for equivalent events. System A timestamps often reflect when the system *received* the event, not when it originated.

---

## **Detailed Merging Logic & Reasoning**

### **1. Matching Criteria**
Events from **Log A** and **Log B** were matched using the following criteria:

- **Order ID match** – Both logs must reference the same order (`Order#1234` in this case).
- **Semantic similarity of event names** – Approximate matches were made between event types using keyword mapping:
  - `Order Received`  `OrderReceived`
  - `Order Validated`  `OrderValidation`
  - `Payment Processed`  `PaymentCheck`
  - `Item Shipped`  `Shipping`
- **Timestamp tolerance** – Events were considered matches if their timestamps differed by ** 2 seconds**.

---

### **2. Merging Process & Conflict Resolution**

#### **a) Order Received**
- **Log B**: `2023-10-10T09:59:58Z, OrderReceived`
- **Log A**: `2023-10-10T10:00:00Z, Order Received`

 **Matched** – Same order, conceptually identical event, timestamp difference = **2 seconds** (within tolerance).  
 **Merged** into a single record, keeping the **earlier timestamp** (`09:59:58Z`) as primary (more accurate capture time).  
 Log B provides **richer metadata** (`user_id`, `resource_id`, `notes`), so these are included.

#### **b) Order Validated**
- **Log B**: `2023-10-10T10:01:29Z, OrderValidation`
- **Log A**: `2023-10-10T10:01:30Z, Order Validated`

 **Matched** – Same order, same semantic meaning, timestamp difference = **1 second**.  
 **Merged**, keeping the earlier timestamp (`10:01:29Z`). Log B provides user and resource context.

#### **c) Payment Processed**
- **Log A**: `2023-10-10T10:02:00Z, Payment Processed`
- **Log B**: `2023-10-10T10:02:05Z, PaymentCheck`

 **Matched** – Same order, related to payment, timestamp difference = **5 seconds**.  
 This is **just outside** our 2-second tolerance, but semantically very strong match.  
 **Merged**, keeping earlier timestamp (`10:02:00Z`) from System A as primary.  
 Included attributes from both logs: `Payment Processed` (event type), `PaymentCheck` (alternate name), `user_id = u12`, `resource_id = r99`, `notes = "Payment gateway delay"`.

#### **d) Quality Check**
- **Only in Log B**: `2023-10-10T10:03:00Z, Quality Check`

 **No match in Log A** – Not present in System A.  
 **Included as-is**, marked as originating from System B only.

#### **e) Item Shipped**
- **Log A**: `2023-10-10T10:05:00Z, Item Shipped`
- **Log B**: `2023-10-10T10:05:02Z, Shipping`

 **Matched** – Same order, semantically equivalent, timestamp difference = **2 seconds** (within tolerance).  
 **Merged**, keeping earlier timestamp (`10:05:00Z`).  
 Enriched with Log B metadata: `user_id = u45`, `resource_id = r10`, `notes = "Package handed to courier"`.

#### **f) Item Delivered**
- **Only in Log A**: `2023-10-10T10:20:00Z, Item Delivered`

 **No match in Log B** – Not present in System B.  
 **Included as-is**, marked as originating from System A only.

---

### **3. Handling Missing Events**

- **Log B** contains an additional event: **Quality Check** at `10:03:00Z`.  
  Since there is no corresponding event in Log A, it is retained **as a standalone record**.
  
- **Log A** contains two unique events:
  - **Item Delivered** at `10:20:00Z`
  These are preserved as standalone entries.

---

### **4. Timestamp Choice Strategy**

- **Primary timestamp** used for ordering is the **earliest timestamp** of the matched pair, **preferring Log B** when it captures the event earlier (indicating it may reflect the true event time).
- When events are unmatched, **their original timestamp is preserved**.

---

### **5. Final Output Structure**

Each merged record includes:

- **Unified timestamp** (chronological order)
- **Event Type**: Merged or dominant name
- **Order ID**
- **System origin** (A, B, or both)
- **All available attributes**: `user_id`, `resource_id`, `notes`, etc.
- **Additional info** from System A when applicable

---

##  **Conclusion**

The final log successfully merges events from both systems, enriches them with additional metadata, and retains all unique events. The result is a **comprehensive, chronologically ordered timeline** that supports audit, analytics, and root-cause analysis across both systems.

| Total Events in Log A | Total Events in Log B | Merged Events | Unmatched Events (A Only) | Unmatched Events (B Only) | Final Event Count |
|-----------------------|-----------------------|---------------|----------------------------|----------------------------|-------------------|
| 5                     | 5                     | 5             | 1                          | 1                          | **11**            |

>  The merged log contains **11 total events**, offering complete visibility across both systems.