### How I matched/merged the two logs

**Matching keys used**
- **order_id must match** (all events are for `Order#1234`).
- **Time proximity**: treat events as the same if they are very close in time (2s tolerance) *and* the activity names clearly correspond.
- **Name normalization / synonym mapping** (System B  unified activity):
  - `OrderReceived`  **Order Received**
  - `OrderValidation`  **Order Validated**
  - `PaymentCheck`  **Payment Processed** (same step, different label)
  - `Shipping`  **Item Shipped**
  - `Quality Check`  **Quality Check** (no counterpart in A)

**Timestamp conflict handling**
- **System A is the primary timeline**: when an event is merged (A+B), the **primary_timestamp = timestamp from A**.
- I **retain both timestamps** (`timestamp_a`, `timestamp_b`) for traceability and note the time difference.

**Unmatched events**
- `Quality Check` exists only in **Log B**  kept as a standalone event (origin = B).
- `Item Delivered` exists only in **Log A**  kept as a standalone event (origin = A).

**One exception to the 2s rule**
- **Payment**: A has `10:02:00`, B has `10:02:05` (**5s apart**). I still merged them because:
  - The event names strongly correspond (processed vs check),
  - The sequence position matches the process flow,
  - B explicitly notes “Payment gateway delay,” explaining the lag.
  - I mark this match as **medium confidence** and keep both timestamps.

---

## Merged, enriched event log (chronological by primary timestamp)

| primary_timestamp | order_id | unified_event | origin | timestamp_a | event_type_a | timestamp_b | event_name_b | user_id | resource_id | notes | match_confidence / time_diff |
|---|---|---|---|---|---|---|---|---|---|---|---|
| 2023-10-10T10:00:00Z | Order#1234 | Order Received | A+B | 2023-10-10T10:00:00Z | Order Received | 2023-10-10T09:59:58Z | OrderReceived | u45 | r10 | Event captured at warehouse system | high / 2s (B earlier) |
| 2023-10-10T10:01:30Z | Order#1234 | Order Validated | A+B | 2023-10-10T10:01:30Z | Order Validated | 2023-10-10T10:01:29Z | OrderValidation | u12 | r10 | Cross-check inventory | high / 1s (B earlier) |
| 2023-10-10T10:02:00Z | Order#1234 | Payment Processed | A+B | 2023-10-10T10:02:00Z | Payment Processed | 2023-10-10T10:02:05Z | PaymentCheck | u12 | r99 | Payment gateway delay | **medium / 5s (B later)** |
| 2023-10-10T10:03:00Z | Order#1234 | Quality Check | B only | — | — | 2023-10-10T10:03:00Z | Quality Check | u45 | r11 | Random inspection | n/a |
| 2023-10-10T10:05:00Z | Order#1234 | Item Shipped | A+B | 2023-10-10T10:05:00Z | Item Shipped | 2023-10-10T10:05:02Z | Shipping | u45 | r10 | Package handed to courier | high / 2s (B later) |
| 2023-10-10T10:20:00Z | Order#1234 | Item Delivered | A only | 2023-10-10T10:20:00Z | Item Delivered | — | — | — | — | — | n/a |

If you want, I can also output this merged log as **JSON Lines** (one JSON object per event) or in an **XES-style** structure commonly used for process mining.