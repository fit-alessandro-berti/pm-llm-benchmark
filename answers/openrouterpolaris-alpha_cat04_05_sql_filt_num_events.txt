Here’s a clear version of the prompt and the corresponding DuckDB SQL query.

Prompt:

You are given an event log in a DuckDB table named event_log, where:
- case_id identifies a process instance,
- activity is the event name, and
- timestamp is the event time.

Write a DuckDB SQL query that:
- Counts how many events belong to each case_id,
- Excludes any case_id that has more than 6 events,
- Returns all events (all rows) for cases that have 6 or fewer events in total.

SQL solution:

SELECT e.*
FROM event_log e
JOIN (
    SELECT case_id
    FROM event_log
    GROUP BY case_id
    HAVING COUNT(*) <= 6
) AS valid_cases
ON e.case_id = valid_cases.case_id;