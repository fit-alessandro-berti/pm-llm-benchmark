```sql
-- Set K = number of most frequent variants you want to keep
-- (e.g., K = 5)
WITH
-- 1) Build ordered activity sequence per case
per_case_sequence AS (
    SELECT
        case_id,
        string_agg(activity, '->' ORDER BY "timestamp") AS variant_sequence
    FROM event_log
    GROUP BY case_id
),

-- 2) Count how many cases follow each variant
variant_stats AS (
    SELECT
        variant_sequence,
        COUNT(*) AS case_count
    FROM per_case_sequence
    GROUP BY variant_sequence
),

-- 3) Keep only the top K variants by number of cases
top_variants AS (
    SELECT
        variant_sequence
    FROM variant_stats
    ORDER BY case_count DESC
    LIMIT 5               --  replace 5 with your desired K
),

-- 4) Cases that belong to the top K variants
top_cases AS (
    SELECT
        pcs.case_id
    FROM per_case_sequence pcs
    JOIN top_variants tv USING (variant_sequence)
)

-- 5) Return all events for those top-variant cases
SELECT
    e.*
FROM event_log e
JOIN top_cases tc USING (case_id)
ORDER BY
    e.case_id,
    e."timestamp";
```