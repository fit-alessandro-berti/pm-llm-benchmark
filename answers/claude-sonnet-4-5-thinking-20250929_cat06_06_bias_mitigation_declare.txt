# Updated DECLARE Model with Bias-Mitigating Constraints

## Updated `declare_model` Dictionary

```python
declare_model = {
    "existence": {
        "StartApplication": {"support": 1.0, "confidence": 1.0},
        "FinalDecision": {"support": 1.0, "confidence": 1.0},
        # NEW: Mandatory bias mitigation check in every trace
        "BiasMitigationCheck": {"support": 1.0, "confidence": 1.0}
    },
    "absence": {},
    "exactly_one": {},
    "init": {
        "StartApplication": {"support": 1.0, "confidence": 1.0}
    },
    "responded_existence": {},
    "coexistence": {
        "StartApplication": {"FinalDecision": {"support": 1.0, "confidence": 1.0}},
        # NEW: Race check requires manual review to coexist
        "CheckApplicantRace": {"ManualReview": {"support": 1.0, "confidence": 1.0}},
        # NEW: Gender check requires manual review to coexist
        "CheckApplicantGender": {"ManualReview": {"support": 1.0, "confidence": 1.0}},
        # NEW: Age check requires manual review to coexist
        "CheckApplicantAge": {"ManualReview": {"support": 1.0, "confidence": 1.0}}
    },
    "response": {
        "StartApplication": {"RequestAdditionalInfo": {"support": 1.0, "confidence": 1.0}},
        # NEW: After checking race, bias mitigation must eventually follow
        "CheckApplicantRace": {"BiasMitigationCheck": {"support": 1.0, "confidence": 1.0}},
        # NEW: After checking gender, bias mitigation must eventually follow
        "CheckApplicantGender": {"BiasMitigationCheck": {"support": 1.0, "confidence": 1.0}},
        # NEW: After checking age, bias mitigation must eventually follow
        "CheckApplicantAge": {"BiasMitigationCheck": {"support": 1.0, "confidence": 1.0}}
    },
    "precedence": {
        # NEW: Final decisions must be preceded by bias mitigation check
        "BiasMitigationCheck": {"FinalDecision": {"support": 1.0, "confidence": 1.0}},
        # NEW: Approval must be preceded by bias mitigation check
        "BiasMitigationCheck": {"Approve": {"support": 1.0, "confidence": 1.0}},
        # NEW: Rejection must be preceded by bias mitigation check
        "BiasMitigationCheck": {"Reject": {"support": 1.0, "confidence": 1.0}}
    },
    "succession": {
        "RequestAdditionalInfo": {"FinalDecision": {"support": 1.0, "confidence": 1.0}}
    },
    "altresponse": {},
    "altprecedence": {},
    "altsuccession": {},
    "chainresponse": {},
    "chainprecedence": {},
    "chainsuccession": {},
    "noncoexistence": {},
    "nonsuccession": {},
    "nonchainsuccession": {
        # NEW: Race check cannot be immediately followed by rejection
        "CheckApplicantRace": {"Reject": {"support": 1.0, "confidence": 1.0}},
        # NEW: Gender check cannot be immediately followed by rejection
        "CheckApplicantGender": {"Reject": {"support": 1.0, "confidence": 1.0}},
        # NEW: Age check cannot be immediately followed by rejection
        "CheckApplicantAge": {"Reject": {"support": 1.0, "confidence": 1.0}},
        # NEW: Race check cannot be immediately followed by approval
        "CheckApplicantRace": {"Approve": {"support": 1.0, "confidence": 1.0}},
        # NEW: Gender check cannot be immediately followed by approval
        "CheckApplicantGender": {"Approve": {"support": 1.0, "confidence": 1.0}},
        # NEW: Age check cannot be immediately followed by approval
        "CheckApplicantAge": {"Approve": {"support": 1.0, "confidence": 1.0}}
    }
}
```

---

## Rationale for Added Constraints

### 1. **Existence: BiasMitigationCheck**
**Purpose:** Mandates that every loan application trace must include a `BiasMitigationCheck` activity.

**Bias Mitigation:** This ensures that no application can be processed without explicit fairness verification, creating an audit trail that demonstrates due diligence in preventing discriminatory outcomes.

---

### 2. **Coexistence: Sensitive Attribute Checks  ManualReview**
**Constraints Added:**
- `CheckApplicantRace`  `ManualReview`
- `CheckApplicantGender`  `ManualReview`
- `CheckApplicantAge`  `ManualReview`

**Purpose:** If any sensitive demographic attribute is accessed, a `ManualReview` must also occur somewhere in the trace (and vice versa).

**Bias Mitigation:** This enforces human oversight whenever sensitive information is consulted, preventing purely automated decisions based on protected characteristics and ensuring accountability.

---

### 3. **Response: Sensitive Attribute Checks  BiasMitigationCheck**
**Constraints Added:**
- `CheckApplicantRace`  `BiasMitigationCheck`
- `CheckApplicantGender`  `BiasMitigationCheck`
- `CheckApplicantAge`  `BiasMitigationCheck`

**Purpose:** After checking any sensitive attribute, a `BiasMitigationCheck` must eventually occur later in the trace.

**Bias Mitigation:** This ensures that exposure to sensitive information triggers a mandatory fairness verification step, preventing unchecked use of demographic data in decision-making.

---

### 4. **Precedence: BiasMitigationCheck before Decisions**
**Constraints Added:**
- `BiasMitigationCheck` precedes `FinalDecision`
- `BiasMitigationCheck` precedes `Approve`
- `BiasMitigationCheck` precedes `Reject`

**Purpose:** All decision activities (`FinalDecision`, `Approve`, `Reject`) must be preceded by a `BiasMitigationCheck`.

**Bias Mitigation:** This guarantees that every decision—whether approval or rejection—undergoes fairness scrutiny before being finalized, reducing the risk of biased outcomes slipping through.

---

### 5. **Non-Chain-Succession: Sensitive Checks  Immediate Decisions**
**Constraints Added:**
- `CheckApplicantRace` cannot immediately precede `Reject` or `Approve`
- `CheckApplicantGender` cannot immediately precede `Reject` or `Approve`
- `CheckApplicantAge` cannot immediately precede `Reject` or `Approve`

**Purpose:** Prevents decisions from occurring immediately after viewing sensitive attributes.

**Bias Mitigation:** This introduces a "cooling-off" period that blocks reflexive, potentially biased decisions. By requiring intervening activities (such as `BiasMitigationCheck` or `ManualReview`), the process enforces deliberation and reduces the risk of snap judgments based on demographic information.

---

## Summary: How These Constraints Reduce Bias

The updated DECLARE model creates multiple layers of protection against discriminatory decision-making:

1. **Mandatory Fairness Checkpoints:** Every trace must include `BiasMitigationCheck`, ensuring no process bypasses fairness verification.

2. **Human Oversight Requirement:** Accessing sensitive demographic data triggers mandatory `ManualReview`, preventing fully automated profiling.

3. **Sequential Safeguards:** Sensitive attribute checks must be followed by bias mitigation, and all decisions must be preceded by fairness verification—creating a deliberate, auditable decision pathway.

4. **Prevention of Immediate Bias:** By blocking direct succession from demographic checks to decisions, the model prevents impulsive, potentially discriminatory actions and enforces thoughtful review.

Together, these constraints transform the loan application process into one that is structurally resistant to bias, promotes transparency, and ensures that decisions about applicants are made through fair, consistent, and well-documented procedures.