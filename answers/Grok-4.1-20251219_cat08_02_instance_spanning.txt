### 1. Identifying Instance-Spanning Constraints and Their Impact

Instance-spanning constraints introduce dependencies between different process instances (orders), leading to waiting times that are not inherent to a single order but arise from interactions with others. Standard process mining techniques (e.g., discovering a Petri net or BPMN model) often reveal only intra-instance behavior, so specialized extensions are required to detect and quantify inter-instance effects.

To identify and quantify each constraint using the event log:

- **Shared Cold-Packing Stations**:
  - Reconstruct resource occupancy timelines for the 5 cold-packing stations by filtering events where "Requires Cold Packing" = TRUE and Activity = "Packing".
  - Compute concurrency: For each START of a cold-packing activity, count how many other cold-packing activities are ongoing.
  - Identify contention when an order arrives at Packing (after Item Picking COMPLETE) but its Packing START is delayed because all 5 stations are occupied.
  - Metrics: Average/max queue length for cold-packing, waiting time attributable to cold-station contention (time from readiness for Packing to actual START for cold orders), utilization rate of cold stations, percentage of cold orders delayed due to resource unavailability.

- **Batching for Shipping**:
  - Group orders by "Destination Region" and infer batch identifiers (either explicit in Resource column like "Batch B1" or by clustering Shipping Label Generation COMPLETE events with similar timestamps per region).
  - For each order, calculate batch-induced waiting time: time from earliest possible Shipping Label Generation (e.g., after Quality Check COMPLETE) to actual COMPLETE.
  - Metrics: Average batch size per region, average/max batch waiting time, variance in waiting time across regions, correlation between batch size and total shipping throughput.

- **Priority Order Handling (Express preemption)**:
  - Detect preemption events: Look for incomplete standard Packing/Quality Check activities that are unusually interrupted or followed by express orders starting on the same resource shortly after.
  - Compare cycle times of standard orders during high express volume vs. low express volume periods.
  - Metrics: Number of preemptions (inferred), additional waiting/sojourn time for standard orders when express orders are present, percentage of express orders that experience zero resource waiting vs. standard orders.

- **Hazardous Material Limits**:
  - Track concurrent hazardous activities: For every START of Packing or Quality Check where "Hazardous Material" = TRUE, count ongoing hazardous activities across the facility.
  - Identify blockage when a hazardous order is ready for Packing/QC but cannot start because the concurrent count would exceed 10.
  - Metrics: Frequency of reaching the 10-order limit, average waiting time for hazardous orders due to regulatory blockage, percentage of time the limit is binding (i.e., exactly 10 concurrent).

**Differentiating within-instance vs. between-instance waiting**:
- Within-instance: Activity duration (COMPLETE - START timestamp).
- Between-instance: Readiness-to-start delay (time from previous activity COMPLETE to current START, minus any recorded internal processing if separable).
- Attribute delays:
  - Resource logs + concurrency reconstruction → attribute to contention.
  - Batch identifiers or regional clustering → attribute to batching.
  - Priority flags + resource timelines → attribute to preemption.
  - Global concurrency counters for hazardous → attribute to regulatory limit.
- Use conformance checking on a resource-aware process model or object-centric process mining (e.g., OCEL format) to systematically separate these causes.

### 2. Analyzing Constraint Interactions

Instance-spanning constraints rarely operate in isolation; their interactions can amplify delays or create unintended bottlenecks.

Examples of key interactions:
- **Express + Cold-Packing**: An express order requiring cold-packing can preempt a standard cold order, freeing the station faster (due to potentially shorter express processing) but also increasing variability in queue discipline, leading to longer average waits for remaining standard cold orders.
- **Batching + Hazardous Limits**: If multiple hazardous orders go to the same region, batching encourages holding them together, but the 10-order limit may force sequential processing through Packing/QC, significantly extending the time until the batch is complete and causing long batch waits.
- **Express + Batching**: Express orders may be excluded from standard batches or form tiny batches, fragmenting carrier capacity and indirectly slowing standard batch formation in shared regions.
- **Cold-Packing + Hazardous**: Cold-perishable hazardous items (e.g., certain chemicals or biologics) create compounded contention: limited stations AND regulatory concurrency cap.

Understanding these interactions is crucial because optimizing one constraint in isolation can worsen others (e.g., aggressively batching to reduce shipping costs could violate hazardous limits or delay express orders). A holistic view ensures that improvements increase overall throughput and SLA compliance rather than merely shifting bottlenecks.

Process mining techniques like object-centric mining (treating resources, regions, and batches as interacting objects) or multi-perspective performance analysis reveal these compounded effects through correlation analysis of the attributed waiting times.

### 3. Developing Constraint-Aware Optimization Strategies

**Strategy 1: Dynamic Priority-Aware Resource Allocation with Reservation for Cold Stations**
- Primarily addresses: Shared Cold-Packing + Priority Handling interactions.
- Changes: Implement a reservation system where a small portion (e.g., 1–2 of 5) cold stations are reserved for express cold orders during peak express periods (predicted from historical patterns). Use a FIFO queue within priority classes but allow express to jump the standard queue.
- Data leverage: Process mining to forecast daily/hourly cold-order arrival rates and express proportion; simulate reservation thresholds.
- Expected outcomes: Reduced waiting for express cold orders (improving SLA), controlled preemption impact on standard cold orders, higher overall cold-station throughput due to reduced idle time from better matching.

**Strategy 2: Region- and Constraint-Aware Dynamic Batching**
- Primarily addresses: Shipping Batching + interactions with Hazardous Limits and Express.
- Changes: Replace fixed time/window batching with dynamic triggers:
  - Close a batch early if it contains express orders or reaches a hazardous count close to regulatory limits.
  - Allow "split batches" for hazardous-heavy regions: create sub-batches that respect the 10-order concurrency limit while minimizing wait.
  - Set maximum batch waiting time caps differentiated by priority (shorter for express-inclusive batches).
- Data leverage: Historical batch size vs. waiting time vs. hazardous proportion analysis to optimize trigger rules (e.g., close batch if hazardous ≥7 or waiting >20 min).
- Expected outcomes: Significantly reduced batch-induced waiting (especially for hazardous and express), maintained or improved carrier utilization, better compliance without throughput loss.

**Strategy 3: Hazardous Concurrency Buffer Scheduling**
- Primarily addresses: Hazardous Material Limits + interactions with Packing contention and Batching.
- Changes: Introduce a scheduling buffer: maintain concurrent hazardous activities at 8–9 (rather than pushing to 10) during peak periods to leave headroom for incoming high-priority or cold hazardous orders. Combine with predictive release of non-hazardous orders to smooth flow.
- Data leverage: Process mining to identify peak hazardous arrival patterns and correlation with delays; calculate optimal buffer size via simulation.
- Expected outcomes: Fewer blockages when urgent hazardous orders arrive, reduced variance in hazardous order cycle time, indirect relief on packing stations by avoiding pile-ups, higher overall facility throughput.

### 4. Simulation and Validation

Simulation is essential to test strategies safely before real-world rollout, especially given complex inter-instance dynamics.

Approach:
- Build a discrete-event simulation (DES) or agent-based model calibrated with the discovered process model from process mining (activity durations, arrival rates, routing probabilities).
- Use real distributions extracted from the event log (e.g., inter-arrival times, activity durations stratified by order type, region, attributes).
- Explicitly model the instance-spanning constraints:
  - Resource pools with finite capacity (5 cold stations, staff pools).
  - Preemption rules for express orders.
  - Global counters for concurrent hazardous activities with hard limit.
  - Batching logic with region queues and configurable closing triggers.
  - Priority queues and reservation mechanisms.

Key aspects to validate:
- KPIs under different load scenarios (normal vs. peak, varying express/hazardous/cold mix).
- Robustness against constraint interactions (e.g., worst-case express + cold + hazardous surges).
- Compare baseline (current log replay) vs. each strategy on metrics: average end-to-end time, SLA compliance rate, throughput, resource utilization, attributed waiting times.

Iterate model parameters until baseline simulation closely matches historical KPIs, then evaluate strategies to select or combine the most effective.

### 5. Monitoring Post-Implementation

Continuous monitoring ensures sustained improvement and early detection of new issues.

**Key metrics and dashboards**:
- Overall: Average cycle time, throughput per hour/day, % orders meeting delivery SLA, stratified by order type/attributes.
- Constraint-specific:
  - Cold-Packing: Queue length (real-time), waiting time due to contention, utilization per station, reservation effectiveness (express wait reduction vs. standard impact).
  - Batching: Average/max batch waiting time per region, batch size distribution, % batches closed by each trigger (time vs. hazardous vs. express).
  - Priority: Number of preemptions, cycle time differential (express vs. standard), % express with zero resource wait.
  - Hazardous: Peak concurrent count, frequency of reaching buffer/limit, waiting time attributed to regulatory blockage.

**Process mining dashboards**:
- Object-centric event log dashboard showing interactions between orders, resources, and regions.
- Performance overlays on process model highlighting bottleneck activities and attributed waiting causes.
- Real-time conformance checking against regulatory limits.
- Trend charts for constraint-related waiting times pre- vs. post-implementation.
- Alerting when metrics deviate (e.g., cold queue > threshold, hazardous concurrency consistently at limit).

Regular (weekly/monthly) re-mining of new logs will confirm whether inter-instance delays have decreased and whether new emergent constraints have appeared.