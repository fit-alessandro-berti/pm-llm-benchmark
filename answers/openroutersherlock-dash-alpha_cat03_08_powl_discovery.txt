```python
import pm4py
from pm4py.objects.powl.obj import StrictPartialOrder, OperatorPOWL, Transition, SilentTransition
from pm4py.objects.process_tree.obj import Operator

# Basic activities
OR = Transition(label="OR")
MS = Transition(label="MS") 
QS = Transition(label="QS")
AS = Transition(label="AS")
IQC = Transition(label="IQC")
TST = Transition(label="TST")
RT = Transition(label="RT")
PK = Transition(label="PK")
LB = Transition(label="LB")
DP = Transition(label="DP")
D = Transition(label="D")

skip = SilentTransition()

# IQC loop: AS -> IQC -> (skip/exit OR AS -> loop back)
iqc_loop = OperatorPOWL(operator=Operator.LOOP, children=[IQC, AS])

# Testing loop: TST -> (skip/exit OR RT -> TST -> loop back) 
test_loop = OperatorPOWL(operator=Operator.LOOP, children=[TST, OperatorPOWL(operator=Operator.XOR, children=[RT, skip])])

# Labeling choice: LB OR skip
labeling_choice = OperatorPOWL(operator=Operator.XOR, children=[LB, skip])

# Main partial order structure
root = StrictPartialOrder(
    nodes=[
        OR, 
        MS, 
        QS, 
        AS,          # initial AS before IQC loop
        iqc_loop,    # IQC-AS loop (optional)
        test_loop,   # testing loop (optional)
        PK, 
        labeling_choice,
        DP, 
        D
    ]
)

# Define partial ordering constraints
root.order.add_edge(OR, MS)
root.order.add_edge(MS, QS)
root.order.add_edge(QS, AS)              # Initial assembly
root.order.add_edge(AS, iqc_loop)        # IQC loop after first AS
root.order.add_edge(iqc_loop, test_loop) # Testing after quality checks
root.order.add_edge(test_loop, PK)       # Packaging after testing
root.order.add_edge(PK, labeling_choice) # Labeling (optional) after packaging  
root.order.add_edge(labeling_choice, DP) # Distribution planning after labeling
root.order.add_edge(DP, D)               # Final dispatch

# Note: Some traces skip IQC loop and go directly AS -> TST
# The partial order allows this flexibility through optional loop execution
```

This POWL model captures:

1. **Sequential prefix**: OR  MS  QS  AS
2. **Optional IQC-AS loop**: After initial AS, may repeat IQCAS multiple times or skip
3. **Optional testing loop**: TST  (skip OR RTTSTloop), handles re-testing
4. **Optional labeling**: Exclusive choice between LB or skip after PK
5. **Sequential suffix**: PK  (LB/skip)  DP  D

The model accommodates all trace variants:
- Case 1,3,5: Full path with IQC loops + testing loops + LB
- Case 2: IQC loop + no RT + no LB  
- Case 4: Skip IQC loop + skip testing loop + LB