Below is a DuckDB query that removes every case containing the *direct* sequence  

**Approve Purchase Requisition  Create Order  Confirm Order**  

where the time between **Create Order** and **Confirm Order** is **greater than 5 days**.  
All remaining events from all other cases are returned.

```sql
WITH ordered AS (
    SELECT
        case_id,
        activity,
        timestamp,
        LEAD(activity, 1)  OVER (PARTITION BY case_id ORDER BY timestamp) AS next_act,
        LEAD(activity, 2)  OVER (PARTITION BY case_id ORDER BY timestamp) AS next2_act,
        LEAD(timestamp, 1) OVER (PARTITION BY case_id ORDER BY timestamp) AS next_ts,
        LEAD(timestamp, 2) OVER (PARTITION BY case_id ORDER BY timestamp) AS next2_ts
    FROM event_log
),
bad_cases AS (
    SELECT DISTINCT case_id
    FROM ordered
    WHERE activity = 'Approve Purchase Requisition'
      AND next_act  = 'Create Order'
      AND next2_act = 'Confirm Order'
      AND next2_ts - next_ts > INTERVAL '5 days'
)
SELECT e.*
FROM event_log e
WHERE e.case_id NOT IN (SELECT case_id FROM bad_cases)
ORDER BY e.case_id, e.timestamp;
```

 **Result:** All events from cases **not** containing that exact sequence with a >5day gap are returned.