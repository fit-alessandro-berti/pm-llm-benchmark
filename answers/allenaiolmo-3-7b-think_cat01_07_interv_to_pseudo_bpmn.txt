<think>
Okay, let's tackle this task. I need to create a BPMN-like textual process model based on the five interviews provided. First, I should read through all the interview transcripts carefully to understand the different perspectives and the steps involved in the invoice approval process.

Starting with Interview 1 from Mary, the Accounts Payable Clerk. She describes the process starting from receiving an invoice via email. The first step is checking if it has a valid PO number. If not, she sends it back to the supplier. If it does have a PO, she logs it into the system, then forwards it to the purchasing department for confirmation of receipt. After that, she matches the invoice to the PO. If there's a discrepancy, she emails the purchasing team to clarify. If unresolved, she escalates to her supervisor. Once approved, she schedules payment.

Interview 2 with Dan, the Purchasing Officer, mentions that upon receiving the invoice, he checks against the PO for details like quantities and prices. If discrepancies are found, he contacts the supplier or Mary to hold the invoice. If everything is okay, he confirms via email. He notes that without a PO, Mary needs to get the info first. After confirmation, he assumes the process moves to the manager.

Carlos, the Department Manager, is the final approver. He gets notifications after the purchase confirmation and PO check. If everything looks good, he approves; otherwise, he might reject or ask for investigation. His approval then sends it back to AP for payment scheduling.

Rita, the Supervisor, handles exceptions. She steps in when there are unresolved issues from Mary or Dan, like missing info or discrepancies. She coordinates with suppliers or departments to resolve, ensuring invoices don't get stuck. She doesn't do final approvals but manages exceptions.

Karen, the Supplier Manager, is involved in resolving issues like missing POs or pricing discrepancies by contacting suppliers and confirming contract terms. She doesn't interact with the system but helps resolve problems so invoices can proceed.

Now, I need to map all these steps into a BPMN-like structure. Let me start by identifying the main activities and their sequence.

The process likely starts with receiving an invoice. The first check is for the PO number. Depending on whether it's present, different paths occur. If no PO, the invoice is sent back to the supplier. If yes, proceed.

Next step after logging into the system (Mary's part) is forwarding to Purchasing for confirmation. Then, after that confirmation, matching the invoice to the PO. Here, discrepancies can arise. If there are discrepancies, clarification is needed. This could lead to different paths: if resolved, move to manager's approval; if unresolved, escalate to supervisor.

Wait, in Mary's description, after sending to Purchasing for confirmation, once she gets confirmation, she matches the invoice to the PO. If there's a discrepancy, she emails the purchasing team. Then if unresolved, she escalates to supervisor. So the matching step is after confirmation.

Then the next step after matching is approval from the manager. The manager's approval is triggered by the system after confirmation and matching. The manager's decision point here is whether to approve or not based on their review.

If the manager approves, then it goes to Accounts Payable for payment scheduling. But if there's a rejection, maybe it goes back to Mary or purchasing for rework?

Also, exceptions like missing PO or discrepancies not resolved by the initial teams would go to Rita. Rita's role is exception handling, so those cases would form a separate branch.

Let me outline the main flow first.

Start with receiving invoice (from supplier? Or from email? Mary says it arrives by email, so the start is receiving via email).

Step 1: Receive Invoice (Email)  Check PO existence. Decision point here: If PO exists  proceed; else, send back to supplier.

If PO exists:

Step 2: Log invoice into accounting system (Mary's task)

Step 3: Forward to Purchasing for confirmation (Mary's task)

Purchasing's step: Upon receiving, check against PO for discrepancies. If discrepancies found, contact Mary to hold or ask for clarification. If okay, send confirmation email.

Wait, Dan's role here is to confirm receipt by checking PO details. So after Mary logs it, she sends to Purchasing. Purchasing then does their check. If they find issues, they communicate with Mary to hold or resolve. If no issues, they confirm.

So after Purchasing's confirmation, the next step is Mary matching the invoice to the PO. Wait, Mary mentioned she matches after receiving confirmation. So step 3 (forward to Purchasing) leads to step 4: Purchasing's confirmation. Then Mary proceeds to match.

Wait, maybe the steps need to be ordered as per the sequence in each interview.

Let me try to list all activities in order, considering each interview's perspective.

Possible sequence:

1. Invoice received via email.

2. Check for PO number:
   - If missing: Send to supplier for details (Mary's role)
   - If present: Proceed.

3. Log invoice into system (Mary's task).

4. Forward invoice to Purchasing for confirmation (Mary's task).

5. Purchasing confirms receipt (Dan's task):
   - If discrepancies found (e.g., quantities, pricing not matching PO), then:
     - Contact Mary to hold invoice or request clarification (Dan's action)
   - If no discrepancies, send confirmation email to Mary.

6. After Purchasing confirms, Mary matches invoice to PO in the system (Mary's task).

7. Check for discrepancies in matching (Mary's task):
   - If discrepancies exist:
     - Email Purchasing team to resolve (Mary's action)
     - If unresolved after some time, escalate to Supervisor (Rita's role)
   - If no discrepancies, proceed.

8. Once resolved (either by Purchasing fixing or escalation), the invoice moves to Manager's approval step.

9. Manager (Carlos) receives notification (from system?) after confirmation and matching. The system might trigger approval request.

10. Manager reviews the invoice details (PO, confirmation, matched items). Decision point:
    - Approve: Then move to payment scheduling (Accounts Payable's next step)
    - Reject: Either hold for investigation or return to Mary for rework.

Wait, in Carlos's interview, he says he approves after seeing everything is okay. If there's a discrepancy, he might reject or ask Mary to hold. So after approval or rejection, the process might loop back or proceed accordingly.

After Manager's approval, the invoice goes to Accounts Payable for scheduling payment. But who does that? Mary or Rita? In Mary's initial description, after approval, she schedules payment. But Rita is involved in exceptions. Maybe in normal flow, after manager approves, the AP team (Mary) handles payment scheduling. But in case of exceptions, Rita steps in.

Also, the exception paths: when discrepancies can't be resolved by Mary and Purchasing, they go to Rita. Rita's role is to handle those cases by contacting suppliers or departments to resolve, then the invoice can proceed.

Another point: in Karen's interview, if the PO is missing, she might help by getting the PO from the supplier or getting a revised invoice. So PO missing could be a separate exception path.

Let me try to structure this into a diagram with nodes and flows.

First, the main process starts with receiving the invoice.

Start node: "Receive Invoice (Email)"

Decision Point 1: Check for PO number existence.
   - Yes  Proceed to next steps
   - No  Send to Supplier for PO details (this is a parallel path? Or a separate sub-process?)

Wait, if PO is missing, the process would branch here. The main flow continues only if PO is present.

So after receiving invoice:

If PO exists  proceed to logging into system (Mary's step), then forward to Purchasing.

If PO missing  send back to supplier (maybe a separate path that loops back? Or ends? Since the process might need to retry after getting PO?)

But in the interviews, Mary says if PO is missing, she sends it back to supplier. Maybe the process ends here unless they get the PO? Or perhaps it's a loop where they retry after getting the PO. But the main process might assume that eventually the PO comes in, so maybe the missing PO is a separate exception path that requires intervention.

Alternatively, the main process is for when the PO is present, and the missing PO is an exception that needs to be handled via Rita or Karen.

Hmm, this complicates things. To keep it simple, perhaps the main path assumes PO exists, and the PO missing case is an exception that needs to be addressed by the exception handling roles.

So the main path proceeds with PO present.

So after receiving invoice with PO:

1. Log invoice into system (Mary)

2. Forward to Purchasing for confirmation (Mary)

3. Purchasing confirms or identifies discrepancies (Dan's task)

   - If discrepancies found  communicate with Mary to hold or resolve (Dan's action)

   - Else, send confirmation email to Mary.

4. Mary proceeds to match invoice to PO (Mary's task)

   - During matching, she checks if all items align (quantities, pricing, etc.)

   - If discrepancies in matching (e.g., quantity mismatch):

     - Email Purchasing team to resolve (Mary's action)

     - If unresolved after some time  escalate to Rita (Rita's role)

   - If no discrepancies  proceed.

5. After resolution (either by Purchasing fixing or via Rita's intervention), the invoice moves to Manager's approval step.

6. Manager (Carlos) reviews the invoice details (PO, confirmation, matched items). Decision point:

   - Approve  then the invoice is sent to Accounts Payable for payment scheduling (Mary's next task?)

   - Reject  either hold for rework or return to Mary/Purchasing for correction.

   - Alternatively, if rejected, maybe it goes back to the previous steps for correction.

Wait, in Carlos's interview, he says if he sees something suspicious, he might reject or ask Mary to hold. So if he rejects, perhaps the process loops back to Mary to fix the issues, then back to him to approve again.

So after Manager's decision:

If approved: move to payment scheduling (Accounts Payable step)

If rejected: send back to Mary/Purchasing for correction.

7. If approved, move to payment scheduling (Mary's task). She schedules the payment, maybe through the system.

8. If there were exceptions handled by Rita (e.g., PO missing or unresolved discrepancies), then after resolution, the process would follow the main path again.

Now, the decision points:

- Check PO existence (after receiving invoice)

- After Purchasing's confirmation, if discrepancies found  need to resolve before proceeding

- After matching, if discrepancies  resolve or escalate

- Manager's approval decision (Approve/Reject)

Also, roles involved in each step:

- Mary handles logging, forwarding, matching, initial discrepancies, and payment scheduling (unless exceptions)

- Dan handles Purchasing's confirmation and initial discrepancy checks

- Carlos handles final approval

- Rita handles escalations when issues can't be resolved by Mary/Dan

- Karen handles PO missing or pricing discrepancies by contacting suppliers

Now, translating this into a BPMN-like textual model with activities, gateways, roles, etc.

I need to structure it with nodes, flows, decisions, and roles.

Possible structure:

Start with "Receive Invoice (Email)" as a start event.

First decision: Check PO existence (Gateway or Decision).

If PO exists:

- Log into system (Activity, Role: Mary)

- Forward to Purchasing (Activity, Role: Mary)

Purchasing receives and does their check:

- Compare with PO (Activity, Role: Dan)

   - If discrepancies found (Decision):

      - Contact Mary to hold or resolve (Activity, Role: Dan)

      - Else, send confirmation email (Activity, Role: Dan)

   - If no discrepancies, confirmation sent (so continue)

Then, Mary proceeds to match invoice to PO (Activity, Mary)

   - During matching, check for discrepancies (Activity, Mary)

      - If discrepancies found (Decision):

         - Email Purchasing team (Activity, Mary)

         - If unresolved after some time (Gateway?), escalate to Rita (Activity, Role: Rita)

      - Else, proceed

After resolution (either by Purchasing or Rita), the process goes to Manager's approval (Activity, Role: Carlos)

Manager reviews and decides:

   - Approve (Flow continues to Payment Scheduling)

   - Reject (Loop back to Mary/Purchasing for correction)

Payment Scheduling (Activity, Role: Mary/Acct Pay Dept)

End of process.

For the PO missing case:

Start node  PO check  Decision: No PO  Send to Supplier (Activity, Role: Mary/Karen?)

Wait, Karen might be involved here. If PO is missing, Mary sends to supplier, but Karen might coordinate with supplier to get PO? Or Mary just sends it back, and Karen isn't directly involved unless Mary mentions Karen?

In Mary's interview, she just sends it back to supplier. Karen's role is when the PO is missing or discrepancies in pricing, so perhaps the PO missing path is handled by Mary and supplier, but if it's a repeated issue, Rita might step in?

Alternatively, the PO missing case could be a separate exception path that requires intervention from Karen or Rita.

Hmm, this might complicate the model. Since the main process assumes PO exists, maybe the PO missing case is a separate branch that goes to a sub-process handled by the exception handlers.

Alternatively, in the main diagram, the PO check is a decision point that branches into PO present or not. The PO not present path could be a sub-process that involves Karen or Rita to resolve it, then loop back to the main process.

But to keep it manageable, perhaps the main model focuses on the PO present path, and the PO missing is noted as an exception with its own handling steps.

But the user wants the model to include exceptions and variations, so I should include that.

So the main process has the PO present path, and the PO missing path branches off and goes through exception handling.

Let me try to outline the main flow first, then the exception paths.

Main Process (PO Present):

1. Receive Invoice (Email)  Start

2. Check PO existence  Decision: Yes/No

   - Yes  Proceed

   - No  Go to Exception Path (PO Missing)

3. Log into system (Mary)

4. Forward to Purchasing (Mary)

5. Purchasing confirms or identifies discrepancies (Dan)

   - If discrepancies: contact Mary to resolve (Dan)

   - Else, send confirmation (Dan)

6. Mary matches invoice to PO (Mary)

   - If discrepancies in matching: email Purchasing (Mary)

      - If unresolved  escalate to Rita (Rita)

   - Else, proceed

7. After resolution, Manager approval (Carlos)

   - Approve  Payment Scheduling (Mary)

   - Reject  Back to Mary/Purchasing for correction

8. Payment Scheduling  End

Exception Paths:

PO Missing Path:

1. After PO check  No PO  Send to Supplier (Mary's action)

   - Karen might be involved here? Maybe Mary sends it to the supplier, but Karen can help if needed. Since Karen's interview mentions handling missing POs, perhaps in this case, Karen is involved in coordinating with the supplier to get the PO, then the invoice can be resubmitted.

   - Alternatively, the process might loop back to the start after getting PO, but that's too recursive.

   Alternatively, the PO missing path goes to a sub-process:

   - After sending to supplier, Karen contacts supplier to get PO, then invoice is resent. Once PO is obtained, it can re-enter the main process.

   So the PO missing path could be:

   - After PO check  No PO  Send to Supplier (Activity, Role: Mary)

   - Karen coordinates with supplier to obtain PO (Activity, Role: Karen)

   - Once PO obtained, resubmit invoice to start over (Loop back to step 1?)

   But this could be a bit complex. Alternatively, just note the exception and mention that it requires resolution by the exception handlers (Rita or Karen), leading back to the main process after resolution.

Another exception: Discrepancies in matching (after Purchasing confirmation but before Manager's approval). If unresolved, it goes to Rita.

Also, if the manager rejects, the invoice goes back for correction, which could involve looping back to Mary and Purchasing to fix the issues, then re-enter the approval step.

Now, structuring this into BPMN-like text with nodes and connections.

First, the main process steps with roles:

Start  [Check PO] Decision

If Yes  Log (Mary)  Forward (Mary)  Purchasing Confirms (Dan)  Match (Mary)  [Check Matching Discrepancies] Decision

   If Yes (discrepancies in matching):

       Email Purchasing (Mary)

       [After some time, unresolved]  Escalate to Rita (Rita)  Then proceed to Manager's approval?

   Else  Proceed to Manager's approval

After Manager's decision (Approve/Reject):

   If Approve  Payment Scheduling (Mary)

   If Reject  Back to Mary/Purchasing for correction (loop back to earlier steps?)

Then the exception paths:

PO Missing:

After PO check  No PO  Send to Supplier (Mary)  Karen coordinates with supplier to get PO  Once PO obtained, resubmit invoice (loop back to Start?)

Alternatively, the PO missing path is a sub-process that ends when PO is obtained, then the main process continues.

But since the user wants a textual model, maybe we can represent it with decision points and exception branches.

Now, putting this all together in text, using BPMN terms but in prose.

Here's an attempt:

**Process Model: Invoice Approval Process**

**Start Event:** "Receive Invoice (Email)"

**1. Check for Purchase Order (PO) Number Existence (Decision):**
   - *If PO exists:*
     - **Activity:** "Log Invoice into Accounting System" (Role: Mary)
     - **Activity:** "Forward Invoice to Purchasing Department for Confirmation" (Role: Mary)
     - **Activity:** "Purchasing Officer (Dan) reviews invoice against PO for discrepancies."
        - *If discrepancies found:*
            - **Activity:** "Contact Mary to hold invoice or request clarification" (Role: Dan)
        - *Else:*
            - **Activity:** "Send confirmation email to Mary" (Role: Dan)
   - *If PO does not exist:*
     - **Activity:** "Send invoice back to Supplier for PO details" (Role: Mary/Karen) 
        - *This triggers a separate exception path involving Karen to resolve PO issue with supplier.*

**2. Matching Invoice to PO (Activity):**
   - **Activity:** "Mary matches invoice line items with PO in the system" (Role: Mary)
     - *If discrepancies found during matching:*
        - **Activity:** "Email Purchasing team to resolve discrepancies" (Role: Mary)
        - *If unresolved after follow-up:*
            - **Gateway/Decision:** "Escalate to Supervisor (Rita) for resolution"
            - **Activity:** "Rita coordinates with supplier or department to resolve the issue" (Role: Rita)
   - *If no discrepancies:*
      - Proceed to next step.

**3. Manager Approval (Activity):**
   - **Activity:** "Department Manager (Carlos) reviews invoice for final approval"
      - *Decision Point:*
        - **Approve:** 
            - **Activity:** "Schedule Payment with Accounts Payable" (Role: Mary/Acct Pay Dept)
            - **End Event:** "Payment Scheduled"
        - **Reject:**
            - **Activity:** "Return invoice to Mary/Purchasing for rework" (Loop back to Step 1 or relevant previous step)
            - *This may trigger a rework loop.*

**4. Exception Handling Paths:**
   - **PO Missing Path:**
     - *After PO check fails:*
       - **Activity:** "Supervisor (Rita) or Karen (Supplier Manager) intervenes to resolve PO issue with supplier"
       - *Once PO obtained:*
         - **Loop Back:** "Resubmit invoice to start of process (Step 1)"
   - **Unresolved Discrepancies:**
     - *After escalation to Rita:*
       - **Activity:** "Rita resolves issue, invoice re-enters approval flow after resolution"
       - *Proceed to Manager's approval step.*

**5. Data/Artifacts:**
   - **Inputs/Outputs:** 
     - Invoice documents (digital files or PDFs)
     - Purchase Order numbers (PO)
     - Confirmation emails between departments
     - Payment schedules and payment files

**Notes on Ambiguities:**
- The exact timing between steps (e.g., how long before escalating to Rita) is unclear from interviews.
- Whether the payment scheduling is handled by Mary or another role (possibly Accounts Payable team) needs clarification.
- The role of Karen in PO resolution is indirect unless explicitly mentioned in the interviews; her involvement is noted but not in direct system actions.
- The "reject" path from manager could loop back to Mary to correct the invoice before re-entering approval, but this isn't explicitly detailed.

This structure captures the main flow, decision points, roles, and exception paths. It uses terms like Decision Points, Gateways (for escalations), and loops for rework. The exception paths are noted with their own activities and connections back to the main process.

I should check if all interview points are covered:

- Mary's steps: logging, forwarding, matching, discrepancies, escalation, payment scheduling. Covered in Steps 1,2,3,4 (escalation), and payment in Step 3 (Approve leads to payment).

- Dan's role in Purchasing confirmation and initial discrepancy checks: covered in Step 1 under Purchasing Officer's activity.

- Carlos's approval: in Step 3.

- Rita's exception handling: in PO missing and unresolved discrepancies paths.

- Karen's role in PO issues: mentioned in the PO missing exception path.

- Artifacts: invoices, POs, emails, payment schedules are listed.

Ambiguities noted include the exact loop structures and some role responsibilities. The model tries to be clear while acknowledging where details are missing.

I think this covers the requirements. Now, to present it in a more structured textual format as per the user's request, using BPMN terms but in prose, ensuring clarity.

</think>


**BPMN-Like Textual Process Model: Invoice Approval Process**

---

### **Process Overview**
This model captures the invoice approval workflow, decision points, roles, and exception paths based on stakeholder interviews. Ambiguities (e.g., exact timing for escalations) are noted in "Notes on Ambiguities."

---

### **1. Main Process Flow (PO Present)**
**Start Event:** *Receive Invoice (Email)*  
1. **Check for Purchase Order (PO) Existence** (Decision Point):  
   - *If PO exists:* Proceed to next steps.  
   - *If PO missing:*  
     - **Exception Path:** *PO Missing* (see below).  

2. **Log Invoice into Accounting System** (Role: Mary)  
3. **Forward Invoice to Purchasing Department** (Role: Mary)  

4. **Purchasing Officer (Dan) Reviews Invoice Against PO** (Activity):  
   - *If discrepancies found (e.g., pricing, quantities):*  
     - **Activity:** "Contact Mary to hold invoice or request clarification" (Role: Dan)  
   - *Else:*  
     - **Activity:** "Send confirmation email to Mary" (Role: Dan)  

5. **Match Invoice to PO in System** (Role: Mary):  
   - *If discrepancies detected during matching:*  
     - **Activity:** "Email Purchasing team to resolve" (Role: Mary)  
     - *If unresolved after follow-up:*  
       - **Gateway/Decision:** "Escalate to Supervisor (Rita)"  
       - **Activity:** "Rita coordinates with supplier/department to resolve" (Role: Rita)  
   - *If no discrepancies:* Proceed to next step.  

6. **Department Manager (Carlos) Approves or Rejects** (Activity):  
   - *Decision Point:*  
     - **Approve:**  
       - **Activity:** "Schedule Payment with Accounts Payable" (Role: Mary/Acct Pay Dept)  
       - **End Event:** "Payment Scheduled"  
     - **Reject:**  
       - **Activity:** "Return invoice to Mary/Purchasing for rework" (Loop back to Step 3).  

---

### **2. Exception Paths**
#### **A. PO Missing Path**  
- *After PO check fails:*  
  - **Activity:** "Send invoice to supplier for PO details" (Role: Mary)  
  - **Exception Resolution:**  
    - **Activity:** "Supervisor (Rita) or Karen (Supplier Manager) intervenes"  
      - *If resolved:*  
        - **Loop Back:** "Resubmit invoice to Start Event (Step 1)".  

#### **B. Unresolved Discrepancies**  
- *After escalation to Rita:*  
  - **Activity:** "Rita resolves issue, invoice re-enters approval flow"  
  - *Proceed to:* Step 6 (Manager’s approval).  

---

### **3. Roles and Responsibilities**  
| **Activity** | **Primary Role(s)** |  
|--------------|---------------------|  
| Log Invoice   | Mary                 |  
| Forward to Purchasing | Mary |  
| Purchasing Review | Dan (Purchasing Officer) |  
| Final Approval | Carlos (Department Manager) |  
| Payment Scheduling | Mary/Acct Pay Dept |  
| Escalation Handling | Rita (Supervisor) |  
| PO Resolution (Suppliers) | Rita/Karen |  

---

### **4. Data/Artifacts**  
- **Inputs/Outputs:**  
  - Invoice documents (e.g., PDF, XML)  
  - Purchase Order (PO) numbers  
  - Confirmation emails (Purchasing  Mary)  
  - Payment schedules and payment files  

---

### **5. Decision Points and Gateways**  
1. **PO Existence Check** (Decision):  
   - *yes  Continue*  
   - *no  PO Missing Path*  

2. **Purchasing Discrepancy Check** (Decision):  
   - *Yes  Resolve with Mary*  
   - *No  Proceed to Match Step*  

3. **Matching Discrepancy Check** (Decision):  
   - *Yes  Escalate to Rita*  
   - *No  Proceed to Manager Approval*  

4. **Manager Approval Decision** (Decision):  
   - *Approve  End*  
   - *Reject  Loop Back to Step 3*  

---

### **6. Ambiguities/Assumptions**  
- **Exact timing for escalations** (e.g., when to involve Rita) is unclear.  
- **Payment scheduling** is assumed handled by Mary/Acct Pay Dept but could involve external systems.  
- **Karen’s role** is indirect (via supplier coordination) but explicitly noted for PO resolution.  
- **"Reject" path** loops back to Mary/Purchasing for rework but does not detail the correction process.  

---

### **7. Visualizable Structure (BPMN Sketch)**  
```
[Receive Invoice (Email)]  
  
 [Check PO]  Yes  [Log/Forward]  [Purchasing Review]  [Match]  [Manager Approves]  [Payment]  
          No  [PO Missing Path]  
  
 [Purchasing Discrepancy]  Yes  [Mary Resolves]  [Match]  [Manager Approves]  
          No  [Match]  [Manager Approves]  
  
 [Matching Discrepancy]  Yes  [Rita Escalates]  [Rita Resolves]  [Manager Approves]  
          No  [Manager Approves]  
  
 [Manager Rejects]  [Return to Mary/Purchasing]  [Re-Enter Process]  
  
[End: Payment Scheduled]  
[Exception Paths: PO Missing  Loop Back]  
```  

---

This model balances clarity with the provided data, highlighting key roles, decisions, and exceptions while acknowledging gaps in detail. It can be converted into a BPMN diagram by mapping decision diamonds, gateways (for escalations), and loops for rework.