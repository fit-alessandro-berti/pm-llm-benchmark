## Proposed high-level process steps (activity aggregation)

### 1) **Material Intake & Identification**
**Low-level events included**
- Retrieve raw metal sheet  
- Scan barcode  

**Rationale / grouping rule**
- These actions establish *what* item is being processed (PartID/Barcode) and typically happen immediately at the start of the case, performed by the same role (Operator A).  
- They are “logistics + traceability” steps, distinct from physical setup or transformation.

**How to detect (heuristic)**
- Start-of-case events containing keywords: `Retrieve`, `Scan barcode`, `PartID`, `Barcode`.  
- Usually contiguous and performed by an operator before any machine processing.

---

### 2) **Workpiece Setup & Preheating (Material Preparation)**
**Low-level events included**
- Place metal sheet on table  
- Align metal sheet  
- Preheat metal sheet  

**Rationale / grouping rule**
- These events prepare the workpiece for the main transformation step (welding): positioning + alignment + thermal conditioning.  
- They represent a coherent “setup” phase, often involving mixed resources (operator places, robot aligns, heater preheats) but all aimed at making the sheet ready for joining.

**How to detect (heuristic)**
- Events after identification and before welding that contain: `Place`, `Align`, `Preheat`.  
- Ends when the first welding-related event starts.

---

### 3) **Welding / Joining Operation (Assembly)**
**Low-level events included**
- Pick up welding tool  
- Weld corner A  
- Weld corner B  
  *(and generally any repeated “Weld …” events)*

**Rationale / grouping rule**
- “Pick up welding tool” is a setup action directly enabling welding and is best interpreted as part of the same operational step rather than a standalone phase.  
- The subsequent weld actions are the core value-adding transformation (joining).  
- Events are tightly coupled in time and typically performed by the same resource (Operator B) with consistent tool context (ToolID).

**How to detect (heuristic)**
- Start when a tool-prep event appears with welding context (`Pick up welding tool`) or first `Weld*`.  
- Continue while activities match `Weld*` (possibly multiple weld points).

---

### 4) **In-Process Quality Check (Weld Integrity Inspection)**
**Low-level events included**
- Measure weld integrity  

**Rationale / grouping rule**
- This is a quality assurance gate immediately following welding, performed by a dedicated QA resource (Quality Sensor #1) and producing a measurable outcome (IntegrityScore).  
- It is logically separate from welding (production) and from final visual inspection (end-of-line).

**How to detect (heuristic)**
- Sensor/QA resource + measurement keywords: `Measure`, `IntegrityScore`.  
- Typically occurs right after the welding block and before coating.

---

### 5) **Surface Protection & Curing (Finishing)**
**Low-level events included**
- Apply protective coating  
- Dry coating  

**Rationale / grouping rule**
- These are finishing operations applied to the welded part to protect/finish the surface.  
- “Apply” and “Dry/Cure” are a natural pair: application followed by process curing (often via heating), usually sequential and machine-driven (Coating Unit, Heating Unit).

**How to detect (heuristic)**
- Activities containing `Apply *coating` followed by `Dry`/`Cure`-type steps.  
- Ends when inspection/packout/final handling begins.

---

### 6) **Final Visual Inspection (Final QA Release)**
**Low-level events included**
- Visual check  

**Rationale / grouping rule**
- This is an end-of-process acceptance step, performed by an operator (Operator C) with a pass/fail outcome.  
- It acts as the final release gate distinct from the in-process sensor measurement.

**How to detect (heuristic)**
- Activity keyword `Visual check` and AdditionalInfo like `Passed/Failed`.  
- Typically last event(s) in the case.

---

## Structured representation (mapping)

### High-level activity definitions (canonical mapping table)

| High-level step | Low-level activities mapped (examples/patterns) | Typical resources |
|---|---|---|
| Material Intake & Identification | `Retrieve raw metal sheet`, `Scan barcode` | Operator A |
| Workpiece Setup & Preheating | `Place metal sheet on table`, `Align metal sheet`, `Preheat metal sheet` | Operator A, Robot Arm #2, Heating Unit #1 |
| Welding / Joining Operation | `Pick up welding tool`, `Weld corner *` | Operator B |
| In-Process Quality Check (Weld Integrity) | `Measure weld integrity` | Quality Sensor #1 |
| Surface Protection & Curing | `Apply protective coating`, `Dry coating` | Coating Unit #3, Heating Unit #2 |
| Final Visual Inspection | `Visual check` | Operator C |

---

## Example: aggregated traces for the provided cases

### Case A1 (aggregated)
1. **Material Intake & Identification**  
   - Retrieve raw metal sheet  Scan barcode  
2. **Workpiece Setup & Preheating**  
   - Place on table  Align  Preheat  
3. **Welding / Joining Operation**  
   - Pick up welding tool  Weld corner A  Weld corner B  
4. **In-Process Quality Check (Weld Integrity)**  
   - Measure weld integrity  
5. **Surface Protection & Curing**  
   - Apply protective coating  Dry coating  
6. **Final Visual Inspection**  
   - Visual check (Passed)

### Case B2 (aggregated)
Same high-level sequence as A1.

---

## Notes on generalization to the “full log”
- **Keyword-based activity clustering** is the simplest robust rule here (Retrieve/Scan; Place/Align/Preheat; Weld/tool; Measure; Coat/Dry; Visual).  
- **Resource-type cues** (Operator vs Robot vs Sensor vs Coating/Heating unit) reinforce phase boundaries, especially between production vs inspection.  
- **Temporal proximity** (events within a short time window) helps decide whether tool pickup belongs with welding (it does) and whether drying belongs with coating (it does).

If you share a larger snippet (including rework, failures, or additional checks), I can extend the scheme with branching steps (e.g., “Rework Welding,” “Re-inspection,” “Hold/Reject”).