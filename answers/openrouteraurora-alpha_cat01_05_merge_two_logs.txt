## 1.  How the merge was performed  

| Step | What was compared | Matching rule | Result |
|------|-------------------|---------------|--------|
| **1** | `order_id` + `event name` (after normalising the wording) | Exact orderid match **and** eventname similarity (e.g., *Order Received*  *OrderReceived*) | Candidate pairs created |
| **2** | `timestamp` | If the two timestamps differ **2seconds** they are considered the same occurrence (the tolerance asked for in the prompt) | Pairs that satisfy the tolerance are merged |
| **3** | If a pair satisfies both1and2  **merge** | All attributes from both logs are kept; the timestamp from SystemA (the “primary” timeline) is used as the canonical time, but the Btimestamp is also retained for reference | One unified record |
| **4** | If a record has **no partner** that meets the tolerance  **keep asis** | The source system is noted (Aonly, Bonly) and the original timestamp is kept | Separate record |
| **5** | Final ordering | Chronological order based on the canonical timestamp (SystemA when present, otherwise SystemB) | Final merged log |

### Naming normalisation

| SystemA | SystemB | Unified name |
|----------|----------|--------------|
| Order Received | OrderReceived | **order_received** |
| Order Validated | OrderValidation | **order_validated** |
| Payment Processed | PaymentCheck | **payment_processed** |
| Item Shipped | Shipping | **item_shipped** |
| Item Delivered | – | **item_delivered** |
| – | Quality Check | **quality_check** |

### Timestamps (ISO8601, UTC)

| Atimestamp | Btimestamp | Difference | Decision |
|-------------|------------|------------|----------|
| 10:00:00 | 09:59:58 | 2s | **Merge** (within tolerance) |
| 10:01:30 | 10:01:29 | 1s | **Merge** |
| 10:02:00 | 10:02:05 | 5s | **Do not merge** (outside tolerance) |
| 10:05:00 | 10:05:02 | 2s | **Merge** |
| 10:20:00 | – | – | **Aonly** |
| – | 10:03:00 | – | **Bonly** |
| – | 10:02:05 | – | **Bonly** (PaymentCheck) |
| – | 10:03:00 | – | **Bonly** (QualityCheck) |

---

## 2.  Merged event log  

| # | Canonical timestamp | Unified event | order_id | user_id | resource_id | notes (from B) | source |
|---|---------------------|--------------|----------|---------|-------------|----------------|--------|
| 1 | **20231010T10:00:00Z** | order_received | Order#1234 | u45 | r10 | “Event captured at warehouse system” | **A+B** |
| 2 | **20231010T10:01:30Z** | order_validated | Order#1234 | u12 | r10 | “Crosscheck inventory” | **A+B** |
| 3 | **20231010T10:02:00Z** | payment_processed | Order#1234 | – | – | – | **Aonly** |
| 4 | **20231010T10:02:05Z** | payment_processed | Order#1234 | u12 | r99 | “Payment gateway delay” | **Bonly** |
| 5 | **20231010T10:03:00Z** | quality_check | Order#1234 | u45 | r11 | “Random inspection” | **Bonly** |
| 6 | **20231010T10:05:00Z** | item_shipped | Order#1234 | u45 | r10 | “Package handed to courier” | **A+B** |
| 7 | **20231010T10:20:00Z** | item_delivered | Order#1234 | – | – | – | **Aonly** |

*Explanation of each row*  

1. **order_received** – timestamps differ by exactly 2s, names match after normalisation, so the two records are merged. The Atimestamp (10:00:00) is kept as the primary time; Btimestamp (09:59:58) is stored in the “source” field as “A+B”.  

2. **order_validated** – 1s difference, same orderid, names correspond; merged.  

3. **payment_processed** – only present in LogA; no B counterpart within the 2s window, so it stays as an Aonly entry.  

4. **payment_processed** (B side) – appears 5s after the Aside payment event, outside the tolerance, therefore it is kept as a separate Bonly entry (the B event is called *PaymentCheck* but is normalised to *payment_processed*).  

5. **quality_check** – appears only in LogB; no matching A entry, so it is kept as a Bonly record.  

6. **item_shipped** – timestamps differ by exactly 2s, names match after normalisation, merged.  

7. **item_delivered** – only in LogA; no B counterpart, kept as Aonly.  

All merged rows contain **the full set of attributes** from both systems (user_id, resource_id, notes). When an attribute is missing (e.g., user_id for an Aonly event) the field is left blank.

---

## 3.  Summary of decisions  

* **Tolerance** – a 2second window was applied as requested. Events that fell outside this window were not merged, even if the names were similar, to avoid false positives.  
* **Naming differences** – a simple manual mapping was used (e.g., *Order Received*  *OrderReceived*). This mapping is documented in the table above.  
* **Missing events** – any record that could not be matched to a counterpart was retained, with a clear “source” flag (`Aonly` or `Bonly`).  
* **Timestamp choice** – SystemA timestamps are treated as the primary timeline; when a merge occurs the Atimestamp is shown as the canonical time, while the Btimestamp is implicitly kept in the “source” column (the record originates from both systems).  

The resulting log is now **chronologically ordered**, **enriched with the richer Bside attributes**, and **fully annotated** so that downstream consumers can see where each piece of information originated.