## 1. Queue Identification and Characterization

### 1.1. How to derive waiting times from the event log

**Definition of waiting time**

For a given patient visit (Case ID), and a sequence of activities:

- Service time for an activity A:  
  `service_time(A) = COMPLETE(A) – START(A)`
- Waiting time **before** activity B (queue time for B):  
  `waiting_time(before B) = START(B) – COMPLETE(previous activity)`  
  where “previous activity” is the last completed activity for that visit that logically precedes B.

In this clinic context, typical queues are:

- Arrival  Registration
- Registration  Nurse Assessment
- Nurse Assessment  Doctor Consultation
- Doctor Consultation  Diagnostic Test (e.g., ECG, X-Ray, Lab)
- Diagnostics  Specialist Review (if applicable)
- Last clinical step  Check-out

**Implementation steps**

1. **Sort events**: For each Case ID, sort all events by timestamp.
2. **Pair start and complete**: For each activity instance, pair its START and COMPLETE to get service times.
3. **Generate activity sequence**: Collapse each pair into one record:  
   `(Case ID, Activity, start_time, complete_time, Resource, Patient Type, Urgency, …)`
4. **Compute inter-activity waiting times**:
   - For each case, for each pair of consecutive activities (A then B in trace order):  
     `wait_AB = start_time(B) – complete_time(A)`.
   - Waiting time can be 0 or near 0 if the patient moves immediately.
   - Negative or very small negative intervals indicate data issues or overlapping activities; flag and clean or handle separately.

5. **Queue by station vs. by transition**
   - **By activity/station**: total waiting time before “Doctor Consultation” regardless of what came before.
   - **By transition**: RegistrationNurse, NurseDoctor, DoctorECG, etc. This is more actionable.

### 1.2. Queue metrics to calculate

For each **queue** (e.g., “RegistrationNurse”, “NurseDoctor Cardio”):

1. **Descriptive statistics** (per queue, optionally per Patient Type / Urgency / day-of-week):
   - Mean waiting time
   - Median waiting time
   - 75th, 90th, 95th percentile waiting time
   - Maximum waiting time
   - Standard deviation (variability)

2. **Volume and exposure**
   - Number of cases that go through this queue (queue frequency).
   - Percentage of all visits that experience this queue.
   - Number and percentage of cases with waiting time above a threshold (e.g., > 30, 60, 90 minutes).

3. **Temporal profiles**
   - Average waiting time by hour of day / day of week.
   - Queue length over time (using arrival and start times to infer how many patients are “waiting” at each instant; see queue mining below).

4. **Stratification**
   - By **Patient Type**: New vs. Follow-up vs. procedure-only.
   - By **Urgency**: Urgent vs. Normal (do urgent cases still wait too long? Do they bypass queues?).
   - By **specialty**: Cardio vs. Ortho vs. Endocrinology, etc.

### 1.3. Identifying the most critical queues

Use a combination of **impact, severity, and sensitivity**:

1. **Severity of wait**
   - High mean and high 90th percentile waiting time.
   - Large difference between median and 90th percentile (indicating many outliers or peak-time overloads).

2. **Volume/coverage**
   - Queues affecting a large fraction of patients (e.g., RegistrationNurse; NurseDoctor for common specialties).

3. **Clinical/satisfaction impact**
   - Queues before critical steps (Doctor Consultation, urgent tests).
   - Queues that occur early in the visit (e.g., Registration), as they shape perception.
   - Queues affecting urgent patients or high-risk specialties disproportionately.

4. **Sensitivity to demand**
   - Queues that spike at certain times of day (morning peaks) where small resource adjustments might have large effect.

A practical scoring approach:

For each queue, compute a **priority score**:

`Priority = (normalized 90th percentile wait) × (proportion of visits affected) × (clinical weight)`

- Clinical weight higher for urgent queues, doctor, diagnostics.
- Sort queues by this score: the top 3–5 are your “critical queues” for immediate action.

---

## 2. Root Cause Analysis

### 2.1. Potential root causes

1. **Resource bottlenecks**
   - Too few doctors, nurses, techs, or registration clerks in peak windows.
   - Shared resources (e.g., ECG Room 3 used by multiple specialties).
   - Under- or over-utilization due to scheduling patterns.

2. **Activity dependencies and handovers**
   - Sequential steps that could be parallelized (e.g., some labs pre-visit vs. post-consult).
   - Delays in handover between roles (nurse finishes, but doctor is not notified promptly or is double-booked).
   - “Batching” behavior (nurses assess 5 patients then “release” them to doctors in a batch).

3. **Variability in service time**
   - High variance in doctor consultation durations (complex vs. simple cases).
   - Variability in registration completeness (new vs. follow-up, insurance issues).
   - Diagnostic tests taking unpredictable time due to ad hoc add-ons.

4. **Appointment scheduling policies**
   - Too many arrivals in the same time slot (“9:00 AM overbooking”).
   - No differentiation by patient type or expected duration (new vs. follow-up).
   - Lack of buffer slots for urgent walk-ins, causing pre-booked patients to wait.

5. **Patient arrival patterns**
   - Clustering around early morning and immediately after lunch.
   - Early arrivals being processed immediately and crowding the system.
   - Walk-ins mixed with appointments without a triage/prioritization policy.

6. **Patient type and urgency differences**
   - New patients require more time at registration and with doctor.
   - Urgent patients interrupt scheduled activities, causing cascading delays.
   - Certain specialties (e.g., Cardio) require multiple tests, causing repeated queues.

### 2.2. How process mining and queue mining help pinpoint root causes

1. **Bottleneck analysis**
   - Use throughput time and waiting-time heatmaps on the process model.
   - Identify activities where:
     - Incoming flow is high and outgoing flow is slower.
     - Activities with long average cycle times (service + wait).

   Example: “Nurse Assessment” shows high utilization 9–11 AM and high waiting times before “Doctor Consultation (Cardio)” during that window.

2. **Resource analysis**
   - For each resource (e.g., Dr. Smith, Nurse 1, ECG Room 3):
     - Calculate utilization: busy time / available time per hour/day.
     - Measure average queue length and waiting time for that resource.
     - Check concurrency: how many patients are being “handled” in parallel?

   Patterns:
   - Very high waiting + high utilization  classical bottleneck.
   - High waiting + low utilization  coordination or scheduling problem (e.g., staff not synchronized).

3. **Variant analysis (process variants)**
   - Compare typical patient journeys:
     - New vs. Follow-up.
     - Urgent vs. Normal.
     - Specialty A vs. Specialty B.
   - Identify variants with significantly higher total waiting time or more steps.
   - See which variants repeatedly include problematic transitions (e.g., always NurseDoctor Cardio with long waits).

4. **Performance over time**
   - Overlay wait times and resource utilization by time of day and day of week.
   - Identify **peaks** (e.g., Monday mornings, post-holiday days) where queues explode.
   - Correlate with appointment volume and staff schedules.

5. **Queue mining specifics**
   - Reconstruct **virtual queues** using event logs:
     - Patients “arrive” to an activity when the preceding activity completes.
     - Activity capacity is limited by the number of available resources.
   - For each activity, compute:
     - Time-dependent queue length (how many waiting at each time).
     - Distribution of waiting times conditional on queue length.
   - Identify whether delays are due to:
     - Chronically insufficient capacity, or
     - Short but severe peaks (perhaps solvable with micro-adjustments).

---

## 3. Data-Driven Optimization Strategies

Below are three concrete strategies, each linked to specific queues and root causes.

### Strategy 1: Time-of-Day Resource Rebalancing and Micro-Scheduling

**Targets:**
- Key queues: RegistrationNurse, NurseDoctor, DoctorDiagnostics in peak windows.
- Especially for high-volume specialties (e.g., internal medicine, cardiology).

**Underlying root causes:**
- Demand peaks (many appointments at same clock time).
- Mismatch between staff schedules and arrival patterns.
- Fixed staffing levels across the day despite variable demand.

**Data/analysis that supports it:**
- From queue mining:
  - Plot waiting times by time-of-day for each queue.
  - Example (hypothetical):
    - NurseDoctor (Cardio): average wait 12 min off-peak, 45 min between 9–11 AM.
    - Registration wait spikes to 30+ minutes at 8:30–9:30 AM but <10 later.
- From resource analysis:
  - Dr. Smith fully booked 9–11 AM with 15-min slots for complex new patients.
  - Some other doctors less utilized in same window.
  - Registration clerks: Clerk A and B both at 100% utilization 8:30–10:00; under 60% after 11:00.

**Interventions:**

1. **Shift resource capacity to peaks**
   - Add one extra registration clerk or cross-trained staff 8:15–10:00 and 13:00–14:00.
   - Ensure an extra nurse works 8:30–11:00 on heavy days (Mon/Wed).
   - Slightly extend doctor coverage or stagger doctor start times to cover peaks (e.g., one doctor starts at 7:30, one at 9:00).

2. **Micro-adjustments to appointment templates**
   - Limit the number of new patients per hour to control complexity.
   - Spread arrivals: use 10-min staggering (8:30, 8:40, 8:50, …) instead of “everything at 9:00”.
   - Introduce “buffer slots” around known peak times for urgent walk-ins.

3. **Dynamic room allocation for diagnostics**
   - Use combined utilization view of all ECG/X-ray rooms.
   - Temporarily reassign room/technician to the modality with highest queue length between 10–12.

**Expected impact (example, based on typical reductions from better alignment):**
- NurseDoctor average wait in peak windows could reduce from 45 to 25–30 minutes (30–40% reduction).
- Registration wait 8:30–9:30 reduced from 30 to 15–20 minutes.
- Overall visit time for peak-period patients reduced by 10–20%.

---

### Strategy 2: Appointment Duration Differentiation and Pre-visit Work

**Targets:**
- Queues to doctor, especially for **new patients** and complex specialties.
- Registration queues for first-time visits.

**Underlying root causes:**
- New and complex patients have longer service times but are booked as if they were short visits.
- Registration for new patients takes longer due to data entry and insurance verification.
- These longer services disrupt schedules and cause subsequent delays for everyone.

**Data/analysis that supports it:**
- From event log:
  - Compare service_time(Doctor Consultation) for new vs. follow-up.
    - Example: New Cardio patients: median 25 min; follow-up: median 12 min.
  - Compare registration time: new: median 7 min; follow-up: median 3 min.
- From queue metrics:
  - Patients following long consultations have higher waiting times.
  - Days with more new patients have higher average waiting for later slots.

**Interventions:**

1. **Duration-based appointment templates**
   - Create separate appointment types:
     - “New – Cardio (30 min)”
     - “Follow-up – Cardio (15 min)”
     - “Complex follow-up (20 min)” if logs show a subset with longer times.
   - Use historic distributions to set planned slot lengths (e.g., 75th percentile of service times).

2. **Pre-visit registration and e-intake**
   - Let new patients complete demographic, medical history, and insurance pre-check online or via call before arrival.
   - Registration at the clinic becomes a quick verification rather than full data entry.

3. **Pre-lab or pre-ECG pathways**
   - For selected conditions (e.g., stable Cardio follow-ups), pre-order standardized tests before consultation; patient comes with results ready.

**Expected impact:**
- Reduced variance in doctor consultation times; schedule adherence improves.
- Queue to doctor stabilizes; fewer “cascading delays”.
- Registration waiting for new patients drops because much work is done pre-visit.
- In similar settings, slot differentiation can reduce downstream waiting by 20–30% for affected patient types and improve on-time start of doctor visits by >15–20 percentage points.

---

### Strategy 3: Parallelization and Smart Routing of Diagnostics

**Targets:**
- Queues between Doctor Consultation and Diagnostics (e.g., DoctorECG, DoctorX-Ray).
- Queues for diagnostics that currently operate strictly sequentially.

**Underlying root causes:**
- Sequential flow: patient sees doctor, then is sent to diagnostics; all diagnostic demand is “bursting” after doctor visits.
- Limited diagnostic equipment or technicians with high contention across specialties.
- No routing logic (patients simply join first-visible queue).

**Data/analysis that supports it:**
- From event log:
  - Measure typical time from Doctor complete to diagnostic START (e.g., ECG) by hour.
  - Identify if diagnostics idle at certain times while doctors overloaded.
- Resource utilization:
  - X-ray Room 1 at 80% in morning, 30% after 15:00.
  - ECG room only 50% utilized overall, but long queues in specific windows.
- Path analysis:
  - Patients needing multiple tests often go Doctor  Test1  back to waiting  Test2; repeated handovers create multi-queue experience.

**Interventions:**

1. **Parallel pathways where clinically safe**
   - For common protocols (e.g., cardio follow-up), define standard pre-visit or parallel tests:
     - ECG or routine lab done before doctor, so that results are ready.
   - For multi-test patients, **cluster** tests in a single contiguous block (Test1Test2 back-to-back) wherever scheduling allows.

2. **Dynamic routing between equivalent resources**
   - If multiple ECG rooms or techs exist:
     - Route patients to the resource with the shortest predicted waiting time (based on queue length and average test duration).
   - Use simple rules or an algorithmic dispatcher; log data can provide the predictions.

3. **Dedicated diagnostic slots for high-demand specialties**
   - E.g., reserve ECG capacity 8–9 AM and 13–14 for Cardio.
   - Align with Cardio clinic sessions to avoid post-consult burst.

**Expected impact:**
- Reduced waiting time between doctor and diagnostics for Cardio patients by 25–40% (moving from “all after consult” to “part pre-visit/parallel”).
- Shorter overall visit duration for multi-test patients.
- More even utilization of diagnostic resources across the day.

---

## 4. Trade-offs and Constraints

### 4.1. Potential trade-offs and side-effects

1. **Shifting bottlenecks**
   - Reducing Registration wait may push more patients into Nurse queues faster, moving the bottleneck.
   - Parallelizing diagnostics may shift congestion to doctor review of test results instead.

2. **Cost and staffing**
   - Adding staff in peaks increases labor cost.
   - Rebalancing may require changing contracts, shifts, or cross-training, which has cost and change management implications.

3. **Staff workload and satisfaction**
   - Concentrating high-intensity slots in the morning might lead to burnout.
   - Doctors might perceive reduced autonomy due to standardized durations and pre-ordered tests.

4. **Care quality**
   - Aggressive time-based scheduling can pressure clinicians to shorten consultations.
   - Pre-ordered tests might sometimes be unnecessary if clinical condition changed.

5. **Complexity and technology adoption**
   - New routing rules and pre-visit processes require system updates, training, and patient compliance.
   - Overly complex scheduling rules can be hard to implement in legacy systems.

### 4.2. Balancing conflicting objectives

1. **Joint optimization with constraints**
   - Define explicit constraints: e.g., minimum consultation length, maximum desired waiting times, maximum additional staffing cost.
   - Use simulation (discrete-event simulation driven by the event log parameters) to test trade-offs before implementation.

2. **Thresholds and guardrails**
   - Instead of minimizing cost or wait time absolutely, set acceptable ranges:
     - E.g., “90% of patients should see the doctor within 45 minutes of nurse assessment.”
   - Evaluate options that meet these thresholds at minimal additional cost.

3. **Phased implementation**
   - Pilot changes in one specialty (e.g., Cardiology) or one time slot.
   - Monitor effects on wait times and staff workload; adjust before scaling.

4. **Staff involvement**
   - Validate proposed changes with clinicians and staff; incorporate their qualitative input on safety and workload.
   - Use process mining results as a neutral “mirror” to foster consensus.

---

## 5. Measuring Success

### 5.1. KPIs for post-implementation evaluation

At multiple levels:

**Patient-level / flow KPIs**

1. **Total visit duration**
   - Arrival to check-out, overall and per specialty/patient type.

2. **Waiting time metrics (by queue and globally)**
   - Average and median waiting time per queue (e.g., NurseDoctor).
   - 90th percentile waiting time per queue.
   - Total waiting time per visit (sum over all queues).
   - Percentage of visits with any single wait > X minutes (e.g., > 30 or > 60).

3. **Throughput**
   - Number of patients processed per day per specialty.
   - Time-of-day throughput consistency.

**Resource-level KPIs**

4. **Utilization**
   - Doctor, nurse, registration clerk, tech utilization (busy vs. idle).
   - Balance target: avoid both underuse and chronic >85–90% utilization in peak times.

5. **Schedule adherence**
   - Average delay of doctor appointment start vs. scheduled time.
   - Percentage of appointments starting within 10 minutes of scheduled time.

**Patient experience and quality**

6. **Satisfaction scores**
   - Overall satisfaction and “waiting time satisfaction” from surveys.
   - Complaints relating to delays pre- and post-intervention.

7. **Clinical outcomes/safety proxies**
   - For urgent patients: time to first clinical assessment (triage/nurse).
   - No increase in rework (e.g., repeat visits because issues were rushed).

### 5.2. Ongoing process monitoring

Use the same type of event log, but with continuous monitoring:

1. **Automated dashboards**
   - Set up dashboards (e.g., in a BI tool connected to the process mining engine) for:
     - Real-time or daily waiting time by queue.
     - Weekly trend of key KPIs (90th percentile waits, total visit duration, utilization).

2. **Statistical process control**
   - Use control charts on key KPIs:
     - Detect when waiting times drift upward beyond “normal variation”.
   - Compare pre- vs. post-intervention distributions (e.g., Mann–Whitney test for medians).

3. **Variant tracking**
   - Monitor whether new undesired variants emerge (e.g., new ad hoc pathways that create fresh bottlenecks).
   - Confirm that intended variants (e.g., pre-lab flows) are used at the target rate.

4. **Feedback loops**
   - Quarterly reviews with clinical and operations leaders:
     - Review mining results.
     - Adjust appointment templates, staffing, and routing rules.
   - Annual recalibration of appointment durations with fresh 6–12 months of event data.

---

### Summary

Using the start/complete timestamps, you can reconstruct all queues in the clinic, measure waiting times in detail, and identify the most critical bottlenecks by combining severity, volume, and clinical impact. Root causes typically lie in mismatched staffing vs. demand, appointment templates that ignore true service time distributions, and strictly sequential workflows that could be parallelized or re-routed.

Data-driven strategies such as time-of-day resource rebalancing, duration-based appointment templates with pre-visit work, and parallel/smartly routed diagnostics can materially reduce waiting times and total visit duration without major cost increases. Success depends on carefully monitoring KPIs, anticipating trade-offs, testing changes in pilots, and embedding continuous process mining-based monitoring into routine operations.