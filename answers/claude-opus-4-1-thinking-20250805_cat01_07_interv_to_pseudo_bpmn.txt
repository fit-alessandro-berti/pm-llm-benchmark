# Invoice Approval Process - BPMN Textual Model

## Process Participants (Swimlanes)
- **Supplier** (External)
- **Accounts Payable Clerk** (Primary: Mary)
- **Purchasing Officer** (Primary: Dan)
- **Department Manager** (Primary: Carlos)
- **Accounts Payable Supervisor** (Rita - Exception handling)
- **Supplier Relationship Manager** (Karen - Exception support)

## Process Flow

### Start Event
- **Trigger:** Invoice received via email from Supplier

### Main Process Path

1. **Activity: Receive Invoice** [Accounts Payable Clerk]
   - Input: Invoice document (email)
   - Output: Invoice for processing

2. **Gateway: Valid PO Number Present?** [Accounts Payable Clerk]
   - **YES  Continue to Step 3**
   - **NO  Go to Exception Path A**

3. **Activity: Log Invoice in Accounting System** [Accounts Payable Clerk]
   - Input: Invoice with PO number
   - Output: System-logged invoice record

4. **Activity: Forward Invoice for Receipt Confirmation** [Accounts Payable Clerk]
   - Output: Request sent to Purchasing Officer

5. **Activity: Verify Receipt of Goods/Services** [Purchasing Officer]
   - Input: Invoice details, Purchase Order
   - Task: Compare invoice against PO (quantities, prices, delivery charges)

6. **Gateway: Goods/Services Received and Details Correct?** [Purchasing Officer]
   - **YES  Continue to Step 7**
   - **NO  Go to Exception Path B**

7. **Activity: Send Confirmation to AP** [Purchasing Officer]
   - Output: Confirmation email

8. **Activity: Match Invoice Line Items with PO** [Accounts Payable Clerk]
   - Input: Invoice, PO, Receipt confirmation
   - Task: System matching of invoice against PO

9. **Gateway: Invoice Matches PO?** [Accounts Payable Clerk]
   - **YES  Continue to Step 10**
   - **NO  Go to Exception Path C**

10. **Activity: Request Manager Approval** [System/Accounts Payable Clerk]
    - Output: Automatic email notification to Department Manager
    - Includes: Invoice details, PO, confirmation from Purchasing

11. **Activity: Review Invoice for Approval** [Department Manager]
    - Input: Invoice, PO, Purchasing confirmation
    - Task: Review quantities, pricing, budget alignment

12. **Gateway: Manager Approves?** [Department Manager]
    - **YES  Continue to Step 13**
    - **NO  Go to Exception Path D**

13. **Activity: Schedule Payment** [Accounts Payable Clerk]
    - Input: Approved invoice
    - Output: Invoice added to payment cycle

### End Event
- **Result:** Invoice approved and scheduled for payment

## Exception Paths

### Exception Path A: Missing PO Number
1. **Activity: Request PO Details from Supplier** [Accounts Payable Clerk]
   - Output: Request sent to supplier
2. **Gateway: PO Number Provided?**
   - **YES  Return to Step 2 (main flow)**
   - **NO  Escalate to Exception Path E**

### Exception Path B: Receipt/Details Issue
1. **Gateway: Can Issue be Resolved Directly?** [Purchasing Officer]
   - **YES  Activity: Contact Supplier Directly** [Purchasing Officer]
     - Then: Activity: Wait for Corrected Invoice
     - Return to Step 5
   - **NO  Activity: Request AP to Hold Invoice** [Purchasing Officer]
     - Continue to Exception Path C

### Exception Path C: Invoice Discrepancy
1. **Activity: Email Purchasing Team for Clarification** [Accounts Payable Clerk]
2. **Gateway: Can Discrepancy be Resolved?**
   - **YES  Activity: Resolve Discrepancy** [Accounts Payable Clerk/Purchasing Officer]
     - May involve: Supplier Relationship Manager for contract verification
     - Return to Step 8
   - **NO  Continue to Exception Path E**

### Exception Path D: Manager Rejection
1. **Activity: Hold Invoice for Investigation** [Accounts Payable Clerk]
2. **Activity: Investigate Issue** [Accounts Payable Clerk]
   - Note: Manager cites reasons (budget concerns, unexpected items)
3. **Gateway: Issue Resolved?**
   - **YES  Return to Step 10**
   - **NO  Continue to Exception Path E**

### Exception Path E: Escalation to Supervisor
1. **Activity: Escalate to AP Supervisor** [Accounts Payable Clerk]
2. **Activity: Investigate and Coordinate Resolution** [Accounts Payable Supervisor]
   - May include:
     - Contact suppliers
     - Coordinate between departments
     - Create retrospective PO for informal services
     - Involve Supplier Relationship Manager for contract issues
3. **Gateway: Can Invoice be Processed?**
   - **YES  Activity: Clear Exception** [Accounts Payable Supervisor]
     - Return to appropriate step in main flow (typically Step 5)
   - **NO  Activity: Reject Invoice** [Accounts Payable Supervisor]
     - End Event: Invoice rejected

## Key Business Rules and Notes

1. **PO Requirement:** No invoice is processed without a valid PO reference (can be created retrospectively in exceptional cases)
2. **Three-Way Match:** Invoice must match PO and receipt confirmation before manager approval
3. **Escalation Frequency:** Manager rejections occur approximately once every couple of months
4. **Communication Channels:** Primary communication via email between departments
5. **System Integration:** Accounting system automatically triggers manager approval notifications after matching confirmation

## Artifacts/Documents
- Invoice (email format)
- Purchase Order (PO)
- Receipt confirmation
- Approved invoice record
- Payment schedule

## Areas of Uncertainty/Variation
- The exact mechanism for creating retrospective POs for informal services is not fully detailed
- The specific criteria for when Supplier Relationship Manager is involved versus when issues are resolved directly between AP and Purchasing