This is a classic "filtering by group size" problem in SQL. There are two primary ways to achieve this in DuckDB: using a **Window Function** (cleanest) or a **Subquery with a HAVING clause** (standard SQL).

### Option 1: Using a Window Function (Recommended for DuckDB)
Window functions allow you to calculate the count for each case without collapsing the rows, making it very efficient for filtering.

```sql
SELECT 
    case_id, 
    activity, 
    "timestamp"
FROM (
    SELECT 
        *, 
        COUNT(*) OVER (PARTITION BY case_id) AS event_count
    FROM event_log
) AS counted_events
WHERE event_count <= 6;
```

**How it works:**
1.  **`COUNT(*) OVER (PARTITION BY case_id)`**: This calculates the total number of rows for each `case_id` and appends it as a new column to every row.
2.  **Subquery**: We wrap this in a subquery because SQL doesn't allow you to use window function results directly in a `WHERE` clause.
3.  **Filter**: The outer query keeps only the rows where the calculated `event_count` is 6 or fewer.

---

### Option 2: Using a Subquery with `GROUP BY` and `HAVING`
This is a more traditional approach that identifies the "valid" IDs first and then fetches their data.

```sql
SELECT *
FROM event_log
WHERE case_id IN (
    SELECT case_id
    FROM event_log
    GROUP BY case_id
    HAVING COUNT(*) <= 6
);
```

**How it works:**
1.  **Inner Query**: Groups the table by `case_id` and calculates the count for each. The `HAVING` clause filters that list to only include IDs with 6 or fewer events.
2.  **Outer Query**: Uses the `IN` operator to return all columns for only those specific `case_id`s.

---

### Which one should you use?
*   **Performance:** In DuckDB, **Option 1 (Window Function)** is often highly optimized and slightly more performant for large datasets because it avoids a full inner join/semi-join logic.
*   **Readability:** **Option 2** is often easier for beginners to read, as it follows a logical "Find the IDs, then get the data" flow.

**Note on Reserved Words:** In some SQL environments, `timestamp` is a reserved keyword. While DuckDB is flexible, I have wrapped it in double quotes (`"timestamp"`) in the first example as a best practice.