### Merged Event Log: Order Fulfillment Process (Order#1234)

The following table represents the integrated data from System A and System B. Where events were matched, attributes from both systems have been combined.

| Timestamp (Primary) | Unified Event Name | Order ID | User ID | Resource ID | Origin | Notes / Metadata |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 2023-10-10T09:59:58Z | **Order Received** | Order#1234 | u45 | r10 | Both | Log B capture time used. Note: "Event captured at warehouse system" |
| 2023-10-10T10:01:29Z | **Order Validated** | Order#1234 | u12 | r10 | Both | Log B capture time used. Note: "Cross-check inventory" |
| 2023-10-10T10:02:00Z | **Payment Processed** | Order#1234 | u12 | r99 | Both | Log A time used as primary. Note: "Payment gateway delay" (Log B) |
| 2023-10-10T10:03:00Z | **Quality Check** | Order#1234 | u45 | r11 | Log B | Note: "Random inspection". No corresponding event in System A. |
| 2023-10-10T10:05:00Z | **Item Shipped** | Order#1234 | u45 | r10 | Both | Log A time used as primary. Note: "Package handed to courier" (Log B) |
| 2023-10-10T10:20:00Z | **Item Delivered** | Order#1234 | — | — | Log A | Event not recorded in Log B. |

---

### Integration Reasoning and Documentation

To create this unified log, the following logic and rules were applied:

#### 1. Matching Logic & Timestamp Tolerance
*   **The 2-Second Rule:** Most events matched within a 1–2 second window (e.g., *Order Received* and *Order Validated*). These were merged immediately as the semantic meaning and order ID were identical.
*   **Exception Handling (Payment Processed):** The timestamps for the payment event differed by 5 seconds (10:02:00 vs 10:02:05). However, because "Payment Processed" (Log A) and "PaymentCheck" (Log B) are semantically similar and Log B specifically included a note about "Payment gateway delay," it was determined that these represent the same activity. 
*   **Primary Timestamp Selection:** In cases where timestamps differed, the **earlier timestamp** was generally preferred as the "Primary" timestamp, assuming it represents the actual start of the action, while the later timestamp often represents the time the record was written to the database.

#### 2. Event Name Normalization
A unified naming convention was adopted to ensure clarity:
*   "OrderReceived" (B) and "Order Received" (A)  **Order Received**
*   "OrderValidation" (B) and "Order Validated" (A)  **Order Validated**
*   "PaymentCheck" (B) and "Payment Processed" (A)  **Payment Processed**
*   "Shipping" (B) and "Item Shipped" (A)  **Item Shipped**

#### 3. Handling Non-Overlapping Events
*   **Quality Check:** This event appeared only in Log B. It was included in the final log to provide a richer history of the order fulfillment, though it lacks a corresponding Log A record.
*   **Item Delivered:** This event appeared only in Log A. This suggests System B might only track warehouse-side activities, whereas System A tracks the customer-facing lifecycle. It was included to ensure the timeline is complete.

#### 4. Attribute Enrichment
For all merged records, the `user_id`, `resource_id`, and `notes` from System B were appended to the base event from System A. For events existing only in one system, missing attributes were left blank or marked as N/A.