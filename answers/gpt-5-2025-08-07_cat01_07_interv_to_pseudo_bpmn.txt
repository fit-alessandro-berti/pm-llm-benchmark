BPMN-like textual process model for Invoice Approval

Participants (pools/lanes)
- Supplier
- Accounts Payable (AP Clerk – Mary)
- Purchasing (Purchasing Officer – Dan)
- AP Supervisor (Rita)
- Department Manager (Carlos)
- Supplier Relationship Manager (SRM – Karen)
- Accounting System (System)

Key data artifacts
- Supplier invoice (original/revised)
- Purchase Order (PO)
- Goods/services receipt confirmation or goods receipt
- Contract/pricing terms
- Discrepancy/clarification emails
- Manager approval record
- Payment schedule entry

Main flow (happy path)
1. Start Event: Invoice received by email (Supplier -> AP Clerk).
2. Task (AP Clerk): Check invoice for valid PO number.
3. Exclusive Gateway: Has valid PO?
   - Yes -> 4
   - No -> A1 (Non-PO / missing PO path)
4. Task (AP Clerk): Log invoice into Accounting System [creates Invoice Record].
5. Task (AP Clerk -> Purchasing): Request receipt confirmation (message to Purchasing).
6. Task (Purchasing): Validate receipt of goods/services and compare quantities/prices with PO.
7. Exclusive Gateway: Receipt confirmed and basic PO details OK?
   - Yes -> 8
   - No -> B1 (Receipt/PO issue path)
8. Task (AP Clerk): Perform line-item match of invoice to PO in System (3-way match with receipt).
9. Exclusive Gateway: Match successful?
   - Yes -> 10
   - No -> C1 (Discrepancy path)
10. Task (System): Auto-send manager approval request email with invoice, PO, and receipt confirmation to Department Manager.
11. Task (Department Manager): Review and approve.
12. Exclusive Gateway: Manager decision
   - Approve -> 13
   - Reject/Hold -> D1 (Manager exception path)
13. Task (AP Clerk): Schedule invoice in next payment run in Accounting System.
14. End Event: Invoice scheduled for payment.

Exception and variation paths

A. Missing or non-PO invoices
A1. Task (AP Clerk -> Supplier): Request PO number or additional details; hold invoice.
A2. Intermediate Message Event: Receive revised invoice with valid PO?
   - Yes -> 4
   - No / cannot link to any PO -> A3
A3. Task (AP Clerk): Escalate to AP Supervisor.
A4. Task (AP Supervisor): Decide handling for non-PO invoice.
   - Exclusive Gateway:
     - Create retrospective PO in coordination with department head -> return to 4
     - Reject invoice (notify Supplier and Department) -> End Event: Invoice rejected.

B. Receipt or PO issues identified by Purchasing
B1. Task (Purchasing): Instruct AP to hold invoice; optionally contact Supplier for clarification or corrected invoice; or request AP to obtain corrected invoice.
B2. Optional Task (SRM): Verify contract terms; request corrected invoice or PO correction from Supplier.
B3. Intermediate Event: Corrected invoice/confirmation received?
   - Yes -> 8 (AP re-match)
   - No after threshold time -> B4
B4. Task (AP Clerk): Escalate to AP Supervisor.
B5. Task (AP Supervisor): Coordinate resolution between Purchasing, Supplier, SRM; decide to continue or reject.
   - Resolved -> 8
   - Not resolved -> End Event: Invoice rejected.

C. Discrepancies during line-item match
C1. Task (AP Clerk -> Purchasing): Request clarification on quantities, price, delivery/freight.
C2. Exclusive Gateway: Resolved quickly?
   - Yes -> 8 (re-run match)
   - No -> C3
C3. Task (AP Clerk): Escalate to AP Supervisor.
C4. Task (AP Supervisor): Coordinate with Purchasing, SRM, and Supplier; obtain corrected invoice or PO update.
C5. Intermediate Event: Resolution outcome
   - Corrected invoice/PO received -> 8
   - Not resolvable -> End Event: Invoice rejected.

D. Manager rejects or puts on hold
D1. Task (AP Clerk): Investigate per manager feedback; hold invoice.
D2. Task (AP Supervisor/Purchasing/SRM as needed): Address budget concerns, unexpected items, or pricing anomalies; obtain approvals or corrected documents.
D3. Exclusive Gateway: Issue resolved?
   - Yes -> If financials changed, return to 8 (re-match); else -> 10 (re-request approval)
   - No -> End Event: Invoice rejected.

Message flows and handoffs
- Supplier -> AP Clerk: Invoice sent by email; revised invoice on request.
- AP Clerk -> Purchasing: Receipt confirmation request; discrepancy clarification.
- Purchasing -> AP Clerk: Receipt confirmation; hold instruction; discrepancy feedback.
- AP Clerk -> AP Supervisor: Escalation for unresolved/missing PO or matching issues.
- AP Supervisor <-> Supplier/SRM/Purchasing/Department Head: Coordination to resolve exceptions; create retrospective PO; decision to reject.
- System -> Department Manager: Automated approval request notification.
- Department Manager -> System/AP Clerk: Approve or reject/hold decision.

Business rules inferred
- No approval without a confirmed PO reference (Purchasing will not proceed without PO).
- Manager approval is triggered only after receipt is confirmed and invoice-PO match succeeds.
- Invoices with unresolved discrepancies are held; if not resolvable, they are rejected.
- Non-PO invoices are exceptional: require retrospective PO or rejection.

Data objects at key steps
- Step 4: Invoice Record created in Accounting System.
- Step 6: Receipt confirmation (email or system record).
- Step 8: Match result (pass/fail) stored in System.
- Step 10: Approval request package (invoice, PO, receipt) sent to Manager.
- Step 13: Payment schedule entry.

End states
- Invoice scheduled for payment (happy path).
- Invoice rejected (multiple exception paths).

Noted uncertainties/assumptions
- The exact mechanism for receipt confirmation (system goods receipt vs. email) is not specified; modeled as a Purchasing validation task.
- Timing/SLA for holds and escalations is not specified; modeled as escalations after a threshold.
- Payment execution occurs after scheduling but is outside the described scope.