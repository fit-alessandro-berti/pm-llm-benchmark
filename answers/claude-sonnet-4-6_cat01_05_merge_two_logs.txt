# Merged Event Log: Order Fulfillment Process

## Step 1: Event Matching Analysis

Before producing the final log, I'll systematically evaluate each potential pairing between Log A and Log B.

### Matching Candidates

| Log A Event | Log A Timestamp | Log B Event | Log B Timestamp |  Time | Confidence |
|---|---|---|---|---|---|
| Order Received | 10:00:00Z | OrderReceived | 09:59:58Z | 2s |  HIGH MATCH |
| Order Validated | 10:01:30Z | OrderValidation | 10:01:29Z | 1s |  HIGH MATCH |
| Payment Processed | 10:02:00Z | PaymentCheck | 10:02:05Z | 5s |  LIKELY MATCH* |
| *(no match)* | — | Quality Check | 10:03:00Z | — |  LOG B ONLY |
| Item Shipped | 10:05:00Z | Shipping | 10:05:02Z | 2s |  HIGH MATCH |
| Item Delivered | 10:20:00Z | *(no match)* | — | — |  LOG A ONLY |

> **\*Note on Payment Processed / PaymentCheck:** The 5-second difference exceeds the strict 2-second tolerance, but semantic alignment (same order, same process stage, adjacent in sequence, no competing candidates) makes a confident match reasonable. I'll include both timestamps and flag it.

---

## Step 2: Conflict & Ambiguity Resolution

### Timestamp Strategy
- **Primary timestamp**: Log A's timestamp is used as the primary sort key (per the requirement that Log A represents the primary timeline).
- **Secondary timestamp**: Log B's timestamp is preserved as an additional attribute (`timestamp_system_b`) for auditability.
- For the **Order Received** event, Log B's timestamp (09:59:58Z) is *earlier* — this is noted, as Log B may reflect when the event actually *occurred*, while Log A reflects when it was *received*.

### Naming Convention
- A unified `event_name` field is created using a readable, canonical label derived from Log A's naming.
- Original names from both systems are preserved in `event_name_system_a` and `event_name_system_b` for traceability.

### Missing Events
- **Quality Check** (Log B, 10:03:00Z): No counterpart in Log A. Included as a standalone record with `origin: System B only`. This event likely represents an internal warehouse step not tracked by System A.
- **Item Delivered** (Log A, 10:20:00Z): No counterpart in Log B. Included as a standalone record with `origin: System A only`. System B may not track delivery confirmation.

---

## Step 3: Final Merged Event Log

> Presented in chronological order by primary timestamp. Each record includes all available attributes.

---

### Event 1 — Order Received
```
timestamp_primary   : 2023-10-10T10:00:00Z         Log A (receive time)
timestamp_system_b  : 2023-10-10T09:59:58Z         Log B (may reflect actual occurrence)
event_name          : Order Received
event_name_system_a : Order Received
event_name_system_b : OrderReceived
order_id            : Order#1234
user_id             : u45
resource_id         : r10
notes               : "Event captured at warehouse system"
origin              : Merged (Log A + Log B)
match_confidence    : High (t = 2s, semantically identical)
```
**Reasoning:** The 2-second gap is within tolerance. Log B's timestamp being slightly earlier is consistent with the stated behavior — Log A records receipt time, Log B captures the event closer to its actual occurrence.

---

### Event 2 — Order Validated
```
timestamp_primary   : 2023-10-10T10:01:30Z
timestamp_system_b  : 2023-10-10T10:01:29Z
event_name          : Order Validated
event_name_system_a : Order Validated
event_name_system_b : OrderValidation
order_id            : Order#1234
user_id             : u12
resource_id         : r10
notes               : "Cross-check inventory"
origin              : Merged (Log A + Log B)
match_confidence    : High (t = 1s, semantically identical)
```
**Reasoning:** 1-second difference is well within tolerance. "OrderValidation" in Log B clearly corresponds to "Order Validated" in Log A.

---

### Event 3 — Payment Processed
```
timestamp_primary   : 2023-10-10T10:02:00Z
timestamp_system_b  : 2023-10-10T10:02:05Z
event_name          : Payment Processed
event_name_system_a : Payment Processed
event_name_system_b : PaymentCheck
order_id            : Order#1234
user_id             : u12
resource_id         : r99
notes               : "Payment gateway delay"
origin              : Merged (Log A + Log B) —  Timestamp delta slightly exceeds 2s threshold
match_confidence    : Medium-High (t = 5s; semantic & sequential alignment strong)
```
**Reasoning:** While 5 seconds exceeds the strict 2-second threshold, no other Log B event is a better candidate for this position in the sequence. The naming ("PaymentCheck"  "Payment Processed"), the same order_id, and the sequential position all support a match. The note "Payment gateway delay" in Log B may even *explain* why the timestamps differ — the payment gateway introduced a processing delay between when Log A registered the event and when Log B confirmed it. Merged with a confidence flag.

---

### Event 4 — Quality Check *(Log B only)*
```
timestamp_primary   : 2023-10-10T10:03:00Z
timestamp_system_b  : 2023-10-10T10:03:00Z
event_name          : Quality Check
event_name_system_a : (none)
event_name_system_b : Quality Check
order_id            : Order#1234
user_id             : u45
resource_id         : r11
notes               : "Random inspection"
origin              : System B only (no match in Log A)
match_confidence    : N/A — unmatched event
```
**Reasoning:** This event has no counterpart in Log A. It falls between Payment Processed and Item Shipped in the timeline, representing a warehouse-side inspection step. System A does not appear to track this internal step. It is included as-is to preserve the complete process picture.

---

### Event 5 — Item Shipped
```
timestamp_primary   : 2023-10-10T10:05:00Z
timestamp_system_b  : 2023-10-10T10:05:02Z
event_name          : Item Shipped
event_name_system_a : Item Shipped
event_name_system_b : Shipping
order_id            : Order#1234
user_id             : u45
resource_id         : r10
notes               : "Package handed to courier"
origin              : Merged (Log A + Log B)
match_confidence    : High (t = 2s, semantically identical)
```
**Reasoning:** 2-second gap is at the boundary of tolerance and acceptable. "Shipping" in Log B clearly maps to "Item Shipped" in Log A. The note confirms the physical handoff event. Same user (u45) and resource (r10) as the Order Received event, consistent with warehouse staff completing the fulfillment cycle.

---

### Event 6 — Item Delivered *(Log A only)*
```
timestamp_primary   : 2023-10-10T10:20:00Z
timestamp_system_b  : (none)
event_name          : Item Delivered
event_name_system_a : Item Delivered
event_name_system_b : (none)
order_id            : Order#1234
user_id             : (not available)
resource_id         : (not available)
notes               : (not available)
origin              : System A only (no match in Log B)
match_confidence    : N/A — unmatched event
```
**Reasoning:** No Log B event occurs near 10:20:00Z. Log B likely ends its tracking at shipment (courier handoff), and does not receive delivery confirmation signals. This is a meaningful event from System A's perspective (e.g., from a delivery confirmation system) and is retained as-is.

---

## Summary Table

| # | Primary Timestamp | Event Name | Order ID | User | Resource | Origin | Confidence |
|---|---|---|---|---|---|---|---|
| 1 | 2023-10-10T10:00:00Z | Order Received | Order#1234 | u45 | r10 | Merged | High |
| 2 | 2023-10-10T10:01:30Z | Order Validated | Order#1234 | u12 | r10 | Merged | High |
| 3 | 2023-10-10T10:02:00Z | Payment Processed | Order#1234 | u12 | r99 | Merged  | Medium-High |
| 4 | 2023-10-10T10:03:00Z | Quality Check | Order#1234 | u45 | r11 | System B only | N/A |
| 5 | 2023-10-10T10:05:00Z | Item Shipped | Order#1234 | u45 | r10 | Merged | High |
| 6 | 2023-10-10T10:20:00Z | Item Delivered | Order#1234 | — | — | System A only | N/A |

---

## Key Design Decisions Summary

| Decision | Rationale |
|---|---|
| Log A timestamps as primary | Per requirements; Log A is the "primary" timeline |
| Preserve both timestamps | Enables forensic audit and clock-skew analysis |
| Merge Payment event at t=5s | Strong semantic + sequential evidence outweighs strict time threshold; flagged for transparency |
| Keep Quality Check separate | No Log A counterpart; represents a system-specific internal step |
| Keep Item Delivered separate | Log B tracking ends at handoff; no candidate event to merge |
| Preserve original event names | Supports downstream compatibility with both source systems |