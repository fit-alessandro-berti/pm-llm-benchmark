BPMN-like textual process model: Invoice Approval and Payment

Participants (Pool: Company)
- Lane L1: Accounts Payable Clerk (APC) – Mary
- Lane L2: Purchasing Officer (PO) – Dan
- Lane L3: Department Manager (DM) – Carlos
- Lane L4: Accounts Payable Supervisor (APS) – Rita
- Lane L5: Supplier Relationship Manager (SRM) – Karen
- Lane L6: Supplier
- Lane L7: Accounting System (System)
- Lane L8: Department Head (DeptHead) – used only for retrospective PO cases

Key data/artifacts
- D1: Supplier Invoice (original)
- D2: Purchase Order (PO)
- D3: Receipt Confirmation / Goods Receipt (may be email confirmation or system record)
- D4: Corrected Invoice or Credit Note (from Supplier)
- D5: Approval Record (Manager decision)
- D6: Retrospective PO (if created)
- D7: Payment Schedule Entry (in system)
- D8: Exception/Investigation Log

Flow nodes (with IDs, type, lane, and brief description)
- SE1 Start Event (APC): Invoice received (typically via email). Data: D1.
- T1 Task (APC): Check invoice for valid PO reference. Inputs: D1.
- G1 Exclusive Gateway (APC): PO present and valid?
- T2 Task (APC): Request PO/more details from Supplier. Outputs: request email. Message to Supplier. Data: D1.
- IE1 Intermediate Catch Event (APC): Wait for Supplier response (PO info or revised invoice).
- G2 Exclusive Gateway (APC): Supplier provided valid PO?
- T3 Task (APC): Escalate missing PO to AP Supervisor. Attach D8.
- T4 Task (APS): Decide path for no-PO invoice (coordinate). Options: create retrospective PO or reject; may consult DeptHead and/or SRM.
- G3 Exclusive Gateway (APS): Retrospective PO feasible and approved?
- T5 Task (APS + DeptHead): Create/approve Retrospective PO. Output: D6.
- T6 Task (APS): Reject invoice and notify Supplier. Output: rejection notice; update D8.
- T7 Task (APC): Log invoice in Accounting System and link to PO. Inputs: D1, D2 or D6. Output: system record.
- T8 Task (APC): Forward invoice to Purchasing for receipt confirmation and PO alignment. Message to PO. Attach D1, D2.
- T9 Task (PO): Verify goods/services receipt and compare invoice vs PO (qty, price, delivery). Consult D2, D1; confirm D3.
- G4 Exclusive Gateway (PO): Receipt confirmed and invoice aligned with PO?
- T10 Task (PO): Handle discrepancy with Supplier; instruct AP to hold invoice until correction. May contact Supplier directly; may involve SRM. Output: hold request to APC; message to Supplier.
- IE2 Intermediate Catch Event (PO/APC): Receive corrected invoice/credit note or supplier response. Data: D4.
- T11 Task (PO): Send confirmation to AP that invoice/PO/receipt are OK. Message to APC. Data: D3.
- T12 Task (APC): Perform 3-way match in system (invoice vs PO vs receipt). Inputs: D1/D4, D2, D3.
- G5 Exclusive Gateway (APC): 3-way match successful?
- T13 Task (APC): Clarify discrepancy with Purchasing. Message to PO; update D8.
- T14 Task (APC): Escalate unresolved discrepancy to AP Supervisor. Attach D8.
- T15 Task (APS): Coordinate resolution (may involve SRM and Supplier; may adjust PO or request corrected invoice). Messages to SRM/Supplier/PO as needed. Data: D4 or updated D2.
- T16 Task (APC): Update invoice record with corrections (e.g., attach corrected invoice) and resume matching.
- T17 Task (System): Trigger Manager approval request (auto-email/notification). Attach D1/D4, D2, D3.
- T18 Task (DM): Review invoice package and decide (approve/reject/hold). Inputs: D1/D4, D2, D3.
- G6 Exclusive Gateway (DM): Manager decision?
- T19 Task (APC): Investigate per Manager’s hold/reject feedback; coordinate with PO/APS/SRM/Supplier. Update D8. Aim to resolve and resubmit.
- G7 Exclusive Gateway (APC/APS): Issue resolved and acceptable to proceed?
- T20 Task (APC): Schedule invoice for payment (create payment schedule entry). Output: D7.
- T21 Task (System): Include in next payment run and mark for execution.
- EE1 End Event (System): Payment scheduled/executed.
- EE2 End Event (APS): Invoice rejected (no-PO or unresolvable discrepancy).
- EE3 End Event (DM/APC): Invoice rejected after Manager decision/investigation.

Sequence flows (control flow)
- SE1 -> T1
- T1 -> G1
- G1 (Yes) -> T7
- G1 (No) -> T2
- T2 -> IE1
- IE1 -> G2
- G2 (Yes) -> T7
- G2 (No) -> T3
- T3 -> T4
- T4 -> G3
- G3 (Yes) -> T5
- T5 -> T7
- G3 (No) -> T6
- T6 -> EE2
- T7 -> T8
- T8 -> T9
- T9 -> G4
- G4 (Yes) -> T11
- T11 -> T12
- G4 (No) -> T10
- T10 -> IE2
- IE2 -> T9 (loop until aligned) or directly -> T11 when alignment achieved
- T12 -> G5
- G5 (Yes) -> T17
- T17 -> T18
- T18 -> G6
- G6 (Approve) -> T20
- T20 -> T21
- T21 -> EE1
- G6 (Reject/Hold) -> T19
- T19 -> G7
- G7 (Resolved) -> T18 (re-review by Manager)
- G7 (Not resolved) -> EE3
- G5 (No) -> T13
- T13 -> T14 (if PO cannot immediately resolve) or back to T12 (if resolved)
- T14 -> T15
- T15 -> T16
- T16 -> T12 (re-attempt match)

Message flows (between lanes)
- From APC T2 to Supplier: Request PO/missing info; from Supplier to APC IE1: Provide PO or response.
- From APC T8 to PO T9: Forward invoice for confirmation.
- From PO T10 to Supplier: Request correction/clarification; from Supplier to PO/APC IE2: Corrected invoice/credit note (D4).
- From PO T11 to APC: Confirmation that receipt and alignment are OK.
- From System T17 to DM T18: Approval request notification (auto).
- From DM (via System) after G6 Reject/Hold to APC T19: Feedback to investigate.
- From APC/APS/SRM to Supplier during T15/T19: Investigation/resolution requests; Supplier responds with corrections.
- From APS T6 to Supplier: Rejection notice.
- From APS/DeptHead T5 (internal coordination): No external message; internal approval to create D6.

Data associations (high level)
- T1 uses D1; outputs decision at G1.
- T7 creates/updates system record linking D1/D4 to D2 or D6.
- T9 uses D1/D4 and D2; confirms D3.
- T12 uses D1/D4, D2, D3; outputs match status at G5.
- T18 produces D5 (approval decision).
- T20 creates D7.
- T15/T19 update D8 and may produce D4 or updated D2.

Exceptions and variations
- Missing PO at intake:
  - Normal path: APC requests PO; if Supplier provides, continue.
  - If Supplier cannot provide, APC escalates to APS. APS may create a retrospective PO with DeptHead (D6) and proceed, or reject (EE2).
- Discrepancies identified by Purchasing:
  - PO contacts Supplier or instructs AP to hold. AP holds invoice until D4 arrives. Loop until PO confirms (T11).
- 3-way match failure after Purchasing confirmation:
  - APC clarifies with PO. If unresolved, escalate to APS who may involve SRM and Supplier for contract/price correction. Loop back to T12 when resolved.
- Manager review:
  - DM may approve, reject, or request hold/investigation. Hold/reject triggers investigation loop (T19 -> G7). If resolved, return to DM; if not, final rejection (EE3).
- Rare path noted by APS:
  - Invoices for informally contracted services without PO may require retrospective PO creation (T5) or outright rejection (T6).

Business rules and triggers
- Manager approval is triggered only after receipt is confirmed and invoice matches the PO (System T17 auto-notification).
- Purchasing will not confirm without a valid PO reference.
- AP does not schedule payment until Manager approval is recorded.

Ambiguities/assumptions noted
- Receipt confirmation may be an email from Purchasing or a system goods receipt; model treats it as D3 either way.
- Payment “executed” timing depends on the organization’s payment run; modeled as T21 leading to EE1.
- In discrepancy handling, either PO or AP may contact Supplier; interviews suggest both occur. The model centralizes Supplier contact primarily with Purchasing, with APS/SRM stepping in on escalations.