# Insurance Claim Management Process - Accepting Petri Net

I'll construct an accepting Petri net for the insurance claim management process with all the specified activities and loops for document re-submission and in-depth investigation.

```python
from pm4py.objects.petri_net.obj import PetriNet, Marking
from pm4py.objects.petri_net.utils import petri_utils

# Create the Petri Net
net = PetriNet(name="Insurance_Claim_Management_Process")

# ============================================
# Create Places (states between activities)
# ============================================

# Start place - new claim arrives
p_start = PetriNet.Place(name="p_start")

# Place after Claim Registration
p_after_cr = PetriNet.Place(name="p_after_cr")

# Place after Document Verification (before potential loop)
p_after_dv = PetriNet.Place(name="p_after_dv")

# Place for documents OK, ready for Fraud Check
p_docs_ok = PetriNet.Place(name="p_docs_ok")

# Place after Fraud Check (before potential loop)
p_after_fc = PetriNet.Place(name="p_after_fc")

# Place for fraud check passed, ready for Claim Assessment
p_fc_passed = PetriNet.Place(name="p_fc_passed")

# Place after Claim Assessment
p_after_ca = PetriNet.Place(name="p_after_ca")

# Place after Approval
p_after_ap = PetriNet.Place(name="p_after_ap")

# Place after Payment
p_after_p = PetriNet.Place(name="p_after_p")

# Place after Notification
p_after_n = PetriNet.Place(name="p_after_n")

# End place - claim closed
p_end = PetriNet.Place(name="p_end")

# Add all places to the net
net.places.add(p_start)
net.places.add(p_after_cr)
net.places.add(p_after_dv)
net.places.add(p_docs_ok)
net.places.add(p_after_fc)
net.places.add(p_fc_passed)
net.places.add(p_after_ca)
net.places.add(p_after_ap)
net.places.add(p_after_p)
net.places.add(p_after_n)
net.places.add(p_end)

# ============================================
# Create Transitions (activities)
# ============================================

# Main process activities
t_c = PetriNet.Transition(name="t_c", label="Insurance Claim (C)")
t_cr = PetriNet.Transition(name="t_cr", label="Claim Registration (CR)")
t_dv = PetriNet.Transition(name="t_dv", label="Document Verification (DV)")
t_fc = PetriNet.Transition(name="t_fc", label="Fraud Check (FC)")
t_ca = PetriNet.Transition(name="t_ca", label="Claim Assessment (CA)")
t_ap = PetriNet.Transition(name="t_ap", label="Approval (AP)")
t_p = PetriNet.Transition(name="t_p", label="Payment (P)")
t_n = PetriNet.Transition(name="t_n", label="Notification (N)")
t_cl = PetriNet.Transition(name="t_cl", label="Closure (CL)")

# Loop activities
t_rds = PetriNet.Transition(name="t_rds", label="Re-Document Submission (RDS)")
t_ii = PetriNet.Transition(name="t_ii", label="In-depth Investigation (II)")

# Silent transitions for XOR splits (documents ok / need resubmission, fraud check passed / need investigation)
t_docs_complete = PetriNet.Transition(name="t_docs_complete", label=None)  # Silent transition
t_docs_incomplete = PetriNet.Transition(name="t_docs_incomplete", label=None)  # Silent transition
t_fc_clear = PetriNet.Transition(name="t_fc_clear", label=None)  # Silent transition
t_fc_suspicious = PetriNet.Transition(name="t_fc_suspicious", label=None)  # Silent transition

# Add all transitions to the net
net.transitions.add(t_c)
net.transitions.add(t_cr)
net.transitions.add(t_dv)
net.transitions.add(t_fc)
net.transitions.add(t_ca)
net.transitions.add(t_ap)
net.transitions.add(t_p)
net.transitions.add(t_n)
net.transitions.add(t_cl)
net.transitions.add(t_rds)
net.transitions.add(t_ii)
net.transitions.add(t_docs_complete)
net.transitions.add(t_docs_incomplete)
net.transitions.add(t_fc_clear)
net.transitions.add(t_fc_suspicious)

# ============================================
# Create Arcs (flow connections)
# ============================================

# Main sequential flow
# Start -> Insurance Claim (C)
petri_utils.add_arc_from_to(p_start, t_c, net)
petri_utils.add_arc_from_to(t_c, p_after_cr, net)

# Claim Registration (CR)
petri_utils.add_arc_from_to(p_after_cr, t_cr, net)
petri_utils.add_arc_from_to(t_cr, p_after_dv, net)

# Document Verification (DV) - with loop possibility
petri_utils.add_arc_from_to(p_after_dv, t_dv, net)
petri_utils.add_arc_from_to(t_dv, p_docs_ok, net)

# XOR split after DV: documents complete OR documents incomplete
# Path 1: Documents are complete - proceed to Fraud Check
petri_utils.add_arc_from_to(p_docs_ok, t_docs_complete, net)
petri_utils.add_arc_from_to(t_docs_complete, p_after_fc, net)

# Path 2: Documents incomplete - Re-Document Submission loop
petri_utils.add_arc_from_to(p_docs_ok, t_docs_incomplete, net)
petri_utils.add_arc_from_to(t_docs_incomplete, p_after_dv, net)  # Loop back before DV
# Note: RDS happens as part of going back
petri_utils.add_arc_from_to(p_docs_ok, t_rds, net)
petri_utils.add_arc_from_to(t_rds, p_after_dv, net)  # After RDS, go back to DV

# Fraud Check (FC) - with loop possibility
petri_utils.add_arc_from_to(p_after_fc, t_fc, net)
petri_utils.add_arc_from_to(t_fc, p_fc_passed, net)

# XOR split after FC: fraud check clear OR suspicious (need investigation)
# Path 1: Fraud check is clear - proceed to Claim Assessment
petri_utils.add_arc_from_to(p_fc_passed, t_fc_clear, net)
petri_utils.add_arc_from_to(t_fc_clear, p_after_ca, net)

# Path 2: Suspicious - In-depth Investigation loop (can happen multiple times)
petri_utils.add_arc_from_to(p_fc_passed, t_ii, net)
petri_utils.add_arc_from_to(t_ii, p_after_fc, net)  # After II, go back to FC

# Claim Assessment (CA)
petri_utils.add_arc_from_to(p_after_ca, t_ca, net)
petri_utils.add_arc_from_to(t_ca, p_after_ap, net)

# Approval (AP)
petri_utils.add_arc_from_to(p_after_ap, t_ap, net)
petri_utils.add_arc_from_to(t_ap, p_after_p, net)

# Payment (P)
petri_utils.add_arc_from_to(p_after_p, t_p, net)
petri_utils.add_arc_from_to(t_p, p_after_n, net)

# Notification (N)
petri_utils.add_arc_from_to(p_after_n, t_n, net)
petri_utils.add_arc_from_to(t_n, p_end, net)

# Closure (CL)
petri_utils.add_arc_from_to(p_end, t_cl, net)

# Create a final closed place
p_closed = PetriNet.Place(name="p_closed")
net.places.add(p_closed)
petri_utils.add_arc_from_to(t_cl, p_closed, net)

# ============================================
# Define Initial and Final Markings
# ============================================

# Initial marking: one token in the start place (new claim arrives)
im = Marking()
im[p_start] = 1

# Final marking: one token in the closed place (claim is closed and archived)
fm = Marking()
fm[p_closed] = 1

# ============================================
# Print summary of the Petri Net
# ============================================

print("=" * 60)
print("INSURANCE CLAIM MANAGEMENT PROCESS - PETRI NET")
print("=" * 60)

print(f"\nPetri Net Name: {net.name}")
print(f"\nNumber of Places: {len(net.places)}")
print(f"Number of Transitions: {len(net.transitions)}")
print(f"Number of Arcs: {len(net.arcs)}")

print("\n--- Places ---")
for place in net.places:
    print(f"  - {place.name}")

print("\n--- Transitions ---")
for transition in net.transitions:
    label = transition.label if transition.label else "(silent)"
    print(f"  - {transition.name}: {label}")

print("\n--- Arcs ---")
for arc in net.arcs:
    print(f"  - {arc.source.name} -> {arc.target.name}")

print("\n--- Initial Marking ---")
for place, tokens in im.items():
    print(f"  - {place.name}: {tokens} token(s)")

print("\n--- Final Marking ---")
for place, tokens in fm.items():
    print(f"  - {place.name}: {tokens} token(s)")

print("\n" + "=" * 60)
print("Process Flow Description:")
print("=" * 60)
print("""
1. Start: New claim arrives (token in p_start)
2. Insurance Claim (C) -> Claim Registration (CR)
3. Document Verification (DV) 
   - If documents incomplete: Re-Document Submission (RDS) -> back to DV
   - If documents complete: proceed to Fraud Check
4. Fraud Check (FC)
   - If suspicious: In-depth Investigation (II) -> back to FC (can repeat)
   - If clear: proceed to Claim Assessment
5. Claim Assessment (CA) -> Approval (AP) -> Payment (P)
6. Notification (N) -> Closure (CL)
7. End: Claim closed (token in p_closed)
""")
```

## Explanation of the Petri Net Structure:

### Places (States):
- **p_start**: Initial state - a new claim arrives
- **p_after_cr**: After claim registration
- **p_after_dv**: Before document verification
- **p_docs_ok**: After document verification (decision point)
- **p_after_fc**: Before fraud check
- **p_fc_passed**: After fraud check (decision point)
- **p_after_ca**: After claim assessment
- **p_after_ap**: After approval
- **p_after_p**: After payment
- **p_after_n**: After notification
- **p_closed**: Final state - claim is closed

### Transitions (Activities):
- Main flow: C  CR  DV  FC  CA  AP  P  N  CL
- **Loop 1**: RDS (Re-Document Submission) loops back to before DV
- **Loop 2**: II (In-depth Investigation) loops back to before FC

### Key Features:
1. **Document Re-submission Loop**: After DV, if documents are incomplete, RDS is executed and the process returns to DV
2. **Investigation Loop**: After FC, if fraud is suspected, II can be executed multiple times before proceeding to CA
3. **Silent transitions** handle the XOR splits for choosing between the normal path and loop paths