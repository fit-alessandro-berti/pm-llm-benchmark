```sql
WITH k AS (
  SELECT 5::INTEGER AS k
),
variants_per_case AS (
  SELECT 
    case_id, 
    STRING_AGG(activity, '|' ORDER BY timestamp) AS variant
  FROM event_log
  GROUP BY case_id
),
variant_stats AS (
  SELECT 
    variant, 
    COUNT(*) AS freq,
    ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC, variant) AS rn
  FROM variants_per_case
  GROUP BY variant
),
top_k_variants AS (
  SELECT variant 
  FROM variant_stats 
  CROSS JOIN k
  WHERE rn <= k.k
),
top_cases AS (
  SELECT vpc.case_id
  FROM variants_per_case vpc
  INNER JOIN top_k_variants t ON vpc.variant = t.variant
)
SELECT e.*
FROM event_log e
INNER JOIN top_cases tc ON e.case_id = tc.case_id
ORDER BY e.case_id, e.timestamp;
```