```mermaid
flowchart TD
    subgraph lanes ["BPMN Lanes (Swimlanes)"]
        AP[Accounts Payable Clerk <br/> (Mary)]
        PUR[Purchasing Officer <br/> (Dan)]
        SUP[AP Supervisor <br/> (Rita)]
        SRM[Supplier Relationship Manager <br/> (Karen)]
        MGR[Department Manager <br/> (Carlos)]
        SUPPLIER[Supplier <br/> (External)]
    end

    %% Start Event
    START([Start Event: <br/> Invoice Received <br/> (by email to AP)])

    %% Data Objects
    INVOICE((Invoice))
    PO((Purchase Order))
    CONFIRM_PURCH((Receipt Confirmation <br/> from Purchasing))
    MATCH((Invoice-PO Match))
    APPROVAL((Manager Approval))

    %% Main Flow
    START --> CHECK_PO{AP: <br/> Check for valid PO?}
    CHECK_PO -->|No PO| SEND_BACK[AP: <br/> Send back to Supplier <br/> for details/revised invoice]
    SEND_BACK --> INVOICE
    SEND_BACK -.->|May loop back if corrected| CHECK_PO
    CHECK_PO -->|Yes PO| LOG[AP: <br/> Log Invoice into <br/> Accounting System]
    LOG --> SEND_PURCH[AP: <br/> Forward to Purchasing <br/> for receipt & match confirmation]
    SEND_PURCH --> INVOICE
    SEND_PURCH --> PO

    %% Purchasing Confirmation (includes match check)
    SEND_PURCH --> CHECK_MATCH{PUR: <br/> Invoice matches PO? <br/> (quantities, prices, receipt)}
    CHECK_MATCH -->|No Match/Discrepancy| RESOLVE_PURCH[PUR: <br/> Contact Supplier or <br/> Hold & notify AP <br/> (may involve SRM)]
    RESOLVE_PURCH --> SUPPLIER_CONTACT[SRM/PUR: <br/> Contact Supplier for <br/> correction/clarification <br/> (pricing, PO ref, etc.)]
    SUPPLIER_CONTACT --> SUPPLIER
    SUPPLIER -->|Revised Invoice/Details| INVOICE
    RESOLVE_PURCH -.->|Unresolved| ESCALATE[AP/PUR: <br/> Escalate to AP Supervisor]
    ESCALATE --> HANDLE_EX[SUP: <br/> Resolve exception <br/> (e.g., retrospective PO, <br/> reject, or coordinate)]
    HANDLE_EX -->|Rejected| REJECT([End Event: <br/> Invoice Rejected])
    HANDLE_EX -->|Resolved| CHECK_MATCH
    CHECK_MATCH -->|Yes Match| CONFIRM[ PUR: <br/> Send Confirmation Email <br/> to AP ]
    CONFIRM --> CONFIRM_PURCH

    %% AP Matching (post-confirmation)
    CONFIRM --> DO_MATCH{AP: <br/> Match Invoice to PO <br/> (post-receipt confirmation)?}
    DO_MATCH -->|Discrepancy <br/> (unresolved)| ESCALATE
    DO_MATCH -->|Matches| SEND_MGR[AP: <br/> Send to Manager <br/> (system auto-email trigger)]

    %% Manager Approval
    SEND_MGR --> MATCH
    SEND_MGR --> APPROVAL
    SEND_MGR --> REVIEW{ MGR: <br/> Review & Approve? <br/> (quantities, pricing, budget)}
    REVIEW -->|Approve| SCHEDULE[AP: <br/> Schedule for Payment Run <br/> (next cycle)]
    REVIEW -->|Reject/Investigate| HOLD_INV[ MGR/AP: <br/> Reject or Hold for <br/> further investigation <br/> (notify AP/Purchasing)]
    HOLD_INV -->|Investigation| RESOLVE_PURCH
    HOLD_INV -.->|Rare (~1/2 months)| REJECT
    SCHEDULE --> PAY_END([End Event: <br/> Payment Scheduled])

    %% Annotations/Notes
    classDef task fill:#e1f5fe
    classDef gateway fill:#fff3e0
    classDef data fill:#f3e5f5
    classDef end fill:#ffebee

    class CHECK_PO,CHECK_MATCH,DO_MATCH,REVIEW gateway
    class INVOICE,PO,CONFIRM_PURCH,MATCH,APPROVAL data
    class LOG,SEND_PURCH,SEND_BACK,CONFIRM,SEND_MGR,SCHEDULE task
    class RESOLVE_PURCH,HANDLE_EX,SUPPLIER_CONTACT task
    class START,PAY_END,REJECT end
```

### BPMN Model Summary
**Process Name:** Invoice Approval Process  
**Pools/Lanes:** 
- Accounts Payable Clerk (primary handler)
- Purchasing Officer
- AP Supervisor (exception handling)
- Supplier Relationship Manager (ad-hoc support)
- Department Manager
- Supplier (external collaborator)

**Key Artifacts/Data Objects:**
- **Input:** Invoice (email), Purchase Order (PO)
- **Intermediate:** Receipt Confirmation, Invoice-PO Match
- **Output:** Manager Approval, Scheduled Payment

**Main Sequence (Happy Path):**
1. Receive & log invoice (AP)  Check/log PO.
2. Forward to Purchasing  Confirm receipt & match to PO.
3. AP performs final match  Forward to Manager (auto-triggered).
4. Manager approves  Schedule payment (AP).

**Gateways/Decision Points:**
- **XOR: Valid PO?**  No  Send back to supplier (potential loop).
- **XOR: Matches PO/Receipt?** (Purchasing/AP)  No  Resolve (discrepancy handling).
- **XOR: Exceptions Resolved?**  Escalation to Supervisor (retrospective PO or reject).
- **XOR: Manager Approve?**  No  Reject/hold/investigate (rare, loops to resolution).

**Exceptions/Variations/Loops:**
- **No/Missing PO:** Send back or escalate (Rita creates retrospective PO).
- **Discrepancies:** Purchasing/AP contacts supplier (often via SRM Karen); hold/revise invoice  loop back.
- **Escalations:** To Rita for stuck issues; back to main flow post-resolution.
- **Manager Rejects:** Rare; triggers investigation/rework.
- **Uncertainties:** Interviews overlap on "match" (AP vs. Purchasing); consolidated as sequential (Purchasing first for receipt/PO, AP final match). No explicit 3-way match (GRN) mentioned, but implied.

**Notes on Consolidation:**
- Conflicting details (e.g., who does primary matching) resolved by sequencing: Purchasing confirms first, AP matches post-confirmation.
- All paths converge or end clearly; no parallel flows noted.
- This Mermaid diagram is directly renderable (e.g., in Mermaid Live) for visualization; convertible to BPMN XML/tools like Camunda Modeler with minimal edits.