# Merged Event Log for Order #1234

## Matching Analysis

Before presenting the merged log, here is my event-by-event reasoning:

| # | Log A Event | Log B Event |  Time | Decision | Rationale |
|---|------------|------------|--------|----------|-----------|
| 1 | `Order Received` @ 10:00:00Z | `OrderReceived` @ 09:59:58Z | 2s | **Merge** | Names are semantically identical. 2s offset consistent with Log A recording *receipt* time while Log B captures the originating timestamp at the warehouse. |
| 2 | `Order Validated` @ 10:01:30Z | `OrderValidation` @ 10:01:29Z | 1s | **Merge** | Names clearly correspond (validated  validation). 1s well within tolerance. |
| 3 | `Payment Processed` @ 10:02:00Z | `PaymentCheck` @ 10:02:05Z | 5s | **Merge ** | Exceeds the 2s tolerance, but these are the *only* payment-related events in either log for this order, making a false match extremely unlikely. Log B's own note ("Payment gateway delay") explains the offset—System B likely logged completion *after* the gateway responded. Strong semantic match overrides the timestamp heuristic. |
| 4 | — | `Quality Check` @ 10:03:00Z | n/a | **Log B only** | No candidate in Log A. This is an internal warehouse step not tracked by System A. |
| 5 | `Item Shipped` @ 10:05:00Z | `Shipping` @ 10:05:02Z | 2s | **Merge** | Names clearly correspond. 2s offset within tolerance. |
| 6 | `Item Delivered` @ 10:20:00Z | — | n/a | **Log A only** | Delivery confirmation likely comes from the courier/customer-facing system (A); the warehouse system (B) has no visibility past hand-off. |

---

## Final Merged Event Log

Events are ordered chronologically by **primary timestamp** (the earlier of the two when merged).

```

  #     primary_timestamp         secondary_timestamp      event_name        order_id  user_id  resource_id  notes                             source  

  1   2023-10-10T09:59:58Z      2023-10-10T10:00:00Z      Order Received     Order#1234 u45     r10          Event captured at warehouse        A + B   
      (Log B)                   (Log A)                                                                      system                                    

  2   2023-10-10T10:01:29Z      2023-10-10T10:01:30Z      Order Validated    Order#1234 u12     r10          Cross-check inventory             A + B   
      (Log B)                   (Log A)                                                                                                                

  3   2023-10-10T10:02:00Z      2023-10-10T10:02:05Z      Payment Processed  Order#1234 u12     r99          Payment gateway delay             A + B   
      (Log A)                   (Log B)                                                                      (5s offset attributed to                  
                                                                                                              gateway response lag)                     

  4   2023-10-10T10:03:00Z      —                         Quality Check      Order#1234 u45     r11          Random inspection                 B only  
      (Log B)                                                                                                                                          

  5   2023-10-10T10:05:00Z      2023-10-10T10:05:02Z      Item Shipped       Order#1234 u45     r10          Package handed to courier         A + B   
      (Log A)                   (Log B)                                                                                                                

  6   2023-10-10T10:20:00Z      —                         Item Delivered     Order#1234 —       —            —                                 A only  
      (Log A)                                                                                                                                          

```

---

## Detailed Reasoning & Conflict-Resolution Policies

### 1. Timestamp Selection
| Pattern observed | Policy applied |
|---|---|
| For events #1 and #2, Log B's timestamp is *earlier* (by 1–2 s). | Log B likely records the moment the action occurs; Log A records when the message is received.  **Earlier (Log B) timestamp chosen as primary.** |
| For event #3, Log A's timestamp is *earlier* (by 5 s). | Log A logged the payment request; Log B logged after the gateway responded.  **Log A timestamp chosen as primary** because it is closer to the true initiation. |
| For event #5, Log A is again earlier by 2 s. | Same receive-delay pattern.  **Log A chosen as primary.** |

Both timestamps are retained so that downstream analysis can choose whichever suits its needs.

### 2. Event Name Normalization
Log A's names are already human-readable and consistent, so they were adopted as the **canonical event names**. The mapping used:

| Log A name | Log B name | Unified name |
|---|---|---|
| Order Received | OrderReceived | **Order Received** |
| Order Validated | OrderValidation | **Order Validated** |
| Payment Processed | PaymentCheck | **Payment Processed** |
| Item Shipped | Shipping | **Item Shipped** |
| *(not present)* | Quality Check | **Quality Check** (kept as-is) |
| Item Delivered | *(not present)* | **Item Delivered** (kept as-is) |

### 3. Attribute Enrichment
- **user_id** and **resource_id** come exclusively from Log B; they are `null`/absent for Log A-only events (event #6).
- **notes** come from Log B; they are `null`/absent for Log A-only events.
- The **source** column explicitly records provenance: `A + B` (merged), `A only`, or `B only`.

### 4. Non-Overlapping Events
- **Quality Check (event #4)**: Present only in Log B, with no temporal or semantic neighbor in Log A. Retained as a standalone event, enriching the process with an inspection step that System A does not track.
- **Item Delivered (event #6)**: Present only in Log A, 15 minutes after the last Log B event. The warehouse system (B) naturally loses visibility once the package leaves the facility, so its absence in Log B is expected. Retained as a standalone event.

### 5. Edge-Case: Payment Event (5-second gap)
This was the only merge that exceeded the stated 2-second heuristic. Three converging signals justified the merge despite the gap:
1. **Semantic uniqueness** – only one payment event exists in each log.
2. **Contextual metadata** – Log B's note explicitly mentions a "Payment gateway delay."
3. **Process logic** – a second, distinct payment event within 5 seconds for the same order is implausible in a standard fulfillment workflow.

Had there been a competing candidate event nearby, this merge would have been left separate pending further investigation.