## BPMN-like Textual Process Model — “Invoice Approval & Payment Scheduling (PO-based)”

### Participants / Pools & Lanes
**Pool: Supplier**
- Supplier (external)

**Pool: Company**
- **Accounts Payable (AP) Clerk** (Mary)
- **Purchasing Department / Purchasing Officer** (Dan)
- **Department Manager** (Carlos)
- **AP Supervisor** (Rita)
- **Supplier Relationship Manager (SRM)** (Karen)
- **Accounting System / ERP** (system-generated notifications, invoice/PO records)

---

### Key Data Objects / Artifacts
- **Invoice** (email/PDF)
- **Purchase Order (PO)** (PO number + PO document in ERP)
- **Goods/Services Receipt Confirmation** (confirmation email or receipt record)
- **Contract / Agreed Terms** (used by SRM to validate pricing/terms)
- **Corrected / Revised Invoice** (from supplier)
- **Retrospective PO** (created for informal/late-PO situations)
- **Manager Approval Record** (approve/reject action in system)
- **Payment Schedule / Payment Run Entry**

---

## Main Process Flow (Sequence)

### 0) Start Event
**[Start Event] Invoice Received**
- Trigger: Invoice arrives (usually **by email**) to **AP Clerk (Mary)**.

---

### 1) AP Intake & PO Presence Check (AP Clerk)
**Task A1 — Receive invoice and check for PO number**
- Mary checks whether the invoice references a **valid PO number**.

**Gateway G1 — “PO number present and valid?”**
- **Yes ** proceed to logging and verification.
- **No ** request missing information (exception/loop).

---

### 2) Missing PO Handling (Exception Loop)
**Task A2 — Request PO/details from Supplier**
- Mary sends invoice back / emails supplier requesting PO number or more details.

**(Optional/Conditional) Task K1 — SRM contacts supplier to obtain PO / revised invoice**
- Karen may be looped in if AP/Purchasing indicates terms/PO info missing or disputed.

**[Intermediate Event] Supplier provides PO number / revised invoice**
- Output: **Corrected invoice** or **invoice with PO reference**.

**Sequence Flow:** Return to **Task A1** (re-check PO)  **Gateway G1**.

> **Escalation variant:** If invoices lack PO due to “informal services,” see Section 5 (Supervisor exception path).

---

### 3) Log Invoice & Request Purchasing Confirmation (AP Clerk  Purchasing)
**Task A3 — Log invoice in ERP/accounting system**
- Input: Invoice with PO reference.
- Output: Invoice record created in system.

**Task A4 — Forward invoice to Purchasing for receipt/PO verification**
- Mary forwards invoice (and PO reference) to **Dan/Purchasing** to confirm goods/services receipt and alignment with PO.

---

### 4) Purchasing Verification (Purchasing)
**Task P1 — Verify invoice vs PO and receipt**
- Dan checks **quantities, prices, delivery charges** against PO and what was received.

**Gateway G2 — “PO reference usable and invoice aligns with PO/receipt?”**
- **Path G2a (Missing PO info detected by Purchasing):**
  - **Task P2 — Notify AP: cannot proceed without confirmed PO**
  - Output: message to Mary to obtain PO
  - **Flow:** back to **Task A2** (request PO/details) / then re-enter at **Task A4/P1** once updated

- **Path G2b (Discrepancy found):**
  - **Task P3 — Resolve discrepancy**
    - Purchasing either:
      - contacts **Supplier directly**, and/or
      - asks **AP to hold invoice** until corrected invoice arrives
    - **(Optional) Task K1 — SRM validates contract terms / contacts supplier** (when mismatch vs agreed terms)
  - **[Intermediate Event] Corrected invoice / clarification received**
  - **Flow:** repeat **Task P1** (re-verify)

- **Path G2c (All OK):**
  - **Task P4 — Send confirmation to AP**
    - Confirmation typically via email (or recorded confirmation accessible to AP).

---

### 5) AP Matching & Exception Escalation (AP Clerk + Supervisor)
**Task A5 — Match invoice line items against PO in ERP (3-way style)**
- Inputs: Invoice record, PO, Purchasing confirmation / receipt confirmation.
- Mary performs matching in the system.

**Gateway G3 — “Invoice matches PO/receipt and issues resolved?”**
- **Yes ** proceed to manager approval request.
- **No ** discrepancy handling.

**Task A6 — Clarify discrepancy with Purchasing**
- Mary emails Purchasing for clarification when mismatch exists.

**Gateway G4 — “Discrepancy resolvable via clarification/correction?”**
- **Yes (resolved) ** return to **Task A5** (re-match)
- **No / stuck / special cases  Escalate**
  - **Task R1 — Escalate exception to AP Supervisor (Rita)**
  - **Task R2 — Supervisor coordinates resolution**
    - May contact supplier, coordinate between AP/Purchasing, and/or involve department heads.
    - **Special exception:** invoice does not match any PO (e.g., informal service purchase)
      - **Task R3 — Create retrospective PO OR decide rejection**
        - Collaborate with department heads to create **retrospective PO**, *or*
        - decide invoice should be **rejected**.
      - **Gateway G5 — “Retrospective PO created and acceptable?”**
        - **Yes ** return to **Task P1 / A5** (re-verify/re-match with new PO)
        - **No ** **End Event (Rejected)**

---

### 6) Manager Approval (System + Department Manager)
**Task S1 (System) — Send manager approval request**
- Triggered only after:
  - Purchasing confirmation received, and
  - AP matching successful
- System sends **automatic email/notification** to manager.

**Task M1 — Manager reviews invoice/PO/confirmation in system**
- Carlos reviews quantities, pricing, notes; may also sense-check against budget/expectations.

**Gateway G6 — “Manager approves?”**
- **Approve:**
  - **Task M2 — Approve in system**
  - Flow to AP for payment scheduling
- **Reject / Hold for investigation:**
  - **Task M3 — Reject or request hold/investigation**
  - Output: rejection/hold message to AP
  - **Flow:** back to **Task A6 / R1** (investigate discrepancy and rework until resubmission)

---

### 7) Payment Scheduling (AP Clerk)
**Task A7 — Schedule invoice for payment run**
- Input: Approved invoice.
- Output: **Payment run entry / scheduled payment**.

**[End Event] Invoice Scheduled for Payment**
- Note: Actual payment execution is implied but not described in detail in interviews (process ends at scheduling).

---

## Message Flows (Cross-lane interactions)
- AP  Supplier: request PO / revised invoice (A2)
- Purchasing  Supplier: discrepancy resolution (P3) *(sometimes Purchasing contacts supplier directly)*
- AP/Purchasing  SRM: request supplier/contract support (K1) *(indirect involvement)*
- Purchasing  AP: confirmation that invoice aligns with PO/receipt (P4)
- System  Manager: approval request notification (S1)
- Manager  AP: approve/reject outcome (M2/M3)

---

## Noted Variations / Ambiguities (from interviews)
1. **Who contacts the supplier during discrepancies varies:** Purchasing may contact supplier directly (Dan), AP may do so, and/or SRM (Karen) is looped in for key suppliers/contract-term disputes.
2. **Receipt confirmation ownership:** Mary describes Purchasing confirming goods/services receipt; Dan describes verifying against PO and ordered/received details. Exact system-of-record for “receipt” (ERP receipt vs email confirmation) is not fully specified.
3. **Rework loop after manager rejection:** Carlos may reject/hold; the loop returns to AP investigation and may re-trigger Purchasing/SRM involvement before resubmitting for approval.

This textual model can be directly translated into a BPMN diagram with one external pool (Supplier) and one internal pool (Company) containing lanes for AP Clerk, Purchasing, Supervisor, SRM, Manager, and the ERP/system.