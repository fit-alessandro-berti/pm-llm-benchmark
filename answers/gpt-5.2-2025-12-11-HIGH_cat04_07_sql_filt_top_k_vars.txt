```sql
-- Replace $K with the number of top variants you want (e.g., 5)
WITH case_sequences AS (
    -- 1) ordered activity sequence per case
    SELECT
        case_id,
        string_agg(activity, ' -> ' ORDER BY timestamp, activity) AS variant
    FROM event_log
    GROUP BY case_id
),
variant_counts AS (
    -- 2) group cases by variant + 3) count cases per variant
    SELECT
        variant,
        COUNT(*) AS case_count
    FROM case_sequences
    GROUP BY variant
),
top_k_variants AS (
    -- 3) top K variants by frequency
    SELECT variant
    FROM variant_counts
    ORDER BY case_count DESC, variant
    LIMIT $K
),
cases_in_top_k AS (
    -- cases whose variant is in the top K
    SELECT cs.case_id
    FROM case_sequences cs
    JOIN top_k_variants tk USING (variant)
)
-- 4) return only events belonging to those cases
SELECT e.*
FROM event_log e
JOIN cases_in_top_k c USING (case_id)
ORDER BY e.case_id, e.timestamp, e.activity;
```