Here are two equivalent DuckDB SQL approaches.

Option 1: Use a window function (concise)

SELECT *
FROM (
  SELECT e.*,
         COUNT(*) OVER (PARTITION BY case_id) AS case_size
  FROM event_log e
) AS t
WHERE case_size <= 6
ORDER BY case_id, timestamp;

Option 2: Pre-aggregate then join (clear separation)

WITH case_counts AS (
  SELECT case_id
  FROM event_log
  GROUP BY case_id
  HAVING COUNT(*) <= 6
)
SELECT e.*
FROM event_log e
JOIN case_counts c ON e.case_id = c.case_id
ORDER BY e.case_id, e.timestamp;