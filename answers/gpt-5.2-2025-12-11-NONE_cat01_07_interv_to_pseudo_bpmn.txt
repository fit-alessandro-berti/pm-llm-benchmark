## BPMN-like Textual Process Model — Invoice Approval (PO-based)

### Participants / Lanes
- **Supplier**
- **Accounts Payable Clerk (AP Clerk, “Mary”)**
- **Purchasing Officer / Purchasing Dept. (“Dan”)**
- **Department Manager (“Carlos”)**
- **AP Supervisor (“Rita”)**
- **Supplier Relationship Manager (“Karen”)**
- **Accounting System (AP/ERP system)**

### Key Artifacts / Data Objects
- **Invoice** (email/attachment; later a system record)
- **Purchase Order (PO)**
- **Goods/Service Receipt Confirmation** (email/confirmation from Purchasing)
- **Correction / Revised Invoice** (from Supplier)
- **Contract / Agreed Terms** (used by Karen when pricing disputed)
- **Retrospective PO** (created for informal/exceptional purchases)
- **Manager Approval / Rejection** (system decision)
- **Scheduled Payment Run entry** (payment scheduling output)

---

## Main Process (Happy Path)

**Start Event:** *Invoice received* (typically via email)

1. **AP Clerk — Receive invoice (email)**
2. **AP Clerk — Check invoice for valid PO number**
3. **XOR Gateway: “PO number present and valid?”**
   - **Yes ** continue
   - **No ** go to *Missing PO exception path* (below)

4. **AP Clerk — Log invoice into accounting system**  
   - *Output:* Invoice record in system

5. **AP Clerk — Forward invoice to Purchasing for receipt/order verification**
6. **Purchasing — Verify against PO (quantities, prices, delivery charges; and confirm goods/services received)**
7. **XOR Gateway: “Purchasing confirms invoice/receipt ok?”**
   - **Yes ** Purchasing sends confirmation to AP (email/confirmation)  continue
   - **No ** go to *Discrepancy exception path* (below)

8. **AP Clerk — Match invoice line items to PO in system**
9. **XOR Gateway: “AP match successful?”**
   - **Yes ** continue
   - **No ** go to *Discrepancy/Unresolved match exception path* (below)

10. **Accounting System — Send automatic approval request to Department Manager**
    - *Trigger:* after receipt confirmed + invoice matched to PO (per AP clerk)

11. **Department Manager — Review invoice/PO/confirmation in system**
12. **XOR Gateway: “Manager decision”**
    - **Approve ** continue
    - **Reject or Hold/Investigate ** go to *Manager rejection/hold path* (below)

13. **AP Clerk — Schedule invoice for payment run**
    - *Output:* Payment scheduled

**End Event:** *Invoice scheduled for payment*

---

## Exception / Variation Paths

### A) Missing PO number (at Step 3 = “No”)
A1. **AP Clerk — Return/request info from supplier (ask for PO / more details)**  
- *Possible support:* **Karen** may contact supplier to obtain PO or revised invoice.

A2. **Supplier — Provide PO number or send revised invoice**
A3. **Loop back** to **AP Clerk — Check invoice for valid PO number** (Step 2)

**Variation noted by Purchasing:** If invoice sent to Purchasing without PO, Purchasing will instruct AP to obtain PO before they proceed (“We never approve anything without a confirmed PO reference.”).

---

### B) Discrepancy found by Purchasing (at Step 7 = “No”)
B1. **Purchasing — Identify discrepancy (e.g., extra units billed, pricing off, delivery charges)**
B2. **XOR Gateway: “How is discrepancy handled?”**
- **Contact supplier directly (Purchasing) ** request correction / clarification  
- **Ask AP to hold invoice until corrected invoice arrives ** AP holds in system/state

B3. **Optional involvement (when terms/pricing disputed):**
- **Karen — Check contract/agreed terms; advise AP/Purchasing of correct pricing; contact supplier**

B4. **Supplier — Send corrected/revised invoice or clarification**
B5. **Loop back** to **Purchasing — Verify against PO** (Step 6)  
(then proceed once confirmed)

---

### C) AP cannot match invoice to PO / discrepancy not easily resolved (after Step 8/9 = “No”)
C1. **AP Clerk — Email Purchasing to clarify discrepancy**
C2. **XOR Gateway: “Resolved by AP/Purchasing quickly?”**
- **Yes ** update/obtain correction  **Loop back** to **AP Clerk — Match invoice line items to PO** (Step 8)
- **No ** **AP Clerk — Escalate to AP Supervisor (Rita)**

C3. **AP Supervisor — Coordinate resolution**
- Contact supplier and/or coordinate between departments
- Ensure invoice does not remain stuck indefinitely

C4. **Special case noted by Supervisor:** invoice has **no matching PO because services were contracted informally**
- **AP Supervisor + Department Heads — Decide: create retrospective PO or reject invoice**
- **XOR Gateway: “Retrospective PO created?”**
  - **Yes ** return to normal flow: **Purchasing confirmation  Manager approval  Payment scheduling**
  - **No ** **Reject invoice** (End: Invoice rejected)

---

### D) Manager rejects or requests hold/investigation (at Step 12 = “Reject/Hold”)
D1. **Department Manager — Reject in system or ask AP to hold and investigate**
D2. **AP Clerk — Place invoice on hold / initiate investigation**
D3. **Optional escalation / assistance (if needed):**
- **AP Supervisor** coordinates resolution
- **Karen** engages supplier / checks terms
- **Purchasing** re-verifies PO/receipt

D4. **XOR Gateway: “Issue resolved to manager’s satisfaction?”**
- **Yes ** **Re-submit for manager approval** (back to Step 10/11)
- **No ** **Reject invoice** (End: Invoice rejected)

---

## Notes / Ambiguities Captured from Interviews
- **Purchasing’s role overlaps**: AP describes Purchasing primarily as confirming receipt; Purchasing describes detailed PO-vs-invoice validation (qty/price/charges). Model treats Purchasing step as **both receipt and PO alignment confirmation**.
- **System vs email confirmations:** Manager approval is triggered by an **automatic system email/notification** once receipt is confirmed and invoice is matched; Purchasing confirmation is described as an **email back to AP**.
- **Who contacts supplier on discrepancies varies:** Sometimes Purchasing contacts supplier; sometimes AP (with Karen’s help) does; supervisor may also intervene for hard cases.

--- 

If you want, I can also output this in a stricter BPMN-ish serialization (e.g., numbered nodes + explicit sequence flow IDs and gateway conditions) to make diagramming even more mechanical.