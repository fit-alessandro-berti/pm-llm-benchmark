```sql
WITH case_variants AS (
  SELECT 
    case_id,
    LIST_AGG(activity ORDER BY timestamp) AS variant
  FROM event_log
  GROUP BY case_id
),
variant_stats AS (
  SELECT 
    variant,
    COUNT(*) AS freq,
    ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rn
  FROM case_variants
  GROUP BY variant
),
top_k_variants AS (
  SELECT variant
  FROM variant_stats
  WHERE rn <= ?  -- Replace ? with the value of K (e.g., 3 for top 3 variants)
),
top_cases AS (
  SELECT DISTINCT cv.case_id
  FROM case_variants cv
  INNER JOIN top_k_variants tkv ON cv.variant = tkv.variant
)
SELECT e.*
FROM event_log e
INNER JOIN top_cases tc ON e.case_id = tc.case_id
ORDER BY e.case_id, e.timestamp;
```