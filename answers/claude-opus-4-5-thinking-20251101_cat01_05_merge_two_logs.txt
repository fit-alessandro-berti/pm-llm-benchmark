# Merged Event Log Analysis and Integration

## Matching Methodology

I applied the following approach to merge the logs:

1. **Event Correlation Criteria**: Match events by `order_id` + semantic event type similarity + timestamp proximity (2 seconds preferred, with exceptions for contextually related events)
2. **Primary Timeline**: Log A timestamps used as primary reference for merged events
3. **Attribute Integration**: All attributes from both sources combined; conflicts documented

---

## Event-by-Event Matching Analysis

| Log A Event | Log B Event | Time  | Decision | Reasoning |
|-------------|-------------|--------|----------|-----------|
| Order Received (10:00:00Z) | OrderReceived (09:59:58Z) | 2s |  **Merge** | Same semantic meaning, within tolerance, same order |
| Order Validated (10:01:30Z) | OrderValidation (10:01:29Z) | 1s |  **Merge** | Same semantic meaning, within tolerance |
| Payment Processed (10:02:00Z) | PaymentCheck (10:02:05Z) | 5s |  **Merge** | Both payment-related; Log B note explains "Payment gateway delay" justifying offset |
| — | Quality Check (10:03:00Z) | N/A |  **Log B Only** | No corresponding event in Log A (additional inspection step) |
| Item Shipped (10:05:00Z) | Shipping (10:05:02Z) | 2s |  **Merge** | Same semantic meaning, within tolerance |
| Item Delivered (10:20:00Z) | — | N/A |  **Log A Only** | Delivery confirmation not captured by warehouse system (Log B) |

---

## Final Merged Event Log

```

                                    INTEGRATED ORDER FULFILLMENT EVENT LOG                                          
                                           Order#1234                                                                

 #   Primary Timestamp    Secondary Timestamp  Event Type         User ID  Resource ID  Notes                  
     (Log A)              (Log B)              (Unified)                                                       

 1   2023-10-10T10:00:00Z 2023-10-10T09:59:58Z Order Received     u45      r10          Event captured at      
                                                                                        warehouse system       
                                               [MERGED]                                                        

 2   2023-10-10T10:01:30Z 2023-10-10T10:01:29Z Order Validated    u12      r10          Cross-check inventory  
                                               [MERGED]                                                        

 3   2023-10-10T10:02:00Z 2023-10-10T10:02:05Z Payment Processed  u12      r99          Payment gateway delay  
                                               [MERGED]                                                        

 4   —                    2023-10-10T10:03:00Z Quality Check      u45      r11          Random inspection      
                                               [LOG B ONLY]                                                    

 5   2023-10-10T10:05:00Z 2023-10-10T10:05:02Z Item Shipped       u45      r10          Package handed to      
                                               [MERGED]                                 courier                

 6   2023-10-10T10:20:00Z —                    Item Delivered     —        —            —                      
                                               [LOG A ONLY]                                                    

```

---

## Structured Output (Machine-Readable Format)

```json
[
  {
    "event_id": 1,
    "primary_timestamp": "2023-10-10T10:00:00Z",
    "secondary_timestamp": "2023-10-10T09:59:58Z",
    "event_type": "Order Received",
    "order_id": "Order#1234",
    "user_id": "u45",
    "resource_id": "r10",
    "notes": "Event captured at warehouse system",
    "source": "merged",
    "origin_event_names": ["Order Received", "OrderReceived"]
  },
  {
    "event_id": 2,
    "primary_timestamp": "2023-10-10T10:01:30Z",
    "secondary_timestamp": "2023-10-10T10:01:29Z",
    "event_type": "Order Validated",
    "order_id": "Order#1234",
    "user_id": "u12",
    "resource_id": "r10",
    "notes": "Cross-check inventory",
    "source": "merged",
    "origin_event_names": ["Order Validated", "OrderValidation"]
  },
  {
    "event_id": 3,
    "primary_timestamp": "2023-10-10T10:02:00Z",
    "secondary_timestamp": "2023-10-10T10:02:05Z",
    "event_type": "Payment Processed",
    "order_id": "Order#1234",
    "user_id": "u12",
    "resource_id": "r99",
    "notes": "Payment gateway delay",
    "source": "merged",
    "origin_event_names": ["Payment Processed", "PaymentCheck"]
  },
  {
    "event_id": 4,
    "primary_timestamp": "2023-10-10T10:03:00Z",
    "secondary_timestamp": null,
    "event_type": "Quality Check",
    "order_id": "Order#1234",
    "user_id": "u45",
    "resource_id": "r11",
    "notes": "Random inspection",
    "source": "Log B only",
    "origin_event_names": ["Quality Check"]
  },
  {
    "event_id": 5,
    "primary_timestamp": "2023-10-10T10:05:00Z",
    "secondary_timestamp": "2023-10-10T10:05:02Z",
    "event_type": "Item Shipped",
    "order_id": "Order#1234",
    "user_id": "u45",
    "resource_id": "r10",
    "notes": "Package handed to courier",
    "source": "merged",
    "origin_event_names": ["Item Shipped", "Shipping"]
  },
  {
    "event_id": 6,
    "primary_timestamp": "2023-10-10T10:20:00Z",
    "secondary_timestamp": null,
    "event_type": "Item Delivered",
    "order_id": "Order#1234",
    "user_id": null,
    "resource_id": null,
    "notes": null,
    "source": "Log A only",
    "origin_event_names": ["Item Delivered"]
  }
]
```

---

## Reasoning & Conflict Resolution Documentation

### 1. **Timestamp Discrepancies**

| Event | Log A | Log B | Resolution |
|-------|-------|-------|------------|
| Order Received | 10:00:00Z | 09:59:58Z | Log B captured event 2s *earlier* — likely Log A reflects receipt time, Log B reflects actual occurrence. **Used Log A as primary per requirements.** |
| Payment Processed | 10:02:00Z | 10:02:05Z | 5-second gap exceeds 2s tolerance, but Log B's note ("Payment gateway delay") contextually explains the offset. **Merged with documented exception.** |

### 2. **Event Name Normalization**

| Log A Name | Log B Name | Unified Name |
|------------|------------|--------------|
| Order Received | OrderReceived | Order Received |
| Order Validated | OrderValidation | Order Validated |
| Payment Processed | PaymentCheck | Payment Processed |
| Item Shipped | Shipping | Item Shipped |

### 3. **Non-Overlapping Events**

- **Quality Check (Log B only)**: This represents an internal warehouse process (random inspection) that System A doesn't track. Retained with full Log B attributes.
  
- **Item Delivered (Log A only)**: Delivery confirmation likely occurs outside warehouse system scope (System B). Retained with Log A attributes; user/resource fields marked as unavailable.

### 4. **Design Decisions**

| Decision | Rationale |
|----------|-----------|
| Log A as primary timestamp | Per requirements, Log A is the "primary" timeline |
| Included both timestamps | Preserves audit trail and supports future analysis |
| Merged payment events despite 5s gap | Contextual evidence (notes field) strongly supports same-event hypothesis |
| Chronological ordering by primary timestamp | For Log B-only events, used Log B timestamp in sequence |

---

## Summary Statistics

| Metric | Count |
|--------|-------|
| Total Log A events | 5 |
| Total Log B events | 5 |
| Successfully merged | 4 |
| Log A only events | 1 |
| Log B only events | 1 |
| **Final unified events** | **6** |