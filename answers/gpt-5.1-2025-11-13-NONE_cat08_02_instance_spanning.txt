## 1. Identifying Instance-Spanning Constraints and Their Impact

### 1.1. General approach with the event log

From the log you can reconstruct, for each order (case):

- The control-flow: sequence of activities and their timestamps (start/complete).
- Resource usage: which station/staff, when.
- Attributes: Order Type (Standard/Express), Destination Region, Requires Cold Packing, Hazardous Material, etc.

Using process mining tools (e.g., PM4Py, ProM, Celonis), I would:

1. **Discover the baseline process model** (e.g., using Inductive Miner) to understand typical paths and deviations.
2. **Enrich the log with time-derived attributes**:
   - Activity duration = complete – start.
   - Waiting time before each activity = start(current activity) – complete(previous activity).
3. **Add resource-state views**:
   - For each resource (e.g., Station C2): timeline of which case occupies it.
   - For each constraint: time-dependent state variables (e.g., #hazardous orders in packing at time t).

Then, I’d compute per-constraint impact metrics.

---

### 1.2. Shared Cold-Packing Stations (Limited specialized resources)

**Goal:** Quantify how the limited cold stations create between-case delays.

**Identification:**

- Filter log to cases with `Requires Cold Packing = TRUE`.
- Filter activities = “Packing”, and resources labeled as cold stations (e.g., C1–C5).
- For each such case:
  - Pre-packing waiting time:
    - `Wait_cold = start(Packing) – complete(Item Picking)`
  - Activity duration:
    - `Dur_cold = complete(Packing) – start(Packing)`

**Impact metrics:**

- Average and distribution of `Wait_cold` per:
  - Time of day / weekday.
  - Station (C1…C5).
  - Order Type (Express vs Standard).
- Utilization metrics:
  - Cold station utilization = busy time / available time.
  - Queue length over time: number of cold orders waiting for a cold station.
  - Probability that all cold stations are busy when a new cold order arrives.

These show how often and how long orders wait purely due to **resource contention**.

**Distinguishing within- vs between-instance waiting:**

- Between-instance (resource-based) waiting for cold packing:
  - If at time of arrival all cold stations are busy and the order has `Wait_cold > 0`, this waiting is resource contention.
  - You can reconstruct resource schedules: for each station, list occupied intervals; when an order completes picking, check whether any cold station was idle in `[complete(picking), start(packing)]`. If none were idle, count this wait as resource contention.
- Within-instance waiting:
  - Intentional delays (e.g., policy: do not pack until payment confirmed) or batching, not due to station unavailability.
  - Identified if there is idle cold capacity during the wait (stations free while the order waits), indicating the cause is not the limited number of cold stations.

---

### 1.3. Shipping Batches (Batching for label generation)

**Goal:** Quantify how batching causes orders to wait for others.

**Identification:**

- Filter activities = “Shipping Label Gen.”
- Use `Destination Region` and batch ID (if present, e.g., “System (Batch B1)”).
- For each case:
  - Time entering “ready for batching” state:
    - `ready_for_batch = complete(Quality Check)` (assuming QC precedes label gen.)
  - Time shipping label is generated:
    - `start_label` or `complete_label` depending on how it’s logged.
  - Waiting for batch:
    - `Wait_batch = start(Shipping Label Gen.) – ready_for_batch`

**Impact metrics:**

- Average and distribution of `Wait_batch` per:
  - Destination Region.
  - Batch size (number of orders in same batch).
  - Time of day / weekday.
- Batch performance:
  - Typical batch size vs. resulting waiting time.
  - Time from first order ready in batch to last ready (= “batch closure time”).
  - % of orders that exceed SLA purely due to `Wait_batch`.

**Between- vs within-instance waiting:**

- Between-instance batch waiting:
  - Identify “batch windows”: for each batch region+batch-id, find:
    - `t_first_ready = min(ready_for_batch among batch members)`
    - `t_label = time batch is processed`
  - For each order:
    - Batch-induced waiting = `t_label – ready_for_batch`.
  - If `Wait_batch` >> typical label generation processing time, nearly all of it is waiting for other orders (an instance-spanning effect).
- Within-instance:
  - Actual label generation time (System processing, integration delays) once the batch is triggered; this is usually short and not dependent on other cases.

---

### 1.4. Priority Handling (Express vs Standard, preemption)

**Goal:** Quantify the disruption and delays caused by express orders pre-empting standard orders.

**Identification:**

- Use `Order Type` attribute and activities where priority applies (e.g., Packing, Quality Check).
- Reconstruct per resource (e.g., Station S7, C2, QC Staff A) a **time-ordered schedule** of activities with case IDs and priorities.
- Identify patterns:
  - Preemption: a standard order’s activity is interrupted, then switched to process an express order, then resumed later.
    - Visible if the same activity appears in multiple segments, or if the log includes `START`, `SUSPEND`, `RESUME`, `COMPLETE` events.
  - Priority-based queuing:
    - Standard orders waiting in queue while an express order arriving later is processed earlier.

**Impact metrics:**

- For Standard orders:
  - Extra waiting at priority-sensitive steps:
    - `Wait_standard_at_step = start(activity) – time_ready_for_step`
  - Compare these between windows with high vs low express traffic.
- For Express orders:
  - Waiting time at these steps vs standard orders.
- Preemption impact:
  - Count of interruptions per day/resource.
  - Additional duration added to interrupted activities (elapsed time from interrupt to resume).
- Overall:
  - SLA adherence by type: percentage of Express vs Standard orders meeting end-to-end targets.

**Between- vs within-instance waiting:**

- Between-instance:
  - A standard order is ready for packing (or QC), there is at least one candidate resource free or finishing soon, but processing is delayed because an express order is given priority:
    - In the resource schedule, you see the express order starting before the standard, even though the standard was already in queue.
- Within-instance:
  - Longer actual processing times for some orders due to complexity or errors—not caused by other cases.

---

### 1.5. Hazardous Material Limits (max 10 in Packing/QC simultaneously)

**Goal:** Understand how the regulatory cap limits throughput and introduces waiting, and whether it is binding.

**Identification:**

- Filter cases with `Hazardous Material = TRUE`.
- For activities = “Packing” and “Quality Check”:
  - Use both `START` and `COMPLETE` timestamps.
- Build a **timeline of hazardous concurrency**:
  - For every moment in time, compute:
    - `#haz_pack(t)` = number of hazardous orders with Packing in progress.
    - `#haz_qc(t)` = number of hazardous orders with QC in progress.
    - `#haz_total(t) = #haz_pack(t) + #haz_qc(t)`.
  - The constraint: `#haz_total(t)  10`.

**Impact metrics:**

- How often the limit is binding:
  - % of time `#haz_total(t) = 10`.
- Waiting times for hazardous orders due to the cap:
  - For each hazardous order:
    - `ready_for_pack = complete(Item Picking)`
    - `Wait_haz_pack = start(Packing) – ready_for_pack`
    - If at `ready_for_pack` and during most of `Wait_haz_pack`, `#haz_total(t) = 10`, classify waiting as due to regulatory cap.
  - Similar for QC: `Wait_haz_qc`.
- Throughput effect:
  - Compare average lead time of hazardous vs non-hazardous orders.
  - Correlate spikes in `#haz_total(t)` with global performance degradation (e.g., total WIP, SLA misses).

**Between- vs within-instance waiting:**

- Between-instance:
  - A hazardous order is ready, but `#haz_total(t) = 10`; it cannot start even though a physical station might be free—this is regulatory-instance-spanning waiting.
- Within-instance:
  - Additional checks inside the activity, rework loops, or internal delay independent of the limit.

---

## 2. Analyzing Constraint Interactions

The constraints don’t act in isolation. Key interactions:

### 2.1. Express orders + Cold-Packing

- Express + Cold:
  - Express orders requiring cold packing will jump the queue at cold stations.
  - Standard cold orders that are already waiting or in process may be preempted or delayed.
- Effects:
  - Increased **variability** in waiting times for standard cold orders.
  - Periods where cold station utilization is high but standard orders are starved.
- Importance:
  - Any resource allocation or scheduling policy must explicitly weigh:
    - SLA importance of express vs stability for standard.
    - Whether some cold stations should be reserved or dynamically allocated to express cases in peak times.

### 2.2. Batching + Hazardous limits

- If many hazardous orders are destined to the same region:
  - They may complete QC around the same time and enter the “ready for batching” pool.
  - But the system might delay label generation to form larger region-specific batches.
- Interaction:
  - The longer hazardous orders stay in Packing/QC (due to congestion or suboptimal scheduling), the more likely they cause the hazardous concurrency limit to be reached, which then blocks new hazardous orders.
  - Additionally, if label generation/batch closure is scheduled infrequently, hazardous orders may accumulate in “finished” status but still hold up resources earlier in the chain.

Understanding this helps adjust batch logic so that it doesn’t indirectly cause regulatory bottlenecks upstream.

### 2.3. Express priority + Batching

- Many Express orders might be routed differently (e.g., smaller, more frequent batches, or individual label generation).
- If not, they may get stuck waiting for batch formation like standard orders, undermining the benefit of priority elsewhere.
- Interaction:
  - Express orders may speed through Picking/Packing/QC but then wait for slower standard orders to form a batch.
- This indicates a need for **priority-aware batching**: express orders potentially batched separately or with lower batch size thresholds.

### 2.4. Cold-Packing + Hazardous limits

- If some hazardous orders also require cold packing:
  - They consume both a cold station and one of the limited hazardous slots.
- Interaction:
  - Peak hazardous volume might block cold-station access for non-hazardous cold orders, or vice-versa.
  - Warm packing could be underutilized while cold is saturated because of regulatory limits.

### 2.5. Why understanding interactions is crucial

- Optimizing a single constraint in isolation (e.g., just adding more cold stations) might:
  - Not improve performance if hazardous limits remain binding upstream.
  - Increase complexity and variability due to more aggressive express prioritization.
- A holistic view via the log allows:
  - Identifying whether the true bottleneck is capacity (cold stations) vs policy (batching, priority rules) vs regulation (hazardous cap).
  - Designing changes that redistribute load across constraints rather than shifting a bottleneck from one place to another.

---

## 3. Constraint-Aware Optimization Strategies

Below are three concrete strategies, each explicitly tied to the constraints and backed by data-driven insights.

---

### Strategy 1: Dynamic, Priority-Aware Slot Scheduling for Cold and Hazardous Orders

**Constraints addressed:**

- Shared Cold-Packing stations.
- Hazardous Material limit.
- Priority Handling (Express vs Standard).

**Key idea:**

Model cold and hazardous processing as **time-slotted capacity** and schedule orders dynamically based on predicted arrival and urgency, rather than strictly first-come-first-served (FCFS) with ad-hoc priority overrides.

**Specific changes:**

1. **Virtual capacity modeling:**
   - Treat:
     - Cold stations as `K_cold` parallel servers.
     - Hazardous cap as `K_haz = 10` global “tokens” that must be held while an order is in Packing or QC.
   - Every hazardous order needing Packing/QC must hold a hazardous token; if none available, order waits in a virtual queue.

2. **Priority queues with reserved capacity:**
   - For cold packing:
     - Maintain two queues: Express-cold and Standard-cold.
     - Reserve fraction `` (e.g., 1 out of 5 cold stations, or a fraction of time on each station) for Express-cold orders.
   - For hazardous capacity:
     - Reserve a small subset of hazardous slots (e.g., 2 of 10) for express-hazardous orders, using log data to calibrate need.
     - Standard-hazardous can only use the remaining `K_haz – reserved`.

3. **Scheduled windows for hazardous work:**
   - Based on historical patterns, identify time windows of high hazard arrival.
   - Temporarily increase the share of resources assigned to hazardous tasks in those windows (e.g., more packers QC’ing hazardous items), without exceeding the 10-order cap.
   - Outside peak windows, free those packers for non-hazardous work to avoid underutilization.

**Use of data/analysis:**

- Use arrival rate estimation from the log (per hour/day, by type) to:
  - Calculate required capacity to keep queue lengths within targets.
  - Size express-reserved capacity (, reserved hazardous tokens) so that Express SLA is met with high probability.
- Run queuing-analytics or small simulations to find the optimal express/standard split that minimizes overall delay.

**Expected outcomes:**

- Express hazardous/cold orders get much more predictable and shorter waiting times.
- Standard orders still get capacity, but are protected from frequent preemptions because priority is expressed as **reserved capacity**, not ad-hoc interruptions.
- Hazardous slot usage becomes more regular, reducing periods with `#haz_total(t) = 10` and corresponding blocking.

---

### Strategy 2: Priority-Aware, Time-Bounded Batching for Shipping Label Generation

**Constraints addressed:**

- Shipping Batches.
- Priority Handling.
- Indirectly, Hazardous limits (by reducing downstream waiting and WIP).

**Key idea:**

Replace rigid, volume-based batch formation with **hybrid rules**: combine thresholds on batch size, maximum waiting time, and priority-type, derived from log-based performance analysis.

**Specific changes:**

1. **Dynamic batch formation rules:**
   - For each Destination Region:
     - Define:
       - `N_min_standard`, `N_min_express` (batch size thresholds).
       - `T_max_standard`, `T_max_express` (max wait times for first order in batch).
   - Rules:
     - For Express orders:
       - As soon as an express order becomes ready, attempt to:
         - Batch with any other express orders ready for that region; if none, process as a small batch or even single order once `T_max_express` is reached (e.g., 10–15 minutes).
     - For Standard orders:
       - Wait until either:
         - At least `N_min_standard` orders are ready, or
         - The oldest ready order has waited `T_max_standard` (e.g., 60 minutes).

2. **Mixed batches with weighted priority:**
   - Allow batches to be composed of both Express and Standard orders but guarantee:
     - Express orders in a batch are always processed as soon as their `T_max_express` is reached, regardless of standard orders.
     - Standard orders can “ride along” but are not allowed to delay express ones.

3. **Regional calibration:**
   - Use historical data to estimate:
     - Arrival rates by region.
     - Relationship between batch size and shipping cost.
   - For high-volume regions: larger `N_min_standard` and smaller `T_max_standard` to reduce shipping cost without adding much waiting.
   - For low-volume regions: smaller `N_min_standard` and slightly higher shipping cost accepted to keep waiting under SLA.

**Use of data/analysis:**

- From the log, derive for each region:
  - Current `Wait_batch` distribution and its contribution to SLA violations.
  - Typical daily order volume, to choose thresholds that yield reasonable batch sizes within acceptable waiting times.
- Evaluate cost trade-offs (shipping cost vs SLA penalties) using simple economic modeling.

**Expected outcomes:**

- Significant reduction in `Wait_batch` for Express orders and often for Standard orders.
- More predictable end-to-end times: the variation caused by “waiting for slower batch members” drops.
- Avoiding orders sitting ready while hazardous capacity or packing is still clogged reduces total WIP and indirectly alleviates upstream pressure.

---

### Strategy 3: Micro-Decoupling and Parallelization of QC for Hazardous vs Non-Hazardous

**Constraints addressed:**

- Hazardous material limit.
- Priority Handling (by dedicating or flexibly allocating QC resources).
- Shared resources (packing and QC interplay).

**Key idea:**

Slightly redesign QC and packing for hazardous orders to **shorten the time they occupy the constrained phases** (packing & QC), thereby increasing effective throughput under the regulatory limit, and de-couple hazardous and non-hazardous flows as much as possible.

**Specific changes:**

1. **Split QC into two substeps for hazardous orders:**
   - QC-Prep (documentation, data checks, label printing) – may be done before/after physical handling and possibly outside the hazardous count if regulations allow.
   - QC-Physical (actual inspection and handling of hazardous goods) – counted in the 10-order limit.
   - Ensure the log accounts for this split so you can see the time in each sub-step.

2. **Reduce time spent in constrained phases:**
   - Use log analysis to identify:
     - Typical duration of hazardous packing and QC steps.
     - Outliers and causes (e.g., repacking, missing paperwork, staff skill).
   - Based on this:
     - Introduce standardized packing templates, pre-assembled kits, or checklists to reduce hazardous packing time.
     - Assign the most experienced staff to hazardous QC-Physical to speed it up and reduce rework.

3. **Dedicated vs flexible QC staff:**
   - Allocate some QC staff as “hazardous specialists” during peak hours.
   - Rotate them to non-hazardous QC outside peaks to avoid underutilization.
   - Ensure that for hazardous QC, enough staff are available so that the regulatory cap, not staffing, is the main limit.

**Use of data/analysis:**

- Event log segments:
  - `Dur_pack_haz`, `Dur_qc_haz`: distributions before change, identify 90th percentile and major delay sources.
- Validate if splitting QC (or moving parts of it outside the constrained phase) is legally acceptable and realistically reduces time in the “counted” activities.

**Expected outcomes:**

- Reduced average and peak duration of hazardous orders in Packing/QC, thus:
  - Less time occupying one of the 10 allowed slots.
  - More hazardous orders processed per day without breaching regulations.
- Lower waiting times for hazardous orders, which also reduces downstream waiting and overall lead time.

---

## 4. Simulation and Validation

Before implementing these strategies, a **discrete-event simulation (DES)** informed by the event log is essential.

### 4.1. Building the simulation model

Key elements:

- **Process flow**:
  - Activities: Order Received  Item Picking  Packing  QC  Shipping Label Gen.
  - Branches for cold vs non-cold, hazardous vs non-hazardous, express vs standard, by region.

- **Arrival process**:
  - Use historical inter-arrival times (possibly by hour/day-of-week) inferred from “Order Received” events.
  - Separate rates by order attributes if patterns differ (e.g., more express orders near holidays).

- **Activity time distributions**:
  - For each activity and case type (e.g., hazardous vs non-hazardous, express vs standard):
    - Fit empirical or parametric distributions from the log (lognormal, gamma, etc.).

- **Resources & capacities**:
  - Packing stations: cold vs standard, with staffing levels.
  - QC staff: hazardous specialists vs generalists.
  - Hazardous limit: global counter for #hazardous orders in Packing or QC  10.
  - Batching for label generation: logic as per current and proposed rules.

- **Policies**:
  - Current priority dispatching rules for express.
  - Current batch formation rules.
  - Proposed dynamic slot scheduling and priority-aware batching rules.

### 4.2. Aspects to accurately capture

1. **Resource contention**:
   - Implement explicit queues at cold stations, packing stations, QC, with priority rules and potential preemption if present in current operations.
   - Track queue lengths and utilization.

2. **Batching delays**:
   - For each region, simulate orders entering “ready for batch” state.
   - Trigger batch processing as per batch rules, capturing waiting times to batch closure.

3. **Priority interruptions**:
   - If the real process interrupts standard orders mid-activity:
     - Model preemptive service with residual times.
   - If no true mid-activity preemption (only queue priority), simulate strict priority queues.

4. **Regulatory limits**:
   - Implement a “hazardous token” mechanism:
     - An order must acquire a token to start hazardous Packing/QC.
     - If no token available, the order waits, regardless of resource availability.

### 4.3. Evaluation in simulation

For each scenario (baseline vs Strategy 1/2/3, combined or separate):

- Run multiple replications (to account for variability).
- KPIs:
  - End-to-end lead time by order type and segment (express vs standard, hazardous vs non, cold vs non-cold).
  - Waiting times at:
    - Cold packing stations (`Wait_cold`).
    - Hazardous packing and QC (`Wait_haz_pack`, `Wait_haz_qc`).
    - Shipping label generation (`Wait_batch`).
  - SLA compliance % per segment.
  - Resource utilization per station/staff type.
  - Frequency and duration of situations where:
    - `#haz_total(t) = 10`.
    - Cold stations are fully utilized while standard stations idle, and vice versa.

Compare scenarios to choose the combination of strategies that best improves KPIs without violating constraints, and check that improvements are robust across peak scenarios (e.g., simulate peak-season arrival rates).

---

## 5. Monitoring Post-Implementation

After changes, process mining again becomes the feedback loop. I would design dashboards focused on **constraint health** and **SLA performance**.

### 5.1. Key metrics and dashboards

1. **Lead time and SLA dashboard:**
   - End-to-end lead time distribution, separate by:
     - Express vs Standard.
     - Hazardous vs non-hazardous.
     - Cold vs non-cold.
   - SLA hit/miss rates per category.
   - Trend lines (daily/weekly) to see if performance is stable or drifting.

2. **Resource contention dashboard:**
   - For cold packing:
     - Average `Wait_cold` before and after, by time-of-day.
     - Cold station utilization per station, per shift.
     - Queue length/time series for cold queue (mean, 95th percentile).
   - For packing and QC in general:
     - Bottleneck analysis: station with highest utilization and queue.

3. **Batching dashboard:**
   - `Wait_batch` distribution by region and by order type.
   - Average batch size and time between batch runs, by region.
   - % of express orders processed individually vs in mixed batches.
   - SLA vs batch size (to check trade-offs remain acceptable).

4. **Hazardous constraint dashboard:**
   - Time series of `#haz_total(t)` with shading when it hits 10.
   - Time in “cap reached” state per day.
   - Waiting times `Wait_haz_pack` and `Wait_haz_qc`.
   - Comparison of hazardous vs non-hazardous lead times.

5. **Priority impact dashboard:**
   - For Standard orders:
     - Average waiting time at priority-sensitive steps vs express volume.
   - Preemption statistics (if applicable):
     - # of activity interruptions per day/week.
   - Throughput and SLA for Express orders, to confirm their advantage is maintained.

### 5.2. Tracking effectiveness of constraint management

To see whether constraints are better managed:

- **Cold-packing:**
  - Target: Decrease in `Wait_cold` (mean and variability) for both express and standard cold orders.
  - No systematic increase in overall utilization beyond sustainable levels; consistent throughput.

- **Batching:**
  - Decrease in `Wait_batch`, especially for express.
  - Batch size vs cost stays within planned thresholds.
  - Reduction in cases where orders are “stuck” at ready-for-batch state for long.

- **Hazardous limits:**
  - Reduction in time with `#haz_total(t) = 10`.
  - Hazardous waiting times reduced without any regulatory breaches.
  - Stable or improved hazardous throughput.

- **Priority handling:**
  - Express orders: high SLA compliance.
  - Standard orders: smaller negative impact from express priority (less queue jumping/preemption), inferred from waiting time patterns.

Run periodic process mining analyses (e.g., monthly) to:

- Re-discover the process model and check for unintended new variants.
- Validate that operational policies (e.g., reserved capacity, batching rules) are being followed in practice (conformance checking).
- Adjust thresholds (e.g., batch sizes, reserved capacities) using the latest performance data.

---

This combination—log-based identification of instance-spanning constraints, interaction analysis, targeted optimization strategies, simulation-based validation, and continuous monitoring—provides a robust, data-driven approach to improve the fulfillment center’s ability to meet delivery deadlines despite complex dependencies between orders.