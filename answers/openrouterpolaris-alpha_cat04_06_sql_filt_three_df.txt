Here’s a concise DuckDB SQL solution that does exactly what you described:

- Detects cases with the exact consecutive sequence:
  Approve Purchase Requisition  Create Order  Confirm Order
- Checks that the time between Create Order and Confirm Order in that sequence is > 5 days
- Excludes all events from those cases; returns only events from other cases

Query:

```sql
WITH ordered AS (
    SELECT
        case_id,
        activity,
        "timestamp",
        ROW_NUMBER() OVER (
            PARTITION BY case_id
            ORDER BY "timestamp", activity
        ) AS rn
    FROM event_log
),
sequence_cases AS (
    SELECT DISTINCT o1.case_id
    FROM ordered o1
    JOIN ordered o2
        ON o2.case_id = o1.case_id
       AND o2.rn = o1.rn + 1
    JOIN ordered o3
        ON o3.case_id = o1.case_id
       AND o3.rn = o1.rn + 2
    WHERE
        o1.activity = 'Approve Purchase Requisition'
        AND o2.activity = 'Create Order'
        AND o3.activity = 'Confirm Order'
        AND (o3."timestamp" - o2."timestamp") > INTERVAL 5 DAY
)
SELECT *
FROM event_log
WHERE case_id NOT IN (SELECT case_id FROM sequence_cases)
ORDER BY case_id, "timestamp", activity;
```

Notes:
- The ROW_NUMBER ensures we only consider activities in direct succession within each case.
- The join pattern (rn, rn+1, rn+2) enforces “no events in between.”
- DISTINCT in sequence_cases handles multiple occurrences; any qualifying sequence excludes the whole case.