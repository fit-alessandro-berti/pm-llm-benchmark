### BPMN-Like Textual Process Model: Invoice Approval Process

This textual representation describes the invoice approval process as a BPMN (Business Process Model and Notation) diagram in a structured, hierarchical format. It can be directly translated into a visual BPMN tool (e.g., using pools/lanes for roles, sequence flows as arrows, exclusive gateways (XOR) for decisions, and data objects for artifacts). The model consolidates accounts from all interviewees, prioritizing the typical flow described by Mary (AP Clerk) while incorporating perspectives from others. Conflicting or ambiguous details (e.g., exact sequencing of matching vs. confirmation) are noted as variations. Exceptions are modeled as alternate paths or loops.

#### Pools and Lanes (Roles/Participants)
- **Pool: Internal Organization** (contains all lanes below)
  - **Lane: Accounts Payable (AP) Clerk (Mary)**: Handles initial receipt, logging, matching, and payment scheduling.
  - **Lane: Purchasing Officer (Dan)**: Confirms receipt and matches against PO.
  - **Lane: Department Manager (Carlos)**: Provides final approval.
  - **Lane: AP Supervisor (Rita)**: Handles escalations and exceptions (e.g., no PO or unresolved discrepancies).
  - **Lane: Supplier Relationship Manager (Karen)**: Assists with supplier communications for discrepancies (ad-hoc involvement, not a fixed lane but triggered as needed).
- **Pool: External Supplier**: Receives requests for corrections/revisions (message flows only).

#### Data Objects/Artifacts (Inputs/Outputs)
- **Input:** Invoice (email or document, often with PO reference).
- **Core Artifacts:** Purchase Order (PO) document/system record; Confirmation Email (from Purchasing); Matched Invoice (system entry); Approval Notification (system-generated email).
- **Output:** Scheduled Payment (added to payment run in accounting system).
- **Annotations:** All interactions with the "Accounting System" are implied as a backend service (e.g., for logging, notifications, and approvals).

#### Process Flow Description
The model starts with a **Start Event: Invoice Receipt** (message start event, triggered by email arrival in AP). It follows a linear sequence with decision gateways for checks and exceptions. Parallelism is minimal (e.g., no explicit AND gateways), but loops exist for rework. An **End Event: Payment Scheduled** marks successful completion. Unresolved exceptions may lead to an **Error End Event: Invoice Rejected** (noted where applicable).

1. **Start Event: Invoice Receipt**  
   - Description: Invoice arrives via email to AP Clerk.  
   - Role: AP Clerk (Mary).  
   - Output Artifact: Invoice.  
   - Sequence Flow: To Task 1.

2. **Task 1: Check for Valid PO Number** (User Task)  
   - Description: AP Clerk reviews invoice for associated PO number.  
   - Role: AP Clerk (Mary).  
   - Input: Invoice.  
   - Output: Invoice (annotated with PO status).  
   - Sequence Flow: To Gateway 1 (XOR: Has Valid PO?).  
   - Note: If PO is missing, this may involve initial contact with Supplier (per Dan and Karen).

3. **Gateway 1: Has Valid PO?** (Exclusive Gateway - XOR)  
   - Description: Decision based on presence of PO reference.  
   - Conditions:  
     - Yes  Proceed to Task 2.  
     - No  Alternate Path to Subprocess A (Request PO Details).  
   - Variation: Per Rita, some invoices lack PO due to informal contracts; handled via escalation.

   **Subprocess A: Request PO Details (Collapsed Subprocess - Loop Potential)**  
   - Description: Handle missing PO (exception path).  
   - Steps:  
     a. **Task A1: Send Invoice Back to Supplier** (Send Task).  
        - Role: AP Clerk (Mary), possibly with Supplier Relationship Manager (Karen).  
        - Description: Email supplier requesting PO or revised invoice.  
        - Output: Revised Invoice (if provided).  
        - Sequence Flow: To Gateway A1 (Received Revision?).  
     b. **Gateway A1: Received Revision?** (XOR).  
        - Yes  Return to Gateway 1 (re-check PO).  
        - No/Unresolved  Escalate to Task A2.  
     c. **Task A2: Escalate to Supervisor** (User Task).  
        - Role: AP Supervisor (Rita).  
        - Description: Coordinate with supplier/departments; create retrospective PO or reject invoice. Involves Karen for contract checks if needed.  
        - Input: Invoice (flagged as exception).  
        - Output: Retrospective PO (if created) or Rejection Notice.  
        - Sequence Flow: If resolved  Return to Gateway 1; Else  Error End Event: Invoice Rejected.  
   - Note: This forms a potential loop back to Task 1 if revised. Per Rita and Karen, this resolves most no-PO cases without full rejection.

4. **Task 2: Log Invoice and Forward to Purchasing** (Service Task + Send Task)  
   - Description: Log invoice into accounting system; forward to Purchasing for confirmation of receipt and initial matching. (Per Mary: Log first, then forward; per Dan: Receives directly for check.)  
   - Role: AP Clerk (Mary).  
   - Input: Invoice + PO.  
   - Output: Logged Invoice; Forwarded Request.  
   - Sequence Flow: To Task 3 (Purchasing Confirmation).  
   - Variation: Sequencing ambiguity—Mary describes logging before forwarding, Dan assumes direct receipt; modeled as sequential for coherence.

5. **Task 3: Confirm Receipt and Match Against PO** (User Task)  
   - Description: Purchasing compares invoice details (quantities, prices, delivery charges) to PO and confirms goods/services received. AP performs final line-item matching post-confirmation.  
   - Role: Purchasing Officer (Dan) for confirmation; AP Clerk (Mary) for final match.  
   - Input: Forwarded Invoice + PO.  
   - Output: Confirmation Email (if match); or Discrepancy Flag.  
   - Sequence Flow: To Gateway 2 (Match Successful?).  
   - Note: Per Dan and Mary, this may involve back-and-forth emails if minor issues.

6. **Gateway 2: Match Successful?** (Exclusive Gateway - XOR)  
   - Description: Decision after confirmation and matching.  
   - Conditions:  
     - Yes (Everything matches)  Proceed to Task 4.  
     - No (Discrepancy, e.g., pricing, quantities, missing items)  Alternate Path to Subprocess B (Resolve Discrepancy).  
   - Variation: Discrepancies occur "sometimes" (Mary); "if something’s off" (Dan); rare for manager (Carlos, ~once every 2 months).

   **Subprocess B: Resolve Discrepancy (Collapsed Subprocess - Loop Potential)**  
   - Description: Handle mismatches (exception path).  
   - Steps:  
     a. **Task B1: Clarify with Supplier/Purchasing** (Send Task).  
        - Role: AP Clerk (Mary) emails Purchasing (Dan); or Dan/Purchasing contacts supplier directly. Involves Karen for contract/pricing checks.  
        - Description: Request clarification or corrected invoice. Hold invoice in system.  
        - Output: Clarification Response or Revised Invoice.  
        - Sequence Flow: To Gateway B1 (Resolved?).  
     b. **Gateway B1: Resolved Easily?** (XOR).  
        - Yes  Return to Gateway 2 (re-match).  
        - No  Escalate to Task B2.  
     c. **Task B2: Escalate to Supervisor** (User Task).  
        - Role: AP Supervisor (Rita).  
        - Description: Coordinate resolution (e.g., supplier contact via Karen); decide on rejection if unresolvable.  
        - Input: Discrepancy-Flagged Invoice.  
        - Output: Resolved Invoice or Rejection.  
        - Sequence Flow: If resolved  Return to Gateway 2; Else  Error End Event: Invoice Rejected (or loop back if partial fix).  
   - Note: Forms a rework loop. Per all interviewees, escalations to Rita/Karen prevent indefinite holds.

7. **Task 4: Request Manager Approval** (Service Task)  
   - Description: System sends automatic notification/email with invoice details, PO, and confirmation for review.  
   - Role: Accounting System (automated); triggered after Gateway 2.  
   - Input: Matched Invoice + Confirmation.  
   - Output: Approval Request.  
   - Sequence Flow: To Task 5.  
   - Note: Trigger confirmed by Mary and Carlos.

8. **Task 5: Review and Approve Invoice** (User Task)  
   - Description: Manager reviews details (quantities, pricing, budget alignment); approves in system or flags issues.  
   - Role: Department Manager (Carlos).  
   - Input: Approval Request + Artifacts (Invoice, PO, Confirmation).  
   - Output: Approved Invoice or Rejection/Investigation Request.  
   - Sequence Flow: To Gateway 3 (Approved?).  
   - Variation: Rejections rare (Carlos); if suspicious, "ask Mary to hold and investigate"  potential loop to Subprocess B.

9. **Gateway 3: Approved?** (Exclusive Gateway - XOR)  
   - Description: Decision on manager review.  
   - Conditions:  
     - Yes  Proceed to Task 6.  
     - No (e.g., budget issues, unexpected items)  Alternate Path: Return to Subprocess B (Investigate Further) or Error End Event: Invoice Rejected.  
   - Note: Rejection leads to rework or termination; modeled as loop for investigation.

10. **Task 6: Schedule for Payment** (User Task)  
    - Description: Add approved invoice to next payment cycle/run in accounting system.  
    - Role: AP Clerk (Mary) or team.  
    - Input: Approved Invoice.  
    - Output: Scheduled Payment.  
    - Sequence Flow: To End Event.

11. **End Event: Payment Scheduled** (Message End Event)  
    - Description: Invoice processed successfully; payment executed in batch.  
    - Role: Accounting System/AP.  

12. **Error End Event: Invoice Rejected** (Error End Event)  
    - Description: Process terminates if unresolvable (e.g., no PO, major discrepancy, manager rejection).  
    - Triggers: From Subprocess A/B or Gateway 3 (No).  
    - Note: Frequency low per interviewees; may involve supplier notification.

#### Additional Annotations
- **Overall Sequence:** Primary flow: Start  Task 1  Gateway 1 (Yes)  Task 2  Task 3  Gateway 2 (Yes)  Task 4  Task 5  Gateway 3 (Yes)  Task 6  End. Exceptions add loops/subprocesses for ~10-20% of cases (inferred from qualitative mentions like "sometimes" or "once every couple of months").
- **Uncertainties/Ambiguities Noted:** 
  - Exact handoff between AP matching (Mary) and Purchasing confirmation (Dan) may vary (e.g., parallel in some cases per Dan's account).
  - Karen's involvement is ad-hoc (message flows to Supplier pool), not sequential.
  - No explicit mention of timelines or volumes, so not modeled.
  - Informal contracts (Rita) add variation to PO handling, but consolidated into Subprocess A.
- **Visual Translation Tips:** Use lanes horizontally; place gateways as diamonds; subprocesses as rounded rectangles with + symbol; data objects as attached rectangles to tasks. Total elements: ~10 main tasks + 3 gateways + 2 subprocesses. This model achieves logical coherence while reflecting multi-viewpoint narratives.