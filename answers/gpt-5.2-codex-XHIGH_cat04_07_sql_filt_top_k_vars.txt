Below is a single DuckDB SQL query that performs all required steps: it builds the ordered activity sequence per case, groups cases into variants, selects the topK variants by frequency, and returns only the events belonging to those cases.

```sql
-- K = number of variants to keep
WITH case_variants AS (
    -- 1) ordered activity sequence per case
    SELECT
        case_id,
        string_agg(activity, '->' ORDER BY timestamp) AS variant
    FROM event_log
    GROUP BY case_id
),

variant_counts AS (
    -- 2) count cases per variant
    SELECT
        variant,
        COUNT(*) AS case_count
    FROM case_variants
    GROUP BY variant
),

top_variants AS (
    -- 3) top K variants by frequency
    SELECT variant
    FROM variant_counts
    ORDER BY case_count DESC
    LIMIT K
)

-- 4) return events from cases in top K variants only
SELECT e.*
FROM event_log e
JOIN case_variants cv ON e.case_id = cv.case_id
JOIN top_variants tv ON cv.variant = tv.variant
ORDER BY e.case_id, e.timestamp;
```

**What this does:**
- `case_variants` builds the ordered sequence of activities per case.
- `variant_counts` counts how many cases follow each sequence.
- `top_variants` keeps only the most frequent K variants.
- Final SELECT returns all events from cases belonging to those top variants.