```sql
-- Replace 10 with your desired K
WITH case_variants AS (
    SELECT
        case_id,
        string_agg(activity, '->' ORDER BY "timestamp") AS variant
    FROM event_log
    GROUP BY case_id
),
variant_counts AS (
    SELECT
        variant,
        COUNT(*) AS case_count
    FROM case_variants
    GROUP BY variant
),
top_k_variants AS (
    SELECT variant
    FROM variant_counts
    ORDER BY case_count DESC
    LIMIT 10
),
top_k_cases AS (
    SELECT cv.case_id, cv.variant
    FROM case_variants cv
    JOIN top_k_variants tv USING (variant)
)
SELECT
    el.*,
    tc.variant
FROM event_log el
JOIN top_k_cases tc USING (case_id)
ORDER BY el.case_id, el."timestamp";
```