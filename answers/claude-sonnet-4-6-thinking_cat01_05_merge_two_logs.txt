# Merged Event Log — Order Fulfillment Process (Order#1234)

---

## Phase 1: Matching Analysis

Before producing the final log, I systematically compared every event from Log A against every event from Log B for the same `order_id`, evaluating two criteria: **semantic similarity of event names** and **timestamp proximity**.

| # | Log A Event | Log A Timestamp | Log B Event | Log B Timestamp |  Time | Decision |
|---|---|---|---|---|---|---|
| 1 | Order Received | 10:00:00Z | OrderReceived | 09:59:58Z | **2 s** |  MERGE |
| 2 | Order Validated | 10:01:30Z | OrderValidation | 10:01:29Z | **1 s** |  MERGE |
| 3 | Payment Processed | 10:02:00Z | PaymentCheck | 10:02:05Z | **5 s** |  MERGE* |
| 4 | Item Shipped | 10:05:00Z | Shipping | 10:05:02Z | **2 s** |  MERGE |
| 5 | Item Delivered | 10:20:00Z | *(no match)* | — | — |  LOG A ONLY |
| 6 | *(no match)* | — | Quality Check | 10:03:00Z | — |  LOG B ONLY |

> \* Payment Processed / PaymentCheck: The 5-second delta exceeds the strict 2-second tolerance. However, the Log B note explicitly reads **"Payment gateway delay"**, which explains the offset (the gateway introduced latency between Log A receiving the event and Log B recording the completion check). Combined with the strong semantic alignment and identical `order_id`, this is treated as the same event. Both timestamps are preserved and flagged.

---

## Phase 2: Conflict Resolution Rules

| Situation | Resolution Applied |
|---|---|
| Slightly different timestamps | Log A timestamp = **primary**; Log B timestamp retained as `timestamp_logB` |
| Different event naming conventions | Log A name used as **canonical name**; Log B name stored in `event_name_logB` |
| Attributes only in Log B | Added as-is (`user_id`, `resource_id`, `notes`) |
| Attributes only in Log A | Retained; Log B fields marked `N/A` |
| Event in one log only | Included in full; `source` field identifies origin |

---

## Phase 3: Final Merged Event Log

---

### Event 1 — Order Received
```

timestamp (primary):   2023-10-10T10:00:00Z  [Log A]
timestamp_logB:        2023-10-10T09:59:58Z  [Log B]
event_type:            Order Received
event_name_logB:       OrderReceived
order_id:              Order#1234
user_id:               u45
resource_id:           r10
notes:                 "Event captured at warehouse system"
source:                Merged (Log A + Log B)

```
**Reasoning:** Log B recorded this event 2 seconds *before* Log A — consistent with the stated behavior that Log A timestamps reflect *receipt* time rather than event start. The names are identical modulo spacing/casing. Merged confidently. Log A's timestamp used as primary per convention.

---

### Event 2 — Order Validated
```

timestamp (primary):   2023-10-10T10:01:30Z  [Log A]
timestamp_logB:        2023-10-10T10:01:29Z  [Log B]
event_type:            Order Validated
event_name_logB:       OrderValidation
order_id:              Order#1234
user_id:               u12
resource_id:           r10
notes:                 "Cross-check inventory"
source:                Merged (Log A + Log B)

```
**Reasoning:** 1-second delta is well within tolerance. "Order Validated" and "OrderValidation" are clearly the same activity. Merged with high confidence. The `notes` field clarifies validation involved inventory cross-checking, adding meaningful context absent from Log A.

---

### Event 3 — Payment Processed
```

timestamp (primary):   2023-10-10T10:02:00Z  [Log A]
timestamp_logB:        2023-10-10T10:02:05Z  [Log B]
event_type:            Payment Processed
event_name_logB:       PaymentCheck
order_id:              Order#1234
user_id:               u12
resource_id:           r99
notes:                 "Payment gateway delay"  explains timestamp gap
source:                Merged (Log A + Log B) — timestamp delta 5 s, exceeds tolerance;
                       merged on semantic grounds (see reasoning)

```
**Reasoning:** The 5-second delta exceeds the 2-second rule, but the merge is justified by three converging signals: (a) the event names describe the same payment activity, (b) `resource_id: r99` likely represents the payment gateway resource, and (c) the Log B note *explicitly* attributes the gap to a "Payment gateway delay." This is the strongest available explanation for the timestamp offset. Both timestamps are preserved and the anomaly is flagged in the `source` field for auditability.

---

### Event 4 — Quality Check *(Log B only)*
```

timestamp (primary):   2023-10-10T10:03:00Z  [Log B]
timestamp_logB:        2023-10-10T10:03:00Z
event_type:            Quality Check
event_name_logB:       Quality Check
order_id:              Order#1234
user_id:               u45
resource_id:           r11
notes:                 "Random inspection"
source:                Log B only (no corresponding event in Log A)

```
**Reasoning:** No event in Log A falls within any reasonable time window of 10:03:00Z, and no Log A event name suggests a quality check step. This appears to be a real process step that System A simply did not instrument or track. Included as-is to preserve full process fidelity.

---

### Event 5 — Item Shipped
```

timestamp (primary):   2023-10-10T10:05:00Z  [Log A]
timestamp_logB:        2023-10-10T10:05:02Z  [Log B]
event_type:            Item Shipped
event_name_logB:       Shipping
order_id:              Order#1234
user_id:               u45
resource_id:           r10
notes:                 "Package handed to courier"
source:                Merged (Log A + Log B)

```
**Reasoning:** 2-second delta, at the boundary of tolerance. The semantic match is unambiguous ("Item Shipped" / "Shipping"), and the Log B note confirms the physical handoff event. Same `user_id` and `resource_id` as the Order Received event (u45, r10), consistent with warehouse personnel managing both intake and dispatch. Merged confidently.

---

### Event 6 — Item Delivered *(Log A only)*
```

timestamp (primary):   2023-10-10T10:20:00Z  [Log A]
timestamp_logB:        N/A
event_type:            Item Delivered
event_name_logB:       N/A
order_id:              Order#1234
user_id:               N/A
resource_id:           N/A
notes:                 N/A
source:                Log A only (no corresponding event in Log B)

```
**Reasoning:** Log B has no event near 10:20:00Z. Delivery confirmation may be outside System B's instrumentation scope (e.g., System B is a warehouse system that stops tracking after courier handoff, while System A continues to track through final delivery). Included as-is.

---

## Summary Table — Final Merged Log (Chronological)

| # | Primary Timestamp | Canonical Event | Log B Name | order_id | user_id | resource_id | Notes | Source |
|---|---|---|---|---|---|---|---|---|
| 1 | 10:00:00Z *(+09:59:58Z)* | Order Received | OrderReceived | Order#1234 | u45 | r10 | Event captured at warehouse system | Merged |
| 2 | 10:01:30Z *(+10:01:29Z)* | Order Validated | OrderValidation | Order#1234 | u12 | r10 | Cross-check inventory | Merged |
| 3 | 10:02:00Z *(+10:02:05Z)* | Payment Processed | PaymentCheck | Order#1234 | u12 | r99 | Payment gateway delay  | Merged† |
| 4 | 10:03:00Z | Quality Check | Quality Check | Order#1234 | u45 | r11 | Random inspection | Log B only |
| 5 | 10:05:00Z *(+10:05:02Z)* | Item Shipped | Shipping | Order#1234 | u45 | r10 | Package handed to courier | Merged |
| 6 | 10:20:00Z | Item Delivered | N/A | Order#1234 | N/A | N/A | N/A | Log A only |

> † Merged despite 5 s delta due to explicit gateway-delay note and strong semantic alignment.

---

## Key Decisions & Design Notes

1. **Primary timestamp source:** Log A is designated the primary timeline per the problem specification, so Log A timestamps head each merged record. Log B timestamps are always preserved as a secondary field for traceability.

2. **Canonical event name source:** Log A names are used as canonical labels for consistency. Log B names are stored in `event_name_logB` so no information is discarded.

3. **Tolerance boundary cases (2 s exactly):** Events 1 and 5 sit exactly at the 2-second threshold. In both cases, the semantic match was unambiguous, so the merge was performed. A stricter "strictly less than 2 s" interpretation would leave them unmerged — this is flagged for the consumer of this log to decide based on domain requirements.

4. **Unmatchable events preserved:** The `Quality Check` (Log B) and `Item Delivered` (Log A) events are included in full rather than dropped, ensuring the merged log captures the complete observable process history across both systems.