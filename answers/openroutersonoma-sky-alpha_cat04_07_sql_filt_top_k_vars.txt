```sql
WITH case_sequences AS (
  SELECT 
    case_id,
    LIST_AGG(activity ORDER BY timestamp) AS activity_sequence
  FROM event_log
  GROUP BY case_id
),
variant_counts AS (
  SELECT 
    activity_sequence,
    COUNT(*) AS frequency
  FROM case_sequences
  GROUP BY activity_sequence
),
ranked_variants AS (
  SELECT 
    activity_sequence,
    frequency,
    ROW_NUMBER() OVER (ORDER BY frequency DESC, activity_sequence) AS variant_rank
  FROM variant_counts
),
top_k_sequences AS (
  SELECT activity_sequence
  FROM ranked_variants
  WHERE variant_rank <= 5  -- Replace 5 with K or use a parameter (e.g., via DuckDB's ? or SET k=5; WHERE variant_rank <= ?k)
),
top_k_cases AS (
  SELECT cs.case_id
  FROM case_sequences cs
  INNER JOIN top_k_sequences tks ON cs.activity_sequence = tks.activity_sequence
)
SELECT 
  el.case_id,
  el.activity,
  el.timestamp
FROM event_log el
INNER JOIN top_k_cases tkc ON el.case_id = tkc.case_id
ORDER BY el.case_id, el.timestamp;
```