Process name: Invoice Approval and Payment Scheduling

Participants (Pools/Lanes):
- Supplier (external)
- Accounts Payable (AP) – Clerk (Mary), Supervisor (Rita)
- Purchasing – Officer (Dan)
- Department Manager (Carlos)
- Supplier Relationship Manager (Karen)
- Accounting System (system)

Start event:
- Invoice received by AP (via email)

Data objects:
- Invoice (from Supplier)
- Purchase Order (PO)
- Goods/Service Receipt confirmation
- Contract/Agreement (for pricing/terms)
- Manager approval record
- Payment schedule entry

Main flow (sequence of activities and gateways):

1. AP Clerk: Receive invoice (email) -> Create Invoice document in Accounting System.
   Output: Invoice captured.

2. Exclusive Gateway: Does invoice contain a valid PO number?
   - No:
     2.1 AP Clerk: Request PO details from Supplier (email).
     2.2 Wait for Supplier response (Message Intermediate Event).
     2.3 Exclusive Gateway: Is PO provided and valid?
         - No (after reasonable attempts):
           2.3.1 AP Clerk: Escalate to AP Supervisor.
           2.3.2 AP Supervisor: Determine handling for non-PO invoice.
                 Parallel options (depending on case):
                 a) Coordinate retrospective PO creation with Department Head (subprocess).
                 b) Decide to reject invoice; notify Supplier (End: Rejected).
           2.3.3 Exclusive Gateway: Was retrospective PO created?
                 - No: End: Rejected (Supplier notified).
                 - Yes: Continue to step 3.
         - Yes: Continue to step 3.
   - Yes:
     Proceed to step 3.

3. AP Clerk: Log invoice in Accounting System (invoice registration).
   Output: Invoice record linked to PO (if available).

4. AP Clerk: Forward invoice to Purchasing for receipt/PO confirmation (system/email notification).
   Output: Task assigned to Purchasing.

5. Purchasing Officer: Verify PO vs invoice (quantities, prices, delivery/charges) and confirm receipt of goods/services.
   Inputs: Invoice, PO, (receipt confirmation if recorded).
   Output: Confirmation or discrepancy noted.

6. Exclusive Gateway: Discrepancy or missing info detected by Purchasing?
   - Yes:
     6.1 Purchasing Officer: Contact Supplier or request AP to hold invoice pending correction.
     6.2 Optional involvement: Supplier Relationship Manager checks contract/terms and liaises with Supplier for corrected invoice or missing PO.
     6.3 Wait for corrected invoice/clarification (Message Intermediate Event from Supplier/SRM).
     6.4 Exclusive Gateway: Is discrepancy resolved and corrected invoice/confirmation received?
         - No:
           6.4.1 AP Clerk: Escalate to AP Supervisor.
           6.4.2 AP Supervisor: Coordinate resolution (Supplier, Purchasing, Department Head) or decide to reject.
           6.4.3 Exclusive Gateway: Resolved?
                 - No: End: Rejected (Supplier notified).
                 - Yes: Return to step 5 (re-verify).
         - Yes: Return to step 5 (re-verify, then proceed to 7 if clean).
   - No:
     Proceed to step 7.

7. Purchasing Officer: Send confirmation to AP (email/system) that goods/services received and PO match is correct.
   Output: Purchasing confirmation attached to invoice.

8. AP Clerk: 3-way match in system (Invoice vs PO vs Receipt).
   Output: Matching result.

9. Exclusive Gateway: Does 3-way match succeed?
   - No:
     9.1 AP Clerk: Email Purchasing to clarify discrepancies; optionally involve SRM for pricing/terms.
     9.2 Exclusive Gateway: Can AP/Purchasing resolve without escalation?
         - No: AP Clerk escalates to AP Supervisor (Rita) -> AP Supervisor coordinates resolution or rejection (as in 6.4.2/6.4.3). If resolved, loop back to step 8. If not, End: Rejected.
         - Yes: Loop back to step 8.
   - Yes:
     Proceed to step 10.

10. System: Trigger Manager approval request (automatic notification to Department Manager with invoice, PO, and Purchasing confirmation).

11. Department Manager: Review and approve invoice.
    - Inclusive options:
      a) Approve.
      b) Reject or request hold/investigation.

12. Exclusive Gateway: Manager decision?
   - Approve:
     12.1 System records approval.
     12.2 AP Clerk: Schedule for payment in next payment run.
     12.3 End: Scheduled for payment.
   - Reject / Hold:
     12.1 Department Manager: Provide rejection reason or request investigation to AP.
     12.2 AP Clerk: Hold invoice and investigate with Purchasing and/or SRM as needed.
     12.3 Exclusive Gateway: Issue resolved?
         - No: End: Rejected (Supplier notified by AP/SRM).
         - Yes: Return to step 10 (re-submit for Manager approval).

Exception and variation notes:
- Non-PO invoices: Typically routed to AP Supervisor to decide on retrospective PO creation with Department Head or rejection. After retrospective PO exists, process rejoins at logging and Purchasing confirmation steps.
- Missing PO initially: AP requests from Supplier; Purchasing will not proceed without valid PO reference.
- Discrepancies (pricing, quantities, extra units, delivery charges): Purchasing may contact Supplier directly or ask AP to hold; SRM may validate contract terms and obtain corrected invoices.
- Manager rejections are infrequent but trigger a hold/investigation loop with AP and Purchasing before re-approval or final rejection.
- Escalation threshold: If AP cannot resolve discrepancies with Purchasing/Supplier, escalate to AP Supervisor, who coordinates cross-department resolution to prevent invoices from stalling.

Artifacts and system touchpoints:
- Accounting System stores invoice record, links to PO, performs/records matching, triggers manager approval emails, records approvals, and supports payment scheduling.
- Emails are used for Supplier communication, Purchasing confirmations, and some escalations.
- Contract documents may be consulted by SRM to resolve pricing/terms issues.

End events:
- Scheduled for payment (approved and queued in payment run).
- Rejected (supplier notified; invoice closed without payment).