# Process Mining for Last-Mile Delivery Optimization: Speedy Parcels

## 1. Process Discovery and Conformance Checking

### Data Preprocessing and Integration

To create a cohesive event log, the data from the four sources (GPS, Scanner, Dispatch, Maintenance) must be harmonized. The **Case ID** (Vehicle-Day) will serve as the primary identifier for the end-to-end process flow for a single van's shift.

**Integration Steps and Challenges:**

1.  **Normalization and Timestamp Synchronization:** All timestamps must be converted to a consistent format and time zone.
2.  **Activity Mapping:** Events from different sources must be mapped to standardized activity names (e.g., GPS idle time in proximity to a customer location must be grouped with 'Arrive Customer'/'Depart Customer' scanner events to define 'Service Time').
    * **Challenge:** Linking high-frequency GPS data (e.g., every 30 seconds) with discrete scanner events. We must use spatial proximity and time windows to associate GPS movement data (travel time) with delivery stop events (service time).
3.  **Attribute Enrichment:** Key attributes must be attached to the activities.
    * GPS data provides speed (useful for calculating fuel efficiency and identifying traffic delays).
    * Dispatch data provides the *planned* sequence, required capacity, and requested delivery windows.
    * Maintenance logs provide 'Unavailability Time' which interrupts the delivery process.
    * **Challenge:** Handling missing data (e.g., a driver forgetting to scan 'Depart Customer'). We would infer the activity duration using GPS movement resumption.
4.  **Process Granularity:** The process should be modeled at the level of a single shift (Case ID) or, for highly detailed analysis, at the level of a single package's journey within the shift.

### Process Discovery for the Actual Delivery Flow

We would use **Alpha Miner** or, preferably, **Heuristic Miner/Inductive Miner** to handle the likely complexity and non-sequential nature of real-world delivery processes (e.g., re-visiting areas, unscheduled stops).

**Visualization Focus:**

*   **Main Flow:** Start Shift $\rightarrow$ Route Loading $\rightarrow$ Depart Depot $\rightarrow$ Travel $\rightarrow$ Service Stop (Success/Failure) $\rightarrow$ Travel $\rightarrow$ ... $\rightarrow$ Arrive Depot $\rightarrow$ End Shift.
*   **Deviations:** Discovery must clearly identify unplanned loops, skips, or insertion activities such as:
    *   'Unscheduled Stop (Personal/Fuel)' (derived from GPS data far from a planned stop).
    *   'Engine Warning Stop' (linked to Maintenance logs).
    *   'Return to Depot Mid-Shift' (unplanned, possibly due to capacity issues or forgotten packages).
    *   'Re-attempt Delivery' (looping back to a previously failed stop).

### Conformance Checking against Planned Routes

Conformance checking is crucial for identifying structural inefficiencies between the planned (ideal) and actual execution.

**Comparison Metrics:**

| Type of Deviation | Description                                                                                                                                                                                                                                                                                          | Data Source for Comparison |
| :---------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------- |
| **Sequence Mismatch** | The actual order of stops deviated from the optimal sequence determined by the dispatch system. (High fitness deviation).                                                                                                                                                                       | Dispatch vs. Scanner       |
| **Timing Violations** | **Throughput Time:** Actual elapsed time between two stops significantly exceeds the planned travel time (identifies traffic, poor estimation, or excessive service time). **Lateness:** Delivery Success occurs outside the customer's requested time window.                                       | All Sources (Timestamps)   |
| **Missing Activities** | Planned stops were not attempted, or required steps (e.g., scanning an oversized item) were skipped.                                                                                                                                                                                               | Dispatch vs. Scanner       |
| **Unplanned Activities** | Unscheduled stops (GPS idle time not near a planned stop) or unauthorized detours. These increase mileage and fuel costs (low precision deviation).                                                                                                                                               | GPS vs. Dispatch           |

By quantifying the frequency and duration of these deviations, Speedy Parcels can prioritize fixing the most impactful routing or execution problems.

---

## 2. Performance Analysis and Bottleneck Identification

### Key Performance Indicators (KPIs)

| KPI                                   | Calculation Source/Method                                                                                                                                                   | Goal Alignment                                         |
| :------------------------------------ | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :----------------------------------------------------- |
| **On-Time Delivery (OTD) Rate**       | Count of 'Delivery Success' events where the timestamp falls within the customer's time window (from Dispatch data) / Total Deliveries.                                      | Punctuality/Customer Satisfaction                      |
| **Average Service Time per Stop**     | Mean duration between 'Arrive Customer' and 'Depart Customer' (Scanner).                                                                                                    | Operational Efficiency                                 |
| **Travel Time vs. Service Time Ratio** | (Total GPS travel time during shift) / (Total Scanner service time during shift).                                                                                           | Routing Efficiency/Time Allocation                     |
| **Vehicle Utilization Rate**          | (Total time moving/serving) / (Total shift duration). Low utilization suggests excessive idle time, delays, or early returns.                                                 | Cost Reduction/Asset Management                        |
| **Failed Delivery Rate**              | Count of 'Delivery Failed' events / Total attempted deliveries.                                                                                                             | Rework Cost/Efficiency                                 |
| **Average Speed Deviation (Traffic)** | Average actual travel speed vs. planned route speed (Dispatch/Historical baseline). Low actual speed indicates congestion/traffic bottlenecks.                                  | Routing Accuracy/Delay Quantification                  |
| **Mean Time Between Failures (MTBF)** | Calculated from Maintenance logs and correlated with operational usage (mileage, engine hours from GPS) to assess vehicle reliability and the impact on shift completion. | Maintenance Cost/Operational Reliability               |

### Bottleneck Identification Techniques

Process mining allows us to move beyond simple aggregated KPIs and pinpoint exactly *where* the time and cost leakages occur.

1.  **Bottleneck Analysis (Performance View):**
    *   **Activity-Based:** Analyze the mean and variance of throughput time for key activities (e.g., 'Travel to Stop $N$' or 'Service Stop'). High variance in 'Service Stop' time might indicate issues with package organization or difficult customer access. High duration in 'Travel' activities pinpoints congested route segments.
    *   **Queue Time Analysis:** While there are no formal queues in delivery, we can define 'Waiting Time' as the duration where the vehicle is idle and not at a planned stop (derived from GPS). Excessive waiting time is a bottleneck.

2.  **Variant Analysis:**
    *   Group Case IDs (shifts) into performance clusters (e.g., "High OTD shifts" vs. "Low OTD shifts" or "High Fuel Cost shifts" vs. "Low Fuel Cost shifts").
    *   Compare the discovered process models (variants) between these groups. A low-performing variant might include an extra step like 'Return to Depot Mid-Shift' or consistently show longer durations for critical travel legs.

3.  **Resource Analysis (Driver/Vehicle Focus):**
    *   Identify which drivers or vehicle types are associated with the longest service times or the highest percentage of sequence deviations. This pinpoints human or equipment bottlenecks.

4.  **Spatial Correlation:**
    *   Overlay GPS data for slow travel periods (e.g., Speed < 10 km/h) onto a map, correlated with the time of day. This identifies chronic traffic hotspots that routinely bottleneck the process flow, which current static routing fails to account for.

---

## 3. Root Cause Analysis for Inefficiencies

The goal is to determine *why* the bottlenecks identified in Section 2 exist, using targeted process mining correlations.

| Potential Root Cause | Validation Method using Process Mining |
| :------------------- | :------------------------------------- |
| **Inaccurate Travel Time** | **Correlation/Performance Analysis:** Compare the travel time specified in the Dispatch system for a route segment versus the actual average travel time measured by GPS over six months. If the actual time is consistently 20% higher, the dispatch system's underlying map data or traffic models are flawed. |
| **High Service Time Variability** | **Social Network Mining/Variant Analysis:** Use the 'Service Stop' activity. Filter for stops with unusually high duration (outliers). Analyze the package attributes (size, weight), driver, and time of day (e.g., maybe apartment complexes require more time in the afternoon). Correlate high variability with 'Customer Signature Required' vs. 'Left at Door' to determine the driver interaction overhead. |
| **Traffic Congestion** | **Performance Trace Analysis:** Identify traces (shifts) with high throughput time deviation. Segment the GPS data for these traces to isolate periods of low speed (e.g., 8:00–9:30 AM). Correlate these locations and times with external traffic data (if available) or simply use the historical GPS data to model routine morning bottlenecks. |
| **Suboptimal Route Planning** | **Conformance Analysis:** Analyze shifts with high sequence deviation. Use **process repair** techniques to compare the cost (time/distance) of the driver's actual route sequence versus the cost of the planned route sequence and the cost of the *optimal* sequence (calculated externally). If the actual is closer to optimal than the planned, the routing algorithm is poor. |
| **Vehicle Reliability (Maintenance)** | **Process Mining with External Data:** Analyze the frequency of the 'Unscheduled Stop (Engine Warning)' or similar events. Correlate this activity with the vehicle's maintenance history (MTBF) and age/mileage. Identify vehicle types or specific vehicles that are *causally linked* to shift interruptions and premature end-of-day returns. |
| **Failed Delivery Impact** | **Process Discovery/Trace Analysis:** Map the full process path for packages linked to a 'Delivery Failed' event. Analyze the time and mileage cost associated with the resulting 'Return to Depot (Unsuccessful)' or 'Re-attempt Delivery' loop. This quantifies the rework cost of failed attempts. |

---

## 4. Data-Driven Optimization Strategies

Based on the root causes identified, Speedy Parcels can implement targeted improvements.

### Strategy 1: Dynamic Recalibration of Travel Time and Routing Sequence

*   **Targeted Inefficiency:** Suboptimal routing and inaccurate travel time estimations (static routing).
*   **Underlying Root Cause:** Flawed historical map data and failure to account for predictable, time-dependent urban congestion patterns.
*   **Process Mining Support:** Performance analysis shows chronic high throughput time/low speed on specific route segments during specific time windows (e.g., 8:00 AM on Route A). Conformance checking confirms high sequence deviation as drivers manually adjust to avoid bottlenecks.
*   **Proposal:** Implement a feedback loop where the dispatch system's routing algorithm is continuously updated with actual, time-of-day-specific travel times derived from the historical six months of GPS data. The routing engine must move from simple distance optimization to **time-dependent optimization**.
*   **Expected Impacts:** **Increased OTD Rate** (by reducing time buffer waste and avoiding known delays); **Reduced Fuel Consumption** (by ensuring routes reflect reality and minimize distance/idling).

### Strategy 2: Targeted Training and Standardization of Service Stops

*   **Targeted Inefficiency:** High variability and excessive duration in 'Service Stop' time.
*   **Underlying Root Cause:** Inconsistent driver behavior, poor van organization (time spent locating packages), and lack of standardized customer interaction procedures.
*   **Process Mining Support:** Resource analysis identifies a high variance in 'Service Stop' duration among drivers, even when controlling for package count and location type. Service time variance is shown to be a major contributor to overall shift delay (Performance View).
*   **Proposal:** Institute targeted training programs for drivers whose mean service time or service time variability is statistically higher than the peer group mean. Focus training on efficient package retrieval (e.g., using vehicle loading sequence data to optimize placement) and quick customer interaction protocols.
*   **Expected Impacts:** **Decreased Average Service Time per Stop** (improving overall route throughput); **Increased Vehicle Utilization Rate**; **Improved OTD Rate** (by reducing internal processing delays).

### Strategy 3: Predictive Maintenance Scheduling Based on Usage Intensity

*   **Targeted Inefficiency:** Unscheduled stops, vehicle breakdowns, and maintenance-related shift interruptions, leading to high operational costs and missed deliveries.
*   **Underlying Root Cause:** Reactive or simple time/mileage-based maintenance schedules that fail to account for the harsh stress of urban stop-and-go driving.
*   **Process Mining Support:** Analyzing the correlation between GPS engine usage data (engine hours, number of start/stop cycles, average gear ratio) and the frequency of 'Unscheduled Stop (Maintenance)' events or major repairs. Identify that vehicles V12 and V30, despite similar mileage, have vastly different start/stop counts and are breaking down more often.
*   **Proposal:** Shift from fixed interval maintenance to a **condition-based, predictive maintenance (PdM)** model. Use the process mining insights (e.g., high stop-start cycle count, extended idling time) as leading indicators for servicing high-stress components (brakes, transmission, batteries) *before* failure occurs during a delivery shift.
*   **Expected Impacts:** **Increased MTBF**; **Reduced Unscheduled Downtime** (increasing shift reliability); **Lower Maintenance Costs** (by preventing catastrophic failures).

---

## 5. Considering Operational Constraints and Monitoring

### Accounting for Operational Constraints

Any optimization must be feasible within the regulatory and service limits:

1.  **Driver Working Hours (HOS):** The route optimization (Strategy 1) must include HOS limits as a hard constraint. The process trace analysis provides the *actual* total working hours (Start Shift to End Shift), allowing the planning system to forecast legal breaks and shift end times accurately, preventing late-day OTD failures due to drivers having to stop working.
2.  **Vehicle Capacity:** The dispatch data (vehicle capacity and assigned packages) must be monitored via conformance checking. If deviations show drivers returning early or making unplanned mid-shift depot returns (suggesting package overflow or poor load balancing), the initial capacity planning must be adjusted.
3.  **Customer Time Windows (CTW):** The OTD KPI is inherently linked to CTWs. Strategy 1 (Dynamic Routing) must prioritize deliveries that have tight CTWs early in the optimization, allowing for flexibility in the non-time-sensitive stops. Process mining identifies routes where the CTW constraint is routinely violated, allowing planners to assign fewer packages or shift the route start time.

### Continuous Monitoring and Process Mining Dashboards

Post-implementation, continuous monitoring is essential to measure the success of the optimization strategies and catch emerging issues (concept drift).

**Key Process Views to Track:**

| Dashboard View | Focus Area | Metrics to Track | Goal of Tracking |
| :------------- | :--------- | :--------------- | :--------------- |
| **Punctuality & Flow** | OTD and Throughput | Daily OTD Rate, Mean/Variance of Travel Time (Pre vs. Post Optimization), Percentage of Lateness. | Ensure Strategy 1 (Dynamic Routing) is working; quickly detect new bottlenecks. |
| **Efficiency & Cost** | Service and Utilization | Average Service Time (by Driver/Location Type), Total Idle Time vs. Driving Time, Fuel Consumption per Package Delivered. | Monitor Strategy 2 (Training) success; ensure cost KPIs are improving. |
| **Compliance & Deviations** | Conformance and Rework | Daily Conformance Score (Route Sequence), Frequency of Unplanned Stops, Failed Delivery Rate, Re-attempt Loops. | Ensure drivers adhere to optimized routes; monitor effectiveness of CTW management. |
| **Reliability & Maintenance** | Vehicle Health | Mean Time Between Failures (MTBF), Frequency of Mid-shift Maintenance Stops (Correlated with usage metrics). | Validate Strategy 3 (PdM) effectiveness; alert maintenance when usage patterns exceed safety thresholds. |

The dashboards should employ comparative analysis (e.g., comparing current week performance against the average of the last six months pre-optimization) and exception reporting (e.g., flagging any shift where the OTD rate drops below 90% or the service time variance exceeds two standard deviations) to enable proactive management intervention.